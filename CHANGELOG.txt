## [2026-02-14] Site Bot Decoupling + Frontend Shared Package Removal
- Site runtime kept intact for required admin modules: notifications, schedule, visitor analytics.
- Removed Site bot runtime contour and bot-only files:
  - deleted `/Users/tahir/Desktop/beauty-crm/site/backend/bot/*`
  - deleted `/Users/tahir/Desktop/beauty-crm/site/backend/services/smart_assistant.py`
  - deleted `/Users/tahir/Desktop/beauty-crm/site/backend/services/auto_booking.py`
  - deleted `/Users/tahir/Desktop/beauty-crm/site/backend/api/chat_ws.py`
- Removed Site bot settings API surface:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/site_api/settings.py` no longer exposes `/bot-settings`, `/settings/bot`, `/bot-settings/reload`.
- Removed direct dependency of Site DB settings on `bot.constants`:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/db/settings.py` now uses local default dictionaries for bot placeholders (`service_synonyms`, `objection_keywords`, `prompt_headers`).
- Removed duplicated unused local package `@beauty-crm/shared` from both frontends:
  - deleted directories `/Users/tahir/Desktop/beauty-crm/site/frontend/shared` and `/Users/tahir/Desktop/beauty-crm/crm/frontend/shared`,
  - removed alias/path/include entries in:
    - `/Users/tahir/Desktop/beauty-crm/site/frontend/vite.config.ts`,
    - `/Users/tahir/Desktop/beauty-crm/crm/frontend/vite.config.ts`,
    - `/Users/tahir/Desktop/beauty-crm/site/frontend/tsconfig.json`,
    - `/Users/tahir/Desktop/beauty-crm/crm/frontend/tsconfig.json`,
    - `/Users/tahir/Desktop/beauty-crm/site/frontend/package.json`,
    - `/Users/tahir/Desktop/beauty-crm/crm/frontend/package.json`,
    - lockfiles synced in both projects.
- Validation:
  - `npm run build` passed in `/Users/tahir/Desktop/beauty-crm/site/frontend`
  - `npm run build` passed in `/Users/tahir/Desktop/beauty-crm/crm/frontend`
  - `python3 -m compileall -q site/backend` passed
  - `python3 -m compileall -q crm/backend` passed
  - `python3 scripts/diagnostics/verify_backend.py --boundaries --smoke-runtime` passed in both `site/backend` and `crm/backend`

## [2026-02-14] Cleanup: Site/CRM Boundary Pruning (Keep Notifications + Schedule + Analytics in Site)
- User-confirmed keep list in Site runtime preserved:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/api/notifications.py`
  - `/Users/tahir/Desktop/beauty-crm/site/backend/api/notifications_ws.py`
  - `/Users/tahir/Desktop/beauty-crm/site/backend/api/schedule.py`
  - `/Users/tahir/Desktop/beauty-crm/site/backend/api/visitor_analytics.py`
  - `/Users/tahir/Desktop/beauty-crm/site/backend/api/admin_features.py`
- Removed non-required Site API surface (`73` files) from `/Users/tahir/Desktop/beauty-crm/site/backend/api` to reduce cross-contour drift.
- Simplified `/Users/tahir/Desktop/beauty-crm/site/backend/api/__init__.py` to minimal package marker (no mass router imports).
- Removed unmounted Site webhooks runtime:
  - deleted `/Users/tahir/Desktop/beauty-crm/site/backend/webhooks/__init__.py`
  - deleted `/Users/tahir/Desktop/beauty-crm/site/backend/webhooks/telegram.py`
- Removed duplicate dead backend contour from CRM project:
  - deleted full `/Users/tahir/Desktop/beauty-crm/crm/backend/api` tree (runtime uses `crm_api/*`).
- Removed dead CRM frontend pages/components not mounted anymore:
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/pages/admin/PublicContent.tsx`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/pages/admin/VisitorAnalytics.tsx`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/pages/admin/VisitorAnalytics.css`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/components/admin/publicContent/*`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/services/visitorApi.ts`
- Removed unused Site frontend layout files:
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/components/layouts/PublicLayout.tsx`
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/components/layouts/PublicLayout.css`
- Validation:
  - `npm run build` passed in `/Users/tahir/Desktop/beauty-crm/site/frontend`
  - `npm run build` passed in `/Users/tahir/Desktop/beauty-crm/crm/frontend`
  - `python3 -m compileall -q site/backend` passed
  - `python3 -m compileall -q crm/backend` passed

## [2026-02-14] Hotfix: WS Routing + Public Slots + Landing Console Noise
- WebSocket routing fixed for split deploy in frontend API client:
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/crm/api/client.ts`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/crm/api/client.ts`
  - `buildWebSocketUrl()` no longer applies CRM runtime rewrite to `/crm/api/*`; WS endpoints now stay on `/api/ws/*` and `/api/webrtc/*` (with legacy `/api/crm/*` normalization only), matching production nginx WebSocket termination.
- Public booking availability restored on Site runtime:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/product_groups/site/router_mount.py`
  - mounted `api.schedule` under `/api`, which re-enables:
    - `GET /api/public/available-slots`
    - `GET /api/public/available-slots/batch`
  - This removes `404` in landing booking flow for slots lookup.
- Removed noisy success image logs from landing components (both split frontends):
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/site/public_landing/components/Hero.tsx`
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/site/public_landing/components/Gallery.tsx`
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/site/public_landing/components/Portfolio.tsx`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/site/public_landing/components/Hero.tsx`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/site/public_landing/components/Gallery.tsx`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/site/public_landing/components/Portfolio.tsx`
  - `onLoad console.log(...)` removed; `onError` logs kept.

## [2026-02-14] Admin Runtime Routing + Real Recent Activity
- Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ API Ð² split frontend Ð´Ð»Ñ CRM/Admin runtime-ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð°:
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/crm/api/client.ts`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/crm/api/client.ts`
  - `resolveApiEndpoint()` Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð² Ð¿ÑƒÑ‚ÑÑ… `/crm|/admin|/manager|/sales|/saler|/marketer|/employee` Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ CRM-Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð² `/crm/api/*` (Ð²Ð¼ÐµÑÑ‚Ð¾ `/api/*`), Ñ‡Ñ‚Ð¾ ÑƒÑÑ‚Ñ€Ð°Ð½ÑÐµÑ‚ `404` Ð½Ð° endpoints Ð²Ñ€Ð¾Ð´Ðµ:
    - `/api/unread-count`, `/api/messengers/enabled`, `/api/notifications`, `/api/menu-settings`, `/api/dashboard/kpi`, `/api/bot-analytics`.
  - Site runtime API (`/api/public*`, `/api/public-admin*`, `/api/client*`, `/api/cookies*`, `/api/analytics/visitors*`) Ð¾ÑÑ‚Ð°ÐµÑ‚ÑÑ Ð½Ð° site backend.
- Ð£Ð´Ð°Ð»ÐµÐ½ Ñ„ÐµÐ¹ÐºÐ¾Ð²Ñ‹Ð¹ Ñ…Ð°Ñ€Ð´ÐºÐ¾Ð´ Ð±Ð»Ð¾ÐºÐ° â€œÐÐµÐ´Ð°Ð²Ð½ÑÑ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒâ€ Ð½Ð° `/admin/dashboard`:
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/site/pages/adminPanel/Dashboard.tsx`
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/site/pages/adminPanel/Dashboard.tsx`
  - Ð‘Ð»Ð¾Ðº Ñ‚ÐµÐ¿ÐµÑ€ÑŒ ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑÑ Ð¸Ð· Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… `/api/notifications?unread_only=false&limit=3` Ð¸ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ; Ð¿Ñ€Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… â€” `common:no_items`.
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ:
  - `npm --prefix site/frontend run type-check` passed,
  - `npm --prefix crm/frontend run type-check` passed,
  - production dist Ð´Ð»Ñ `site/frontend` Ð¸ `crm/frontend` Ð¿ÐµÑ€ÐµÑÐ¾Ð±Ñ€Ð°Ð½ Ð¸ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€.

## [2026-02-14] Hotfix: `/crm` Redirect Loop and Missing Hero Banner (`banner2.webp`)
- Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½ Ð»Ð¾Ð¶Ð½Ñ‹Ð¹ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚ `https://mlediamant.com/crm -> /admin/dashboard` Ð² split-deploy:
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/src/crm/services/api.ts`
  - `/Users/tahir/Desktop/beauty-crm/site/frontend/src/crm/services/api.ts`
  - `getPlatformGates()` Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ `runtime-profile` Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ°Ðº fallback, ÐµÑÐ»Ð¸ Ð² `platform-gates` Ð½ÐµÑ‚ ÑÐ²Ð½Ñ‹Ñ… boolean-Ñ„Ð»Ð°Ð³Ð¾Ð².
  - Ð­Ñ‚Ð¾ ÑƒÑÑ‚Ñ€Ð°Ð½ÑÐµÑ‚ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸ÑŽ, ÐºÐ¾Ð³Ð´Ð° `/api/runtime-profile` Ð¾Ñ‚ Site runtime Ð¾ÑˆÐ¸Ð±Ð¾Ñ‡Ð½Ð¾ Ð²Ñ‹ÐºÐ»ÑŽÑ‡Ð°Ð» CRM suite Ð²Ð¾ Ñ„Ñ€Ð¾Ð½Ñ‚Ðµ CRM.
- Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½ 404 Ð¿Ð¾ hero banner (`/landing-images/banners/banner2.webp`):
  - `/Users/tahir/Desktop/beauty-crm/site/backend/utils/utils.py`
  - `/Users/tahir/Desktop/beauty-crm/crm/backend/utils/utils.py`
  - Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð¼Ð°Ð¿Ð¿Ð¸Ð½Ð³ legacy Ð¿ÑƒÑ‚Ð¸: `banner2.webp -> banner.webp`.
  - ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½ Ð¿Ð¾Ð¸ÑÐº Ñ„Ð°Ð¹Ð»Ð¾Ð² landing-assets Ð¿Ð¾Ð´ Ð½Ð¾Ð²ÑƒÑŽ split-ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ `frontend/src/site/...` Ð¸ `frontend/src/crm/...`.
- Ð£ÑÐ¸Ð»ÐµÐ½ backend-Ð¾Ñ‚Ð²ÐµÑ‚ Ð±Ð°Ð½Ð½ÐµÑ€Ð¾Ð², Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð²ÑÐµÐ³Ð´Ð° Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð¸Ð» Ñ‡ÐµÑ€ÐµÐ· Ð¿ÑƒÑ‚ÑŒ-Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÑŽ:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/site_api/public.py`
  - `/Users/tahir/Desktop/beauty-crm/site/backend/api/public.py`
  - `/Users/tahir/Desktop/beauty-crm/crm/backend/api/public.py`
  - `/Users/tahir/Desktop/beauty-crm/crm/backend/crm_api/public.py`
  - Ð’ `get_public_banners()` Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ `map_image_path(sanitize_url(...))`.
- Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð° Ñ€Ð°Ð·Ð´Ð°Ñ‡Ð° CRM frontend-Ð°ÑÑÐµÑ‚Ð¾Ð² Ð¿Ð¾Ð´ `/crm/*`:
  - `/Users/tahir/Desktop/beauty-crm/crm/frontend/vite.config.ts`
  - Ð’ production build Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ `base=/crm/` (Ñ‡ÐµÑ€ÐµÐ· `APP_BASE_PATH`, default `/crm/`), Ñ‡Ñ‚Ð¾Ð±Ñ‹ `index.html` ÑÑÑ‹Ð»Ð°Ð»ÑÑ Ð½Ð° `/crm/js/*` Ð¸ `/crm/assets/*`, Ð° Ð½Ðµ Ð½Ð° root `/js/*`.
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ:
  - `python3 -m py_compile` Ð´Ð»Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð½Ñ‹Ñ… backend-Ñ„Ð°Ð¹Ð»Ð¾Ð² passed.
  - `npm --prefix crm/frontend run type-check` passed.
  - `npm --prefix site/frontend run type-check` passed.

## [2026-02-14] Stage 4: Legacy API Contours Disabled in Split Backends
- Ð¤Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹ legacy API ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ñ‹ Ð²Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°:
  - `site/backend/crm_api` -> `site/backend/_disabled_crm_api`
  - `crm/backend/site_api` -> `crm/backend/_disabled_site_api`
- Boundary-check policy Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚ legacy ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ð¾Ð²:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/scripts/diagnostics/verify_backend.py`
  - `/Users/tahir/Desktop/beauty-crm/crm/backend/scripts/diagnostics/verify_backend.py`
  - Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿Ð°Ð´Ð°ÑŽÑ‚, ÐµÑÐ»Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸:
    - `product_groups/site` Ð¸Ð»Ð¸ `site_api` Ð² CRM backend,
    - `product_groups/crm` Ð¸Ð»Ð¸ `crm_api` Ð² Site backend.
- Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:
  - Ñ€Ð¸ÑÐº ÑÐ»ÑƒÑ‡Ð°Ð¹Ð½Ð¾Ð³Ð¾ runtime-Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð²Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ð° ÑÐ½Ð¸Ð¶ÐµÐ½ Ð´Ð¾ `_disabled_*` Ð°Ñ€Ñ…Ð¸Ð²Ð½Ð¾Ð³Ð¾ ÑÐ»Ð¾Ñ,
  - Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ runtime Ð¾ÑÑ‚Ð°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² Ñ†ÐµÐ»ÐµÐ²Ñ‹Ñ… ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ð°Ñ… (`crm_api` Ð´Ð»Ñ CRM runtime Ð¸ `site_api` Ð´Ð»Ñ Site runtime).
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ:
  - `python3 -m py_compile` Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð² passed,
  - `verify_backend.py --boundaries` passed Ð´Ð»Ñ `crm/backend` Ð¸ `site/backend`,
  - `npm --prefix crm/frontend run check:boundaries` passed,
  - `npm --prefix site/frontend run check:boundaries` passed,
  - runtime smoke Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ð» Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ñ… Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð²:
    - site: `/api/public/integration-status`, `/api/public/services`, `/api/public/employees`, `/api/public/bookings`,
    - crm: `/api/integration/v1/health|services|employees|bookings`.

## [2026-02-14] Stage 3.1: Integration Availability Contract for Site Runtime
- Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ð°Ð´Ð°Ð¿Ñ‚ÐµÑ€ Siteâ†”CRM Ð´Ð»Ñ ÑÐ²Ð½Ð¾Ð³Ð¾ fallback-ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð°:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/services/crm_integration.py`
  - Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾:
    - `CRM_INTEGRATION_STRICT` (strict mode),
    - health-check Ðº CRM integration API,
    - ÐµÐ´Ð¸Ð½Ñ‹Ð¹ `get_integration_status()` (enabled/configured/strict_mode/healthy/mode/last_error),
    - Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ mode Ð²ÑÐµÐ³Ð´Ð° ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ð¾Ð¹/Ð½Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ð¾Ð¹ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸.
- ÐŸÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ Site API Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» endpoint ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/site_api/public.py`
  - `GET /api/public/integration-status`
  - `initial-load` Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ `integration` Ð±Ð»Ð¾Ðº ÑÐ¾ ÑÑ‚Ð°Ñ‚ÑƒÑÐ¾Ð¼ Ð°Ð´Ð°Ð¿Ñ‚ÐµÑ€Ð°.
- Booking fallback behavior ÑƒÑ‚Ð¾Ñ‡Ð½ÐµÐ½:
  - Ð¿Ñ€Ð¸ `CRM_INTEGRATION_STRICT=true` Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾Ð¹ CRM Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸:
    - API Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ `503` + `integration_unavailable` + Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ integration status.
  - Ð¿Ñ€Ð¸ `CRM_INTEGRATION_STRICT=false` ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð¼ÑÐ³ÐºÐ¸Ð¹ fallback Ð² Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Site booking flow.
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ:
  - `python3 -m py_compile` Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… backend-Ñ„Ð°Ð¹Ð»Ð¾Ð² passed,
  - boundary checks (`verify_backend.py --boundaries`) passed Ð´Ð»Ñ `crm/backend` Ð¸ `site/backend`,
  - `npm --prefix crm/frontend run check:boundaries` passed,
  - `npm --prefix site/frontend run check:boundaries` passed,
  - runtime smoke confirmed:
    - site: `/api/public/integration-status` route mounted,
    - crm: `/api/integration/v1/*` routes mounted.

## [2026-02-14] Stage 3: Optional Integration Adapter (Site â†” CRM) with Token/Timeout/Cache/Fallback
- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ ÑÐ²Ð½Ñ‹Ð¹ versioned Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ API Ð² CRM:
  - `/Users/tahir/Desktop/beauty-crm/crm/backend/crm_api/integration.py`
  - Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð² root router: `/Users/tahir/Desktop/beauty-crm/crm/backend/crm_api/__init__.py`
  - endpoints:
    - `GET /api/integration/v1/health`
    - `GET /api/integration/v1/services`
    - `GET /api/integration/v1/employees`
    - `POST /api/integration/v1/bookings`
  - Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ:
    - Ñ‚Ð¾ÐºÐµÐ½ Ñ‡ÐµÑ€ÐµÐ· `X-Integration-Token`,
    - Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ `secrets.compare_digest`,
    - feature flag `CRM_INTEGRATION_ENABLED`,
    - ÑÐµÐºÑ€ÐµÑ‚ `CRM_INTEGRATION_TOKEN`.
- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ CRM adapter-ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð² Site runtime:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/services/crm_integration.py`
  - Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ:
    - `CRM_INTEGRATION_ENABLED` Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸ÑŽ,
    - `CRM_INTEGRATION_BASE_URL` Ð·Ð°Ð´Ð°ÐµÑ‚ CRM backend URL,
    - `CRM_INTEGRATION_TOKEN` Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸,
    - `CRM_INTEGRATION_TIMEOUT_SECONDS` Ð´Ð»Ñ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²,
    - `CRM_INTEGRATION_CACHE_TTL_SECONDS` Ð´Ð»Ñ in-memory TTL cache.
  - graceful fallback:
    - Ð¿Ñ€Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸/Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ… CRM site Ð½Ðµ Ð¿Ð°Ð´Ð°ÐµÑ‚ Ð¸ Ð¾ÑÑ‚Ð°ÐµÑ‚ÑÑ Ð² Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ.
- Ð’ÑÑ‚Ñ€Ð¾ÐµÐ½ adapter Ð² Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ site endpoints:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/site_api/public.py`
  - Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ðº:
    - `employees`,
    - `services`,
    - `bookings` (Ñ fallback Ð½Ð° Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ booking flow Ð¿Ñ€Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ð¸ CRM).
- Ð£ÑÐ¸Ð»ÐµÐ½Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð³Ñ€Ð°Ð½Ð¸Ñ† Ð´Ð»Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð°Ð´Ð°Ð¿Ñ‚ÐµÑ€Ð¾Ð²:
  - `/Users/tahir/Desktop/beauty-crm/site/backend/scripts/diagnostics/verify_backend.py`
  - `/Users/tahir/Desktop/beauty-crm/crm/backend/scripts/diagnostics/verify_backend.py`
  - Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹ Ñ†ÐµÐ»ÐµÐ²Ñ‹Ðµ runtime-Ñ„Ð°Ð¹Ð»Ñ‹:
    - `crm_api/integration.py`,
    - `services/crm_integration.py`.
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ:
  - `python3 -m py_compile` Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… backend-Ñ„Ð°Ð¹Ð»Ð¾Ð² passed,
  - `venv/bin/python scripts/diagnostics/verify_backend.py --boundaries` passed Ð´Ð»Ñ `crm/backend` Ð¸ `site/backend`,
  - `npm --prefix crm/frontend run check:boundaries` passed,
  - `npm --prefix site/frontend run check:boundaries` passed,
  - runtime Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð² Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ð»Ð° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ:
    - `/api/integration/v1/health`,
    - `/api/integration/v1/services`,
    - `/api/integration/v1/employees`,
    - `/api/integration/v1/bookings`.

## [2026-02-14] Stage 2: Backend Contour Cleanup and Runtime Boundary Hardening
- ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¾ Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ backend-ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ð¾Ð² Ð±ÐµÐ· Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… patch-Ñ„Ð°Ð¹Ð»Ð¾Ð²:
  - Ð² `site/backend` runtime-ÐºÐ¾Ð´ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ `crm_api` Ð² ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ñ… runtime-Ð¼Ð¾Ð´ÑƒÐ»ÑÑ…:
    - `integrations/telegram_bot.py`
    - `notifications/admin_notifications.py`
    - `services/universal_messenger.py`
    - `services/feedback_service.py`
  - `integrations/telegram_bot.py`:
    - WS-ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½Ñ‹ Ð½Ð° `api.chat_ws` Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¼ fallback (best-effort),
    - ÑƒÐ´Ð°Ð»ÐµÐ½Ð° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¾Ñ‚ `bot`-runtime; Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð±ÐµÑ€ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð· `bot_settings.telegram_auto_reply_message`,
    - Ð¿Ñ€Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½Ðµ Ð¿Ð°Ð´Ð°ÐµÑ‚ Ð¸ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ Ð»Ð¾Ð³Ð¸Ñ€ÑƒÐµÑ‚ÑÑ.
- Ð’Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÑƒÑ€ Ð² product-groups Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸:
  - `crm/backend/product_groups/site` -> `crm/backend/product_groups/_disabled_site`
  - `site/backend/product_groups/crm` -> `site/backend/product_groups/_disabled_crm`
- Ð£ÑÐ¸Ð»ÐµÐ½Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ boundary checks (Ð² ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¼ SSOT-ÑÐºÑ€Ð¸Ð¿Ñ‚Ðµ):
  - `crm/backend/scripts/diagnostics/verify_backend.py`
  - `site/backend/scripts/diagnostics/verify_backend.py`
  - Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸:
    - Ð·Ð°Ð¿Ñ€ÐµÑ‚ runtime-Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¾Ð² Ð²Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚ÑƒÑ€Ð° Ð² Ñ†ÐµÐ»ÐµÐ²Ñ‹Ñ… runtime-Ñ„Ð°Ð¹Ð»Ð°Ñ…,
    - Ð·Ð°Ð¿Ñ€ÐµÑ‚ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… opposite contour Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¹ (`product_groups/site` Ð² CRM Ð¸ `product_groups/crm` Ð² Site),
    - ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½ Ð·Ð°Ð¿Ñ€ÐµÑ‚ legacy namespace-Ð¼Ð°Ñ€ÐºÐµÑ€Ð¾Ð² Ð² `main.py`.
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ:
  - `python3 -m py_compile` Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… backend-Ñ„Ð°Ð¹Ð»Ð¾Ð² passed,
  - `venv/bin/python scripts/diagnostics/verify_backend.py --boundaries` passed Ð´Ð»Ñ `crm/backend` Ð¸ `site/backend`,
  - `npm --prefix crm/frontend run check:boundaries` passed,
  - `npm --prefix site/frontend run check:boundaries` passed.

## [2026-02-14] Stage 1: Runtime Independence Contract Enforced (CRM vs Site)
- Ð—Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚ Ð³Ñ€Ð°Ð½Ð¸Ñ† Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ (SSOT):
  - CRM Ð²Ð»Ð°Ð´ÐµÐµÑ‚: CRM API/runtime, CRM scheduler/bot lifecycle, CRM business-Ð¼Ð¾Ð´ÑƒÐ»Ð¸.
  - Site Ð²Ð»Ð°Ð´ÐµÐµÑ‚: public/account/admin runtime Ð¸ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸ API/ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°Ð¼Ð¸.
  - Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ð´Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‡ÐµÑ€ÐµÐ· ÑÐ²Ð½Ñ‹Ð¹ API/webhook-ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚, Ð±ÐµÐ· ÑÐ¼ÐµÑˆÐ°Ð½Ð½Ð¾Ð³Ð¾ `main.py` runtime.
- Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½ hard split Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð²:
  - `crm/backend/main.py` Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½ Ð² CRM-only runtime:
    - ÑƒÐ±Ñ€Ð°Ð½Ñ‹ `create_site_app`, dual runtime `both`, namespace rewrite `/api/crm` Ð¸ `/api/site`,
    - Ð¾ÑÑ‚Ð°ÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ shared + CRM router mounts Ð¸ CRM lifecycle (services/schedulers).
  - `site/backend/main.py` Ð¿ÐµÑ€ÐµÐ²ÐµÐ´ÐµÐ½ Ð² Site-only runtime:
    - ÑƒÐ±Ñ€Ð°Ð½Ñ‹ `create_crm_app`, dual runtime `both`, namespace rewrite `/api/crm` Ð¸ `/api/site`,
    - Ð¾ÑÑ‚Ð°ÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ shared + site/account/public router mounts Ð¸ site lifecycle.
- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð³Ñ€Ð°Ð½Ð¸Ñ† (Ð±ÐµÐ· Ð½Ð¾Ð²Ñ‹Ñ… Ð¼ÐµÐ»ÐºÐ¸Ñ… Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²):
  - `crm/backend/scripts/diagnostics/verify_backend.py --boundaries`
  - `site/backend/scripts/diagnostics/verify_backend.py --boundaries`
  - `crm/frontend/package.json`: `check:boundaries`, `check:boundary:backend`, `check:boundary:frontend`
  - `site/frontend/package.json`: `check:boundaries`, `check:boundary:backend`, `check:boundary:frontend`
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ¸:
  - `python3 -m py_compile crm/backend/main.py site/backend/main.py` passed.
  - `npm --prefix crm/frontend run check:boundaries` passed.
  - `npm --prefix site/frontend run check:boundaries` passed.

## [2026-02-14] Finalized Split Layout: Removed Legacy Root `backend/` and `frontend/`
- Completed physical split cleanup:
  - removed legacy root directories `/backend` and `/frontend`,
  - active project roots are now only:
    - `crm/backend`, `crm/frontend`,
    - `site/backend`, `site/frontend`.
- Post-cleanup validation:
  - `python3 -m py_compile crm/backend/main.py site/backend/main.py` passed,
  - `python3 -m py_compile` passed for updated root utility scripts and import-maintenance scripts,
  - runtime sanity import still resolves:
    - CRM app group = `crm`,
    - Site app group = `site`.
  - type-check passed for both frontends:
    - `npm --prefix crm/frontend run type-check`,
    - `npm --prefix site/frontend run type-check`.
- Updated i18n workflow docs for new structure:
  - `scripts/i18n/README.md` now uses `crm/frontend` (and notes `site/frontend` equivalence) instead of removed root `frontend`.
- Updated deploy/service docs under split projects to new project-root paths:
  - `crm/backend/bot/DEPLOY_GUIDE.md`, `site/backend/bot/DEPLOY_GUIDE.md`,
  - `crm/backend/services/README_SCHEDULER.md`, `site/backend/services/README_SCHEDULER.md`,
  - `crm/backend/services/README_PACKAGE_SCHEDULER.md`, `site/backend/services/README_PACKAGE_SCHEDULER.md`,
  - `crm/backend/bot/# ðŸš€ ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ Beauty CRM.ini`,
  - `site/backend/bot/# ðŸš€ ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ Beauty CRM.ini`.
- Updated root utility scripts to project-aware path resolution (`FRONTEND_GROUP=crm|site`, default `crm`):
  - `scripts/i18n/check_russian_locales.py`,
  - `scripts/i18n/sync_locales.py`,
  - `scripts/maintenance/fix_header_translations.py`,
  - `scripts/maintenance/fix_services_tag.py`,
  - `scripts/maintenance/add_path_comments.py`,
  - `scripts/maintenance/update_trimmer_ui.py`.
- Updated gallery import maintenance scripts in both split backends to backend-relative static path:
  - `crm/backend/scripts/maintenance/import_all_images.py`,
  - `site/backend/scripts/maintenance/import_all_images.py`.

## [2026-02-14] Physical Split Into Two Project Roots (`crm/` and `site/`)
- Added two top-level independent project folders inside `beauty-crm`:
  - `crm/backend`, `crm/frontend`
  - `site/backend`, `site/frontend`
- Both project folders now contain their own backend/frontend file trees (copied from current working baseline), so they can evolve independently.
- Unified frontend dependency storage to a single shared `node_modules`:
  - moved shared dependency root to `/beauty-crm/node_modules`,
  - `frontend/node_modules -> ../node_modules` (compatibility symlink),
  - `crm/frontend/node_modules -> ../../node_modules` (symlink),
  - `site/frontend/node_modules -> ../../node_modules` (symlink),
  - this avoids duplicate `node_modules` folders for split projects.
- Unified Python dependency storage to a single shared virtual environment:
  - moved shared venv root to `/beauty-crm/venv`,
  - `backend/venv -> ../venv` (compatibility symlink),
  - `crm/backend/venv -> ../../venv`,
  - `site/backend/venv -> ../../venv`.
- Backend runtime defaults are now project-specific via `.env`:
  - `crm/backend/.env`: `BACKEND_PRODUCT_GROUP=crm`
  - `site/backend/.env`: `BACKEND_PRODUCT_GROUP=site`
- Port split for fully parallel local run:
  - `crm/backend/.env`: `PORT=8001`
  - `site/backend/.env`: `PORT=8002`
  - `crm/frontend/.env`: `BACKEND_PORT=8001`, `FRONTEND_PORT=5173`
  - `site/frontend/.env`: `BACKEND_PORT=8002`, `FRONTEND_PORT=5174`
  - `crm/frontend/vite.config.ts` and `site/frontend/vite.config.ts` now support `FRONTEND_PORT` env override.
- Frontend package identity split:
  - `crm/frontend/package.json`: `name=beauty_crm_crm`
  - `site/frontend/package.json`: `name=beauty_crm_site`
  - lockfiles aligned with the same names.
- Removed hardcoded absolute project paths in split project utility scripts (both `crm` and `site` copies):
  - `backend/scripts/import_employee_photos.py` now resolves source directory from project-relative candidates or `EMPLOYEE_PHOTO_SOURCE_DIR`.
  - `backend/scripts/maintenance/find_dict_row_issues.py` now resolves target files via `Path(__file__)` relative backend root.
  - `frontend/convert_frontend_images.py` now resolves target directory project-relatively and supports `IMAGE_CONVERT_TARGET_DIR`.
- Validation:
  - `python3 -m py_compile crm/backend/main.py site/backend/main.py` passed.
  - runtime sanity import confirmed:
    - `crm/backend` app resolves `backend_product_group=crm`,
    - `site/backend` app resolves `backend_product_group=site`.
  - `npm --prefix crm/frontend run type-check` passed.
  - `npm --prefix site/frontend run type-check` passed.

## [2026-02-14] Backend Lifecycle Split: CRM vs Site/Admin/Account
- Extended backend folder split from router level to runtime lifecycle level:
  - added `backend/product_groups/crm/runtime_bootstrap.py`,
  - added `backend/product_groups/site/runtime_bootstrap.py`.
- Added explicit route-contract files by product group:
  - `backend/product_groups/crm/route_contract.py` (CRM module matrix + CRM runtime/websocket prefixes),
  - `backend/product_groups/site/route_contract.py` (site-only API and non-API paths).
- `backend/main.py` now consumes these contracts from product-group modules instead of inlined mixed constants.
- CRM lifecycle orchestration moved out of `backend/main.py` into CRM group module:
  - bot bootstrap (`get_bot`, module status),
  - scheduler bootstrap (birthday/checkers/reminders/weekly-report/backup/trash cleanup).
- `backend/main.py` now calls product-group lifecycle hooks instead of importing CRM runtime modules directly.
- Result:
  - CRM runtime dependencies are physically isolated under `product_groups/crm`,
  - Site/Admin/Account has its own dedicated runtime module entrypoint under `product_groups/site`,
  - split architecture now covers both router mounting and startup orchestration.
- Fixed feature-gate false positive for site routes:
  - `_resolve_crm_module_by_path()` now ignores:
    - site-only API prefixes (`/api/public*`, `/api/client*`, `/api/public-admin*`),
    - site-only exact paths (e.g. `/api/register/client`),
    - strict namespace-exempt integration/public paths (`/api/webhook*`, `/api/cookies*`, etc.).
  - This prevents `api_namespace_route_mismatch` / `crm_backend_unavailable` on valid site endpoints in split runtime modes.
- Validation:
  - `python3 -m py_compile backend/main.py backend/product_groups/crm/runtime_bootstrap.py backend/product_groups/site/runtime_bootstrap.py` passed.
  - factory sanity check from `backend/`: `create_crm_app()` and `create_site_app()` both instantiate successfully.

## [2026-02-14] Backend Folder Split: CRM vs Site/Admin/Account Orchestrators
- Added backend product-group folder structure for routing orchestration:
  - `backend/product_groups/shared/`
  - `backend/product_groups/crm/`
  - `backend/product_groups/site/`
- Added physically separate Site/Admin/Account API folder:
  - `backend/site_api/`
  - duplicated dedicated site-side modules:
    - `public_admin.py`
    - `client_auth.py`
    - `sitemap.py`
    - `seo_metadata.py`
    - `public.py`
  - `product_groups/site/router_mount.py` switched to import routers from `site_api/*` (not from shared `api/*`).
- Added physically separate CRM API folder:
  - `backend/crm_api/` (duplicated API files from `backend/api/` for full file-level isolation).
  - Internal imports in `crm_api/*` switched from `api.*` to `crm_api.*`.
  - `product_groups/crm/router_mount.py` switched to import routers from `crm_api/*` only.
- Added physically separate shared API folder:
  - `backend/shared_api/`
  - `shared_api/proxy.py` duplicated from `api/proxy.py`.
  - `product_groups/shared/router_mount.py` switched to `shared_api.proxy`.
- Added `site_api/settings.py` and switched runtime fallback in `main.py`:
  - `from site_api.settings import get_public_referral_link_profile`.
- Resulting state:
  - `main.py` router orchestration no longer imports routers from `backend/api/*` directly.
  - Product router mounts are file-isolated by folder (`crm_api`, `site_api`, `shared_api`).
  - Runtime/service imports outside legacy folders switched away from `api.*` to `crm_api.*` where needed:
    - `services/*`, `bot/*`, `scheduler/*`, `notifications/*`, `webhooks/*`, `integrations/*`.
  - Test/support imports aligned to `crm_api.*` (`tests/*`, `scripts/testing/*`) for consistency with new package boundaries.
- Introduced dedicated router mount functions:
  - `mount_shared_routers(app)` in `backend/product_groups/shared/router_mount.py`
  - `mount_crm_routers(app)` in `backend/product_groups/crm/router_mount.py`
  - `mount_site_account_public_routers(app)` in `backend/product_groups/site/router_mount.py`
- Refactored `backend/main.py` to use product-group router orchestrators instead of inline mixed router registration block.
- Result:
  - router wiring for CRM and Site/Admin/Account is now physically split by backend folders/files,
  - runtime switch (`crm/site/both`) still works via existing feature-gate/runtime logic.
- Static landing assets mount updated in backend for new frontend structure:
  - primary path: `frontend/src/site/public_landing/styles/img`
  - legacy fallback: `frontend/public_landing/styles/img`
  - this keeps `/landing-images/*` stable during/after split.
- Validation:
  - `python3 -m py_compile main.py product_groups/shared/router_mount.py product_groups/crm/router_mount.py product_groups/site/router_mount.py` passed.

## [2026-02-14] Landing Assets Fix + Admin Route Reassignment
- Fixed public landing static assets after folder split:
  - Updated `frontend/public/landing-images` symlink target from removed legacy path to active path:
    - `../src/site/public_landing/styles/img`.
  - Restored runtime availability for landing assets used by hero/portfolio/gallery (`/landing-images/*`).
- Reassigned admin-oriented pages from `/crm/*` to `/admin/*`:
  - `visitor-analytics` added to admin route group in `frontend/src/App.tsx` (`/admin/visitor-analytics`).
  - Legacy CRM route now redirects:
    - `/crm/visitor-analytics` -> `/admin/visitor-analytics`.
  - `public-content` remains in admin group and legacy CRM route now redirects with tab preservation:
    - `/crm/public-content/:tab?` -> `/admin/public-content/:tab?`.
- Navigation alignment:
  - Updated `frontend/src/crm/components/layouts/UniversalLayout.tsx`:
    - CRM menu items `public-content` and `visitor-analytics` now point to `/admin/*` when current prefix is `/crm`.
    - Added `public-content` and `visitor-analytics` entries into admin menu catalog.
- Validation:
  - `npm run type-check` passed.

## [2026-02-14] Frontend Split Hardening: Removed Root Symlink Compatibility Layer
- Completed transition from temporary root symlink compatibility to explicit product-group imports.
- `frontend/src`:
  - Removed all root-level symlinked module folders (`api`, `components`, `config`, `contexts`, `guidelines`, `hooks`, `lib`, `locales`, `pages`, `services`, `styles`, `tests`, `utils`).
  - Removed remaining `src/crm/pages` compatibility symlinks (`auth`, `public`, `adminPanel`) after rewriting dependent imports to explicit `@site/pages/*`.
  - Replaced `src/crm/i18n.ts` symlink with a real re-export module (`export { default, languages } from '../i18n'`).
  - Kept root as orchestrator entrypoint only (`App.tsx`, `main.tsx`, `i18n.ts`, global styles/types).
- Import cleanup:
  - Rewrote remaining `@/*` imports in `src/crm` and `src/site/public_landing` to explicit aliases:
    - CRM modules via `@crm/*`,
    - site-specific UI imports via `@site/public_landing/*`.
  - Updated root orchestrators to avoid removed root folders:
    - `frontend/src/main.tsx` now imports `AuthProvider` and API interceptor from `@crm/*`.
    - `frontend/src/i18n.ts` now imports language metadata from `@crm/utils/i18nUtils` and loads locale files from `./crm/locales/**/*.json`.
  - Fixed moved-path dependency in `frontend/src/crm/components/layouts/PublicLayout.tsx`:
    - `useSalonInfo` now imported from `@site/public_landing/hooks/useSalonInfo`.
- Public landing entrypoint cleanup:
  - `frontend/public_landing.html` now references `src/site/public_landing` directly:
    - script entry `/src/site/public_landing/main.tsx`,
    - preload image `/src/site/public_landing/styles/img/logo.webp`.
  - Removed no-longer-needed compatibility symlink `frontend/public_landing`.
- Config updates:
  - `frontend/tsconfig.json` include list cleaned (removed legacy `public_landing` include).
  - `frontend/vite.config.ts` locale chunk matcher updated to moved locale path (`/src/crm/locales/`).
- Validation:
  - `npm run type-check` passed after symlink removal and import rewrite.

## [2026-02-13] Frontend Physical Split: CRM vs Site Folder Groups
- `frontend/src`:
  - Added product folders:
    - `src/crm` for CRM codebase,
    - `src/site` for site/account/admin grouping.
  - Physically moved CRM source tree under `src/crm`:
    - `api`, `components`, `config`, `contexts`, `guidelines`, `hooks`, `lib`, `locales`, `pages`, `services`, `styles`, `tests`, `utils`.
  - Site-facing page groups were moved out of CRM pages into `src/site/pages`:
    - `auth`, `public`, `adminPanel`.
  - Physically moved `frontend/public_landing` into `src/site/public_landing`.
  - Added compatibility symlink `frontend/public_landing -> src/site/public_landing` to keep existing `public_landing.html` entry path working during transition.
  - Added compatibility symlinks so existing imports and routes continue working without mass rewrite:
    - root `src/*` links to `src/crm/*` for moved modules,
    - `src/crm/pages/{auth,public,adminPanel}` link to `src/site/pages/*`,
    - `src/crm/i18n.ts` links to root `src/i18n.ts` for existing CRM relative imports.
  - Restored orchestrator-level files in root `src` as real files (`App.tsx`, `main.tsx`, `i18n.ts`, `index.css`, `vite-env.d.ts`, `Attributions.md`, `package.json`) to keep stable entrypoint/import behavior.
  - Routing orchestrator `frontend/src/App.tsx` now imports modules explicitly by product group:
    - CRM modules via `@crm/*`,
    - Site/account/admin modules via `@site/*`.
  - Updated `src/site/pages/*` imports to use `@crm/*` dependencies instead of old broken `../../...` relative paths after relocation.
  - Updated `src/site/public_landing/*` imports from relative `../../src/*` paths to `@/*` alias for location-independent resolution.
- `frontend/tsconfig.json`:
  - Added path aliases:
    - `@crm/* -> ./src/crm/*`,
    - `@site/* -> ./src/site/*`.
  - Updated exclusions to keep test files out after move:
    - added `src/crm/tests`.
- `frontend/vite.config.ts`:
  - Added Vite aliases:
    - `@crm -> ./src/crm`,
    - `@site -> ./src/site`.
- Validation:
  - `npm run type-check` passed after structure split.

## [2026-02-14] Backend Orchestrator Reliability (CRM + Site)
- Added backend-root `sys.path` bootstrap for standalone runners:
  - `site/backend/db/migrations/run_all_migrations.py`, `crm/backend/db/migrations/run_all_migrations.py`.
  - `site/backend/scripts/maintenance/fix_data.py`, `crm/backend/scripts/maintenance/fix_data.py`.
- `crm/backend/tests/test_all.py`: API import checks switched to `crm_api.*`.
- `crm/backend/tests/test_gender_avatars.py`: replaced brittle hardcoded male-name assertion with DB-based male-employee validation.
- `crm/backend/main.py` and `site/backend/main.py`: added commented manual hooks for `run_all_migrations`, `run_all_fixes`, `run_all_tests`, `run_all_tests2`, `run_all_tests3`.
- Validation: full migration/fix/test cycles rerun in both projects, all orchestrator runs passed.
