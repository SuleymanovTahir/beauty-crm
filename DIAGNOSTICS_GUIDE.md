# üîç –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ —Å–∏—Å—Ç–µ–º—ã

## üìã –û–±–∑–æ—Ä

–ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Beauty CRM –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å:
- –ó–∞–≥—Ä—É–∑–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î
- API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏
- SmartAssistant
- Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
- Instagram API
- –ü–æ—Ä—Ç–∞–º–∏ —Å–µ—Ä–≤–µ—Ä–∞

## üöÄ –°–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞

### 1. –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd backend
python diagnostic_full.py
```

### 2. –ß–µ—Ä–µ–∑ API (–∫–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω)

```bash
# GET –∑–∞–ø—Ä–æ—Å
curl http://localhost:8000/api/diagnostics/full

# –ò–ª–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
http://localhost:8000/api/diagnostics/full
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞

–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ `backend/main.py`:

```python
@app.on_event("startup")
async def startup_event():
    # –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É:
    from diagnostic_full import run_full_diagnostics
    await run_full_diagnostics()
```

## üìä –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

### ‚úÖ –¢–ï–°–¢ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ò–º–ø–æ—Ä—Ç `core.config`
- –ù–∞–ª–∏—á–∏–µ DATABASE_NAME
- –ù–∞–ª–∏—á–∏–µ GEMINI_MODEL
- –ù–∞–ª–∏—á–∏–µ PAGE_ACCESS_TOKEN

### ‚úÖ –¢–ï–°–¢ 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã: users, clients, bookings, employees, bot_settings
- notification_settings
- booking_reminder_settings

### ‚úÖ –¢–ï–°–¢ 3: API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (HTTP)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:
- `/` - –ö–æ—Ä–Ω–µ–≤–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
- `/health` - Health check
- `/api/notifications/settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `/api/booking-reminder-settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

**–¢–∞–π–º–∞—É—Ç—ã:** 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
**–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:** –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ >2 —Å–µ–∫—É–Ω–¥

### ‚úÖ –¢–ï–°–¢ 4: SmartAssistant
- –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã `__init__`
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —Å `client_id`

### ‚úÖ –¢–ï–°–¢ 5: Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ SMTP_USERNAME
- –ü—Ä–æ–≤–µ—Ä–∫–∞ SMTP_PASSWORD
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è email –æ—Ç–ø—Ä–∞–≤–∫–∏

### ‚úÖ –¢–ï–°–¢ 6: Instagram API
- –ü—Ä–æ–≤–µ—Ä–∫–∞ PAGE_ACCESS_TOKEN
- –ü—Ä–æ–≤–µ—Ä–∫–∞ INSTAGRAM_BUSINESS_ID
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏–π

### ‚úÖ –¢–ï–°–¢ 7: –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
- Backend (8000) - FastAPI
- Frontend (5173) - Vite

## üîß –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### ‚ùå API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–µ –æ—Ç–≤–µ—á–∞—é—Ç (Timeout)

**–ü—Ä–æ–±–ª–µ–º–∞:** HTTP –∑–∞–ø—Ä–æ—Å—ã —Ç–∞–π–º–∞—É—Ç—è—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
1. Backend —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω
2. –°–µ—Ä–≤–µ—Ä –∑–∞–≤–∏—Å–∞–µ—Ç –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤
3. –ü–æ—Ä—Ç 8000 –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º

**–†–µ—à–µ–Ω–∏—è:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä
lsof -i :8000

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend
cd backend
python main.py

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
tail -f backend/logs/app.log

# 4. –ï—Å–ª–∏ –∑–∞–≤–∏—Å–∞–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Python
ps aux | grep python
```

### ‚ùå SmartAssistant –æ—à–∏–±–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** `SmartAssistant.__init__() missing 1 required positional argument: 'client_id'`

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–æ –≤ `tests/test_all.py`:
```python
# ‚ùå –°—Ç–∞—Ä—ã–π –∫–æ–¥ (–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç)
assistant = SmartAssistant()

# ‚úÖ –ù–æ–≤—ã–π –∫–æ–¥ (—Ä–∞–±–æ—Ç–∞–µ—Ç)
assistant = SmartAssistant(client_id="test_client_123")
```

### ‚ùå /admin –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ /

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∏—Ä–µ–∫—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç –∑–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É

**–ü—Ä–∏—á–∏–Ω–∞:** `ProtectedRoute` —Ç—Ä–µ–±–æ–≤–∞–ª —Ä–æ–ª—å "admin", –∞ —É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ —Ä–æ–ª—å "director"

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–æ –≤ `frontend/src/App.tsx`:
```typescript
// –¢–µ–ø–µ—Ä—å –¥–∏—Ä–µ–∫—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞—Ö–æ–¥–∏—Ç—å –Ω–∞ /admin
if (requiredRole === 'admin') {
  allowedRoles.push('director');
}
```

### ‚ùå SMTP credentials not configured

**–ü—Ä–æ–±–ª–µ–º–∞:** Email –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ backend/.env.local
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
FROM_EMAIL=your-email@gmail.com
```

## üìù –ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```
================================================================================
üîç –ü–û–õ–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê BEAUTY CRM
================================================================================
üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è: 2025-11-16 10:00:00
================================================================================

–¢–ï–°–¢ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
--------------------------------------------------------------------------------
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞
   DATABASE: salon_bot.db
   GEMINI_MODEL: gemini-2.0-flash-001
   PAGE_ACCESS_TOKEN: ***QPOYcykARQ

–¢–ï–°–¢ 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
--------------------------------------------------------------------------------
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
   –¢–∞–±–ª–∏—Ü –≤ –ë–î: 58
   ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
   notification_settings: 0 –∑–∞–ø–∏—Å–µ–π
   booking_reminder_settings: 5 –∑–∞–ø–∏—Å–µ–π

–¢–ï–°–¢ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
--------------------------------------------------------------------------------
   –¢–µ—Å—Ç–∏—Ä—É–µ–º: –ö–æ—Ä–Ω–µ–≤–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (/)
   ‚úÖ –ö–æ—Ä–Ω–µ–≤–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç: OK (0.15s)

   –¢–µ—Å—Ç–∏—Ä—É–µ–º: Health check (/health)
   ‚úÖ Health check: OK (0.08s)

   –¢–µ—Å—Ç–∏—Ä—É–µ–º: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (/api/notifications/settings)
   ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: OK (1.23s)

   –¢–µ—Å—Ç–∏—Ä—É–µ–º: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π (/api/booking-reminder-settings)
   ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π: OK (0.45s)

   –ò—Ç–æ–≥–æ: 4/4 —É—Å–ø–µ—à–Ω–æ

–¢–ï–°–¢ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ SmartAssistant
--------------------------------------------------------------------------------
   –ü–∞—Ä–∞–º–µ—Ç—Ä—ã __init__: ['self', 'client_id']
   ‚ÑπÔ∏è  SmartAssistant —Ç—Ä–µ–±—É–µ—Ç client_id –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
   ‚úÖ SmartAssistant —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ (—Å client_id)

–¢–ï–°–¢ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
--------------------------------------------------------------------------------
   SMTP –Ω–∞—Å—Ç—Ä–æ–µ–Ω: ii3391609@gmail.com
   ‚ÑπÔ∏è  –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ test_notifications_full.py

–¢–ï–°–¢ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ Instagram API
--------------------------------------------------------------------------------
   PAGE_ACCESS_TOKEN: ***QPOYcykARQ
   INSTAGRAM_BUSINESS_ID: 17841448618072548
   ‚ÑπÔ∏è  –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ test_notifications_full.py

–¢–ï–°–¢ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞
--------------------------------------------------------------------------------
   ‚úÖ Backend (FastAPI) (:8000): –î–æ—Å—Ç—É–ø–µ–Ω
   ‚úÖ Frontend (Vite) (:5173): –î–æ—Å—Ç—É–ø–µ–Ω

================================================================================
üìä –ò–¢–û–ì–ò –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò
================================================================================
‚úÖ PASS - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚úÖ PASS - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚úÖ PASS - –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
‚úÖ PASS - API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚úÖ PASS - SmartAssistant
‚úÖ PASS - Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚úÖ PASS - Instagram API

–ü—Ä–æ–π–¥–µ–Ω–æ: 7/7

================================================================================
```

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [TESTING_NOTIFICATIONS.md](./TESTING_NOTIFICATIONS.md) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [backend/tests/](./backend/tests/) - –í—Å–µ —Ç–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- [backend/main.py](./backend/main.py) - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üí° –°–æ–≤–µ—Ç—ã

1. **–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã** - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
2. **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π** - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –ø–æ–≤—Ç–æ—Ä–Ω–æ
3. **–ü—Ä–∏ —Å—Ç—Ä–∞–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (`backend/logs/app.log`)
4. **–ü—Ä–∏ —Ç–∞–π–º–∞—É—Ç–∞—Ö** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-16
