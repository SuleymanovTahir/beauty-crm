import{a as e,b as t,r as s,R as r,d as a,u as n,e as i,O as l,f as o,h as d,i as c,L as m,B as x,j as u,k as h,N as p}from"./react-vendor-D1lqpvBY.js";import{X as g,L as f,S as b,U as y,M as j,C as v,a as w,b as N,c as k,d as S,W as C,e as _,f as z,g as E,h as R,D as T,T as D,i as I,j as L,k as P,l as M,m as A,F as O,n as W,P as B,R as F,o as $,p as U,E as q,A as H,q as V,B as Y,r as X,s as K,t as J,G,u as Z,v as Q,w as ee,x as te,y as se,z as re,H as ae,I as ne,J as ie,K as le,N as oe,O as de,Q as ce,V as me,Y as xe,Z as ue,_ as he,$ as pe,a0 as ge,a1 as fe,a2 as be,a3 as ye,a4 as je,a5 as ve,a6 as we,a7 as Ne,a8 as ke,a9 as Se,aa as Ce,ab as _e,ac as ze,ad as Ee,ae as Re,af as Te,ag as De,ah as Ie}from"./ui-vendor-BgHypBs-.js";import{c as Le,R as Pe,L as Me,C as Ae,X as Oe,Y as We,T as Be,a as Fe,b as $e,P as Ue,d as qe,e as He,B as Ve,f as Ye}from"./chart-vendor-sn3yAH-r.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Xe,Ke,Je={exports:{}},Ge={};var Ze,Qe=(Ke||(Ke=1,Je.exports=function(){if(Xe)return Ge;Xe=1;var t=e(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var l,o={},d=null,c=null;for(l in void 0!==r&&(d=""+r),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,l)&&!i.hasOwnProperty(l)&&(o[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===o[l]&&(o[l]=t[l]);return{$$typeof:s,type:e,key:d,ref:c,props:o,_owner:n.current}}return Ge.Fragment=r,Ge.jsx=l,Ge.jsxs=l,Ge}()),Je.exports),et={};var tt=function(){if(Ze)return et;Ze=1;var e=t();return et.createRoot=e.createRoot,et.hydrateRoot=e.hydrateRoot,et}(),st=(e,t,s,r,a,n,i,l)=>{let o=document.documentElement,d=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let s="class"===e,r=s&&n?a.map(e=>n[e]||e):a;s?(o.classList.remove(...r),o.classList.add(n&&n[t]?n[t]:t)):o.setAttribute(e,t)}),function(e){l&&d.includes(e)&&(o.style.colorScheme=e)}(t)}if(r)c(r);else try{let e=localStorage.getItem(t)||s;c(i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e)}catch(m){}},rt=s.createContext(void 0),at={setTheme:e=>{},themes:[]};s.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:a,enableColorScheme:n,defaultTheme:i,value:l,themes:o,nonce:d,scriptProps:c})=>{let m=JSON.stringify([r,t,i,e,o,l,a,n]).slice(1,-1);return s.createElement("script",{...c,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?d:"",dangerouslySetInnerHTML:{__html:`(${st.toString()})(${m})`}})});const nt=Array(12).fill(0),it=({visible:e,className:t})=>r.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},r.createElement("div",{className:"sonner-spinner"},nt.map((e,t)=>r.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),lt=r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},r.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),ot=r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},r.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),dt=r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},r.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ct=r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},r.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),mt=r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},r.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}));let xt=1;const ut=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:s,...r}=e,a="number"==typeof(null==e?void 0:e.id)||(null==(t=e.id)?void 0:t.length)>0?e.id:xt++,n=this.toasts.find(e=>e.id===a),i=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),n?this.toasts=this.toasts.map(t=>t.id===a?(this.publish({...t,...e,id:a,title:s}),{...t,...e,id:a,dismissible:i,title:s}):t):this.addToast({title:s,...r,dismissible:i,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let s;void 0!==t.loading&&(s=this.create({...t,promise:e,type:"loading",message:t.loading,description:"function"!=typeof t.description?t.description:void 0}));const a=Promise.resolve(e instanceof Function?e():e);let n,i=void 0!==s;const l=a.then(async e=>{n=["resolve",e];if(r.isValidElement(e))i=!1,this.create({id:s,type:"default",message:e});else if(ht(e)&&!e.ok){i=!1;const a="function"==typeof t.error?await t.error(`HTTP error! status: ${e.status}`):t.error,n="function"==typeof t.description?await t.description(`HTTP error! status: ${e.status}`):t.description,l="object"==typeof a&&!r.isValidElement(a)?a:{message:a};this.create({id:s,type:"error",description:n,...l})}else if(e instanceof Error){i=!1;const a="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,l="object"==typeof a&&!r.isValidElement(a)?a:{message:a};this.create({id:s,type:"error",description:n,...l})}else if(void 0!==t.success){i=!1;const a="function"==typeof t.success?await t.success(e):t.success,n="function"==typeof t.description?await t.description(e):t.description,l="object"==typeof a&&!r.isValidElement(a)?a:{message:a};this.create({id:s,type:"success",description:n,...l})}}).catch(async e=>{if(n=["reject",e],void 0!==t.error){i=!1;const a="function"==typeof t.error?await t.error(e):t.error,n="function"==typeof t.description?await t.description(e):t.description,l="object"==typeof a&&!r.isValidElement(a)?a:{message:a};this.create({id:s,type:"error",description:n,...l})}}).finally(()=>{i&&(this.dismiss(s),s=void 0),null==t.finally||t.finally.call(t)}),o=()=>new Promise((e,t)=>l.then(()=>"reject"===n[0]?t(n[1]):e(n[1])).catch(t));return"string"!=typeof s&&"number"!=typeof s?{unwrap:o}:Object.assign(s,{unwrap:o})},this.custom=(e,t)=>{const s=(null==t?void 0:t.id)||xt++;return this.create({jsx:e(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ht=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,pt=(e,t)=>{const s=(null==t?void 0:t.id)||xt++;return ut.addToast({title:e,...t,id:s}),s},gt=Object.assign(pt,{success:ut.success,info:ut.info,warning:ut.warning,error:ut.error,custom:ut.custom,message:ut.message,promise:ut.promise,dismiss:ut.dismiss,loading:ut.loading},{getHistory:()=>ut.toasts,getToasts:()=>ut.getActiveToasts()});function ft(e){return void 0!==e.label}!function(e){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const bt=3,yt=14;function jt(...e){return e.filter(Boolean).join(" ")}const vt=e=>{var t,s,a,n,i,l,o,d,c;const{invert:m,toast:x,unstyled:u,interacting:h,setHeights:p,visibleToasts:g,heights:f,index:b,toasts:y,expanded:j,removeToast:v,defaultRichColors:w,closeButton:N,style:k,cancelButtonStyle:S,actionButtonStyle:C,className:_="",descriptionClassName:z="",duration:E,position:R,gap:T,expandByDefault:D,classNames:I,icons:L,closeButtonAriaLabel:P="Close toast"}=e,[M,A]=r.useState(null),[O,W]=r.useState(null),[B,F]=r.useState(!1),[$,U]=r.useState(!1),[q,H]=r.useState(!1),[V,Y]=r.useState(!1),[X,K]=r.useState(!1),[J,G]=r.useState(0),[Z,Q]=r.useState(0),ee=r.useRef(x.duration||E||4e3),te=r.useRef(null),se=r.useRef(null),re=0===b,ae=b+1<=g,ne=x.type,ie=!1!==x.dismissible,le=x.className||"",oe=x.descriptionClassName||"",de=r.useMemo(()=>f.findIndex(e=>e.toastId===x.id)||0,[f,x.id]),ce=r.useMemo(()=>{var e;return null!=(e=x.closeButton)?e:N},[x.closeButton,N]),me=r.useMemo(()=>x.duration||E||4e3,[x.duration,E]),xe=r.useRef(0),ue=r.useRef(0),he=r.useRef(0),pe=r.useRef(null),[ge,fe]=R.split("-"),be=r.useMemo(()=>f.reduce((e,t,s)=>s>=de?e:e+t.height,0),[f,de]),ye=(()=>{const[e,t]=r.useState(document.hidden);return r.useEffect(()=>{const e=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),je=x.invert||m,ve="loading"===ne;ue.current=r.useMemo(()=>de*T+be,[de,be]),r.useEffect(()=>{ee.current=me},[me]),r.useEffect(()=>{F(!0)},[]),r.useEffect(()=>{const e=se.current;if(e){const t=e.getBoundingClientRect().height;return Q(t),p(e=>[{toastId:x.id,height:t,position:x.position},...e]),()=>p(e=>e.filter(e=>e.toastId!==x.id))}},[p,x.id]),r.useLayoutEffect(()=>{if(!B)return;const e=se.current,t=e.style.height;e.style.height="auto";const s=e.getBoundingClientRect().height;e.style.height=t,Q(s),p(e=>e.find(e=>e.toastId===x.id)?e.map(e=>e.toastId===x.id?{...e,height:s}:e):[{toastId:x.id,height:s,position:x.position},...e])},[B,x.title,x.description,p,x.id,x.jsx,x.action,x.cancel]);const we=r.useCallback(()=>{U(!0),G(ue.current),p(e=>e.filter(e=>e.toastId!==x.id)),setTimeout(()=>{v(x)},200)},[x,v,p,ue]);r.useEffect(()=>{if(x.promise&&"loading"===ne||x.duration===1/0||"loading"===x.type)return;let e;return j||h||ye?(()=>{if(he.current<xe.current){const e=(new Date).getTime()-xe.current;ee.current=ee.current-e}he.current=(new Date).getTime()})():ee.current!==1/0&&(xe.current=(new Date).getTime(),e=setTimeout(()=>{null==x.onAutoClose||x.onAutoClose.call(x,x),we()},ee.current)),()=>clearTimeout(e)},[j,h,x,ne,ye,we]),r.useEffect(()=>{x.delete&&(we(),null==x.onDismiss||x.onDismiss.call(x,x))},[we,x.delete]);const Ne=x.icon||(null==L?void 0:L[ne])||(e=>{switch(e){case"success":return lt;case"info":return dt;case"warning":return ot;case"error":return ct;default:return null}})(ne);var ke,Se;return r.createElement("li",{tabIndex:0,ref:se,className:jt(_,le,null==I?void 0:I.toast,null==x||null==(t=x.classNames)?void 0:t.toast,null==I?void 0:I.default,null==I?void 0:I[ne],null==x||null==(s=x.classNames)?void 0:s[ne]),"data-sonner-toast":"","data-rich-colors":null!=(ke=x.richColors)?ke:w,"data-styled":!Boolean(x.jsx||x.unstyled||u),"data-mounted":B,"data-promise":Boolean(x.promise),"data-swiped":X,"data-removed":$,"data-visible":ae,"data-y-position":ge,"data-x-position":fe,"data-index":b,"data-front":re,"data-swiping":q,"data-dismissible":ie,"data-type":ne,"data-invert":je,"data-swipe-out":V,"data-swipe-direction":O,"data-expanded":Boolean(j||D&&B),"data-testid":x.testId,style:{"--index":b,"--toasts-before":b,"--z-index":y.length-b,"--offset":`${$?J:ue.current}px`,"--initial-height":D?"auto":`${Z}px`,...k,...x.style},onDragEnd:()=>{H(!1),A(null),pe.current=null},onPointerDown:e=>{2!==e.button&&!ve&&ie&&(te.current=new Date,G(ue.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(H(!0),pe.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,t,s;if(V||!ie)return;pe.current=null;const r=Number((null==(e=se.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),a=Number((null==(t=se.current)?void 0:t.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),n=(new Date).getTime()-(null==(s=te.current)?void 0:s.getTime()),i="x"===M?r:a,l=Math.abs(i)/n;if(Math.abs(i)>=45||l>.11)return G(ue.current),null==x.onDismiss||x.onDismiss.call(x,x),W("x"===M?r>0?"right":"left":a>0?"down":"up"),we(),void Y(!0);var o,d;null==(o=se.current)||o.style.setProperty("--swipe-amount-x","0px"),null==(d=se.current)||d.style.setProperty("--swipe-amount-y","0px"),K(!1),H(!1),A(null)},onPointerMove:t=>{var s,r,a;if(!pe.current||!ie)return;if((null==(s=window.getSelection())?void 0:s.toString().length)>0)return;const n=t.clientY-pe.current.y,i=t.clientX-pe.current.x;var l;const o=null!=(l=e.swipeDirections)?l:function(e){const[t,s]=e.split("-"),r=[];return t&&r.push(t),s&&r.push(s),r}(R);!M&&(Math.abs(i)>1||Math.abs(n)>1)&&A(Math.abs(i)>Math.abs(n)?"x":"y");let d={x:0,y:0};const c=e=>1/(1.5+Math.abs(e)/20);if("y"===M){if(o.includes("top")||o.includes("bottom"))if(o.includes("top")&&n<0||o.includes("bottom")&&n>0)d.y=n;else{const e=n*c(n);d.y=Math.abs(e)<Math.abs(n)?e:n}}else if("x"===M&&(o.includes("left")||o.includes("right")))if(o.includes("left")&&i<0||o.includes("right")&&i>0)d.x=i;else{const e=i*c(i);d.x=Math.abs(e)<Math.abs(i)?e:i}(Math.abs(d.x)>0||Math.abs(d.y)>0)&&K(!0),null==(r=se.current)||r.style.setProperty("--swipe-amount-x",`${d.x}px`),null==(a=se.current)||a.style.setProperty("--swipe-amount-y",`${d.y}px`)}},ce&&!x.jsx&&"loading"!==ne?r.createElement("button",{"aria-label":P,"data-disabled":ve,"data-close-button":!0,onClick:ve||!ie?()=>{}:()=>{we(),null==x.onDismiss||x.onDismiss.call(x,x)},className:jt(null==I?void 0:I.closeButton,null==x||null==(a=x.classNames)?void 0:a.closeButton)},null!=(Se=null==L?void 0:L.close)?Se:mt):null,(ne||x.icon||x.promise)&&null!==x.icon&&(null!==(null==L?void 0:L[ne])||x.icon)?r.createElement("div",{"data-icon":"",className:jt(null==I?void 0:I.icon,null==x||null==(n=x.classNames)?void 0:n.icon)},x.promise||"loading"===x.type&&!x.icon?x.icon||function(){var e,t;return(null==L?void 0:L.loading)?r.createElement("div",{className:jt(null==I?void 0:I.loader,null==x||null==(t=x.classNames)?void 0:t.loader,"sonner-loader"),"data-visible":"loading"===ne},L.loading):r.createElement(it,{className:jt(null==I?void 0:I.loader,null==x||null==(e=x.classNames)?void 0:e.loader),visible:"loading"===ne})}():null,"loading"!==x.type?Ne:null):null,r.createElement("div",{"data-content":"",className:jt(null==I?void 0:I.content,null==x||null==(i=x.classNames)?void 0:i.content)},r.createElement("div",{"data-title":"",className:jt(null==I?void 0:I.title,null==x||null==(l=x.classNames)?void 0:l.title)},x.jsx?x.jsx:"function"==typeof x.title?x.title():x.title),x.description?r.createElement("div",{"data-description":"",className:jt(z,oe,null==I?void 0:I.description,null==x||null==(o=x.classNames)?void 0:o.description)},"function"==typeof x.description?x.description():x.description):null),r.isValidElement(x.cancel)?x.cancel:x.cancel&&ft(x.cancel)?r.createElement("button",{"data-button":!0,"data-cancel":!0,style:x.cancelButtonStyle||S,onClick:e=>{ft(x.cancel)&&ie&&(null==x.cancel.onClick||x.cancel.onClick.call(x.cancel,e),we())},className:jt(null==I?void 0:I.cancelButton,null==x||null==(d=x.classNames)?void 0:d.cancelButton)},x.cancel.label):null,r.isValidElement(x.action)?x.action:x.action&&ft(x.action)?r.createElement("button",{"data-button":!0,"data-action":!0,style:x.actionButtonStyle||C,onClick:e=>{ft(x.action)&&(null==x.action.onClick||x.action.onClick.call(x.action,e),e.defaultPrevented||we())},className:jt(null==I?void 0:I.actionButton,null==x||null==(c=x.classNames)?void 0:c.actionButton)},x.action.label):null)};function wt(){if("undefined"==typeof window)return"ltr";if("undefined"==typeof document)return"ltr";const e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}function Nt(e,t){const s={};return[e,t].forEach((e,t)=>{const r=1===t,a=r?"--mobile-offset":"--offset",n=r?"16px":"24px";function i(e){["top","right","bottom","left"].forEach(t=>{s[`${a}-${t}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?i(e):"object"==typeof e?["top","right","bottom","left"].forEach(t=>{void 0===e[t]?s[`${a}-${t}`]=n:s[`${a}-${t}`]="number"==typeof e[t]?`${e[t]}px`:e[t]}):i(n)}),s}const kt=r.forwardRef(function(e,t){const{id:s,invert:n,position:i="bottom-right",hotkey:l=["altKey","KeyT"],expand:o,closeButton:d,className:c,offset:m,mobileOffset:x,theme:u="light",richColors:h,duration:p,style:g,visibleToasts:f=bt,toastOptions:b,dir:y=wt(),gap:j=yt,icons:v,containerAriaLabel:w="Notifications"}=e,[N,k]=r.useState([]),S=r.useMemo(()=>s?N.filter(e=>e.toasterId===s):N.filter(e=>!e.toasterId),[N,s]),C=r.useMemo(()=>Array.from(new Set([i].concat(S.filter(e=>e.position).map(e=>e.position)))),[S,i]),[_,z]=r.useState([]),[E,R]=r.useState(!1),[T,D]=r.useState(!1),[I,L]=r.useState("system"!==u?u:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),P=r.useRef(null),M=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),A=r.useRef(null),O=r.useRef(!1),W=r.useCallback(e=>{k(t=>{var s;return(null==(s=t.find(t=>t.id===e.id))?void 0:s.delete)||ut.dismiss(e.id),t.filter(({id:t})=>t!==e.id)})},[]);return r.useEffect(()=>ut.subscribe(e=>{e.dismiss?requestAnimationFrame(()=>{k(t=>t.map(t=>t.id===e.id?{...t,delete:!0}:t))}):setTimeout(()=>{a.flushSync(()=>{k(t=>{const s=t.findIndex(t=>t.id===e.id);return-1!==s?[...t.slice(0,s),{...t[s],...e},...t.slice(s+1)]:[e,...t]})})})}),[N]),r.useEffect(()=>{if("system"!==u)return void L(u);if("system"===u&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?L("dark"):L("light")),"undefined"==typeof window)return;const e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{L(e?"dark":"light")})}catch(t){e.addListener(({matches:e})=>{try{L(e?"dark":"light")}catch(t){}})}},[u]),r.useEffect(()=>{N.length<=1&&R(!1)},[N]),r.useEffect(()=>{const e=e=>{var t;var s;l.every(t=>e[t]||e.code===t)&&(R(!0),null==(s=P.current)||s.focus());"Escape"!==e.code||document.activeElement!==P.current&&!(null==(t=P.current)?void 0:t.contains(document.activeElement))||R(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[l]),r.useEffect(()=>{if(P.current)return()=>{A.current&&(A.current.focus({preventScroll:!0}),A.current=null,O.current=!1)}},[P.current]),r.createElement("section",{ref:t,"aria-label":`${w} ${M}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},C.map((t,s)=>{var a;const[i,l]=t.split("-");return S.length?r.createElement("ol",{key:t,dir:"auto"===y?wt():y,tabIndex:-1,ref:P,className:c,"data-sonner-toaster":!0,"data-sonner-theme":I,"data-y-position":i,"data-x-position":l,style:{"--front-toast-height":`${(null==(a=_[0])?void 0:a.height)||0}px`,"--width":"356px","--gap":`${j}px`,...g,...Nt(m,x)},onBlur:e=>{O.current&&!e.currentTarget.contains(e.relatedTarget)&&(O.current=!1,A.current&&(A.current.focus({preventScroll:!0}),A.current=null))},onFocus:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||O.current||(O.current=!0,A.current=e.relatedTarget)},onMouseEnter:()=>R(!0),onMouseMove:()=>R(!0),onMouseLeave:()=>{T||R(!1)},onDragEnd:()=>R(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||D(!0)},onPointerUp:()=>D(!1)},S.filter(e=>!e.position&&0===s||e.position===t).map((s,a)=>{var i,l;return r.createElement(vt,{key:s.id,icons:v,index:a,toast:s,defaultRichColors:h,duration:null!=(i=null==b?void 0:b.duration)?i:p,className:null==b?void 0:b.className,descriptionClassName:null==b?void 0:b.descriptionClassName,invert:n,visibleToasts:f,closeButton:null!=(l=null==b?void 0:b.closeButton)?l:d,interacting:T,position:t,style:null==b?void 0:b.style,unstyled:null==b?void 0:b.unstyled,classNames:null==b?void 0:b.classNames,cancelButtonStyle:null==b?void 0:b.cancelButtonStyle,actionButtonStyle:null==b?void 0:b.actionButtonStyle,closeButtonAriaLabel:null==b?void 0:b.closeButtonAriaLabel,removeToast:W,toasts:S.filter(e=>e.position==s.position),heights:_.filter(e=>e.position==s.position),setHeights:z,expandByDefault:o,gap:j,expanded:E,swipeDirections:e.swipeDirections})})):null}))}),St=({...e})=>{const{theme:t="system"}=null!=(r=s.useContext(rt))?r:at;var r;return Qe.jsx(kt,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};const Ct=new class{baseURL;constructor(e="https://mlediamant.com"){this.baseURL=e}async request(e,t={}){const s=`${this.baseURL}${e}`,r={method:"GET",headers:{"Content-Type":"application/json",...t.headers},credentials:"include",...t};try{const e=await fetch(s,r);if(401===e.status)throw localStorage.removeItem("user"),localStorage.removeItem("session_token"),window.location.href="/login",new Error("Сессия истекла. Пожалуйста, перезагрузитесь.");if(!e.ok){const t=await e.json().catch(()=>({error:e.statusText}));throw new Error(t.error||t.message||`API Error: ${e.status}`)}return e.json()}catch(a){throw a}}async login(e,t){const s=new URLSearchParams;s.append("username",e),s.append("password",t);const r=await this.request("/api/login",{method:"POST",body:s,headers:{"Content-Type":"application/x-www-form-urlencoded"}});return r.user&&localStorage.setItem("user",JSON.stringify(r.user)),r.token&&localStorage.setItem("session_token",r.token),r}async logout(){try{await this.request("/api/logout",{method:"POST"})}finally{localStorage.removeItem("user"),localStorage.removeItem("session_token")}}async getDashboard(){return this.request("/api/dashboard")}async getStats(){return this.request("/api/stats")}async getAnalytics(e=30,t,s){let r=`/api/analytics?period=${e}`;return t&&s&&(r+=`&date_from=${t}&date_to=${s}`),this.request(r)}async getFunnel(){return this.request("/api/funnel")}async getSalonSettings(){return this.request("/api/salon-settings")}async updateSalonSettings(e){return this.request("/api/salon-settings",{method:"POST",body:JSON.stringify(e)})}async getUserProfile(e){return this.request(`/api/users/${e}/profile`)}async updateUserProfile(e,t){return this.request(`/api/users/${e}/update-profile`,{method:"POST",body:JSON.stringify(t)})}async changePassword(e,t){return this.request(`/api/users/${e}/change-password`,{method:"POST",body:JSON.stringify(t)})}async getClients(){return this.request("/api/clients")}async getClientUnreadCount(e){return this.request(`/api/chat/unread/${e}`)}async getClient(e){return this.request(`/api/clients/${e}`)}async updateClient(e,t){return this.request(`/api/clients/${e}/update`,{method:"POST",body:JSON.stringify(t)})}async updateClientStatus(e,t){return this.request(`/api/clients/${e}/status`,{method:"POST",body:JSON.stringify({status:t})})}async pinClient(e){return this.request(`/api/clients/${e}/pin`,{method:"POST"})}async deleteClient(e){return this.request(`/api/clients/${e}/delete`,{method:"POST"})}async createClient(e){return this.request("/api/clients",{method:"POST",body:JSON.stringify(e)})}async getBookings(){return this.request("/api/bookings")}async getBooking(e){return this.request(`/api/bookings/${e}`)}async createBooking(e){return this.request("/api/bookings",{method:"POST",body:JSON.stringify(e)})}async updateBookingStatus(e,t){return this.request(`/api/bookings/${e}/status`,{method:"POST",body:JSON.stringify({status:t})})}async sendMessage(e,t){return this.request("/api/chat/send",{method:"POST",body:JSON.stringify({instagram_id:e,message:t})})}async sendFile(e,t,s="image"){return this.request("/api/chat/send-file",{method:"POST",body:JSON.stringify({instagram_id:e,file_url:t,file_type:s})})}async getChatMessages(e,t=50){return this.request(`/api/chat/messages?client_id=${e}&limit=${t}`)}async getServices(e=!0){return this.request(`/api/services?active_only=${e}`)}async createService(e){return this.request("/api/services",{method:"POST",body:JSON.stringify(e)})}async updateService(e,t){return this.request(`/api/services/${e}/update`,{method:"POST",body:JSON.stringify(t)})}async deleteService(e){return this.request(`/api/services/${e}/delete`,{method:"POST"})}async getUsers(){return this.request("/api/users")}async createUser(e){const t=new FormData;t.append("username",e.username),t.append("password",e.password),t.append("full_name",e.full_name),e.email&&t.append("email",e.email),t.append("role",e.role);const s=await fetch(`${this.baseURL}/register`,{method:"POST",credentials:"include",body:t});if(!s.ok){const e=await s.json().catch(()=>({error:s.statusText}));throw new Error(e.error||"Ошибка создания пользователя")}return s.json().catch(()=>({success:!0}))}async deleteUser(e){return this.request(`/api/users/${e}/delete`,{method:"POST"})}async exportClients(e="csv"){const t=await fetch(`${this.baseURL}/api/export/clients?format=${e}`,{credentials:"include"});if(!t.ok)throw new Error("Export failed");return t.blob()}async exportAnalytics(e="csv",t=30,s,r){let a=`${this.baseURL}/api/export/analytics?format=${e}&period=${t}`;s&&r&&(a+=`&date_from=${s}&date_to=${r}`);const n=await fetch(a,{credentials:"include"});if(!n.ok){const e=await n.json().catch(()=>({error:"Export failed"}));throw new Error(e.error||"Export failed")}return n.blob()}async exportMessages(e,t="csv",s,r){let a=`${this.baseURL}/api/export/messages?format=${t}`;e&&(a+=`&client_id=${e}`),s&&r&&(a+=`&date_from=${s}&date_to=${r}`);const n=await fetch(a,{credentials:"include"});if(!n.ok)throw new Error("Export failed");return n.blob()}async exportFullData(e="csv"){const t=await fetch(`${this.baseURL}/api/export/full-data?format=${e}`,{credentials:"include"});if(!t.ok)throw new Error("Export failed");return t.blob()}async getUnreadCount(){return this.request("/api/unread-count")}async getBotSettings(){return this.request("/api/settings/bot")}async updateBotSettings(e){return this.request("/api/settings/bot",{method:"POST",body:JSON.stringify(e)})}async getSpecialPackages(){return this.request("/api/special-packages")}async createSpecialPackage(e){return this.request("/api/special-packages",{method:"POST",body:JSON.stringify(e)})}async updateSpecialPackage(e,t){return this.request(`/api/special-packages/${e}`,{method:"POST",body:JSON.stringify(t)})}async deleteSpecialPackage(e){return this.request(`/api/special-packages/${e}`,{method:"DELETE"})}async getRoles(){return this.request("/api/roles")}async createRole(e){return this.request("/api/roles",{method:"POST",body:JSON.stringify(e)})}async deleteRole(e){return this.request(`/api/roles/${e}`,{method:"DELETE"})}async getRolePermissions(e){return this.request(`/api/roles/${e}/permissions`)}async updateRolePermissions(e,t){return this.request(`/api/roles/${e}/permissions`,{method:"POST",body:JSON.stringify({permissions:t})})}async getAvailablePermissions(){return this.request("/api/permissions/available")}async getUserPermissions(e){return this.request(`/api/users/${e}/permissions`)}async updateUserRole(e,t){return this.request(`/api/users/${e}/role`,{method:"POST",body:JSON.stringify({role:t})})}async reactToMessage(e,t){return this.request("/api/chat/react",{method:"POST",body:JSON.stringify({message_id:e,emoji:t})})}async getMessageReactions(e){return this.request(`/api/chat/reactions/${e}`)}async getMessageTemplates(){return this.request("/api/chat/templates")}async createMessageTemplate(e){return this.request("/api/chat/templates",{method:"POST",body:JSON.stringify(e)})}async updateMessageTemplate(e,t){return this.request(`/api/chat/templates/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteMessageTemplate(e){return this.request(`/api/chat/templates/${e}`,{method:"DELETE"})}async scheduleMessage(e,t,s){return this.request("/api/chat/schedule",{method:"POST",body:JSON.stringify({client_id:e,message:t,send_at:s})})}async getScheduledMessages(){return this.request("/api/chat/scheduled")}async cancelScheduledMessage(e){return this.request(`/api/chat/scheduled/${e}/cancel`,{method:"POST"})}async getClientStatuses(){return this.request("/api/statuses/client")}async createClientStatus(e){return this.request("/api/statuses/client",{method:"POST",body:JSON.stringify(e)})}async deleteClientStatus(e){return this.request(`/api/statuses/client/${e}`,{method:"DELETE"})}async createBookingStatus(e){return this.request("/api/statuses/booking",{method:"POST",body:JSON.stringify(e)})}async getBookingStatuses(){return this.request("/api/statuses/booking")}};function _t({user:e,onLogout:t}){const r=n(),a=i(),[o,d]=s.useState(0),[c,m]=s.useState(!1),x=[{icon:f,label:"Панель управления",path:"/admin/dashboard"},{icon:b,label:"Записи",path:"/admin/bookings"},{icon:y,label:"Клиенты",path:"/admin/clients"},{icon:j,label:"Чат",path:"/admin/chat",badge:o},{icon:v,label:"Аналитика",path:"/admin/analytics"},{icon:w,label:"Услуги",path:"/admin/services"},{icon:N,label:"Сотрудники",path:"/admin/users"},{icon:k,label:"Календарь",path:"/admin/calendar"},{icon:S,label:"Настройки",path:"/admin/settings"},{icon:C,label:"Настройки бота",path:"/admin/bot-settings"}];s.useEffect(()=>{u();const e=setInterval(u,1e4);return()=>clearInterval(e)},[]),s.useEffect(()=>{const e=()=>{window.innerWidth>1100&&c&&m(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[c]),s.useEffect(()=>(c&&window.innerWidth<=1100?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[c]);const u=async()=>{try{const e=await Ct.getUnreadCount();d(e.count||0)}catch(e){}};return Qe.jsxs("div",{className:"flex h-screen bg-gray-50",children:[Qe.jsx("button",{onClick:()=>m(!c),className:"mobile-burger-button fixed top-4 right-4 z-[45] w-10 h-10 bg-white rounded-lg shadow-lg flex items-center justify-center border border-gray-200 hover:bg-gray-50 transition-colors",children:Qe.jsx("svg",{className:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),c&&Qe.jsx("div",{onClick:()=>m(!1),className:"mobile-overlay fixed inset-0 bg-black/50 z-40"}),Qe.jsxs("aside",{className:"mobile-sidebar w-64 bg-white border-r border-gray-200 flex flex-col z-50 transition-transform duration-300 ease-in-out "+(c?"is-open":""),children:[Qe.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("h1",{className:"text-2xl font-bold text-pink-600",children:"💎 CRM"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Администратор"})]}),Qe.jsx("button",{onClick:()=>m(!1),className:"mobile-close-button w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors","aria-label":"Close menu",children:Qe.jsx(g,{className:"w-5 h-5 text-gray-600"})})]}),Qe.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:Qe.jsx("ul",{className:"space-y-1",children:x.map(e=>{const t=e.icon,s=r.pathname.startsWith(e.path);return Qe.jsx("li",{children:Qe.jsxs("button",{onClick:()=>{return t=e.path,a(t),void(window.innerWidth<=1100&&m(!1));var t},className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 relative "+(s?"bg-gradient-to-r from-pink-100 to-purple-100 text-pink-600 shadow-sm":"text-gray-700 hover:bg-gray-50"),children:[Qe.jsx(t,{className:"w-5 h-5 "+(s?"text-pink-600":"text-gray-500")}),Qe.jsx("span",{className:s?"font-semibold":"font-medium",children:e.label}),e.badge&&e.badge>0&&Qe.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center animate-pulse",children:e.badge>99?"99+":e.badge})]})},e.path)})})}),Qe.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-md",children:e?.full_name?.charAt(0).toUpperCase()||"A"}),Qe.jsxs("div",{className:"flex-1 min-w-0",children:[Qe.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:e?.full_name||"Администратор"}),Qe.jsx("p",{className:"text-xs text-gray-500 capitalize",children:e?.role||"admin"})]})]}),Qe.jsxs("button",{onClick:async()=>{try{await fetch("/api/logout",{method:"POST",credentials:"include"})}catch(e){}finally{localStorage.removeItem("session_token"),localStorage.removeItem("user"),t(),a("/login",{replace:!0}),gt.success("Вы успешно вышли из системы")}},className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors font-medium text-sm",children:[Qe.jsx(_,{className:"w-4 h-4"}),Qe.jsx("span",{children:"Выйти"})]})]})]}),Qe.jsx("main",{className:"flex-1 overflow-y-auto bg-gray-50",children:Qe.jsx(l,{})})]})}function zt(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function Et(...e){return t=>{let s=!1;const r=e.map(e=>{const r=zt(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){const s=r[t];"function"==typeof s?s():zt(e[t],null)}}}}function Rt(...e){return s.useCallback(Et(...e),e)}function Tt(e){const t=It(e),r=s.forwardRef((e,r)=>{const{children:a,...n}=e,i=s.Children.toArray(a),l=i.find(Pt);if(l){const e=l.props.children,a=i.map(t=>t===l?s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null:t);return Qe.jsx(t,{...n,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,a):null})}return Qe.jsx(t,{...n,ref:r,children:a})});return r.displayName=`${e}.Slot`,r}var Dt=Tt("Slot");function It(e){const t=s.forwardRef((e,t)=>{const{children:r,...a}=e;if(s.isValidElement(r)){const e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning;if(s)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s)return e.props.ref;return e.props.ref||e.ref}(r),n=function(e,t){const s={...t};for(const r in t){const a=e[r],n=t[r];/^on[A-Z]/.test(r)?a&&n?s[r]=(...e)=>{const t=n(...e);return a(...e),t}:a&&(s[r]=a):"style"===r?s[r]={...a,...n}:"className"===r&&(s[r]=[a,n].filter(Boolean).join(" "))}return{...e,...s}}(a,r.props);return r.type!==s.Fragment&&(n.ref=t?Et(t,e):e),s.cloneElement(r,n)}return s.Children.count(r)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Lt=Symbol("radix.slottable");function Pt(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===Lt}const Mt=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,At=Le,Ot=(e,t)=>s=>{var r;if(null==(null==t?void 0:t.variants))return At(e,null==s?void 0:s.class,null==s?void 0:s.className);const{variants:a,defaultVariants:n}=t,i=Object.keys(a).map(e=>{const t=null==s?void 0:s[e],r=null==n?void 0:n[e];if(null===t)return null;const i=Mt(t)||Mt(r);return a[e][i]}),l=s&&Object.entries(s).reduce((e,t)=>{let[s,r]=t;return void 0===r||(e[s]=r),e},{}),o=null==t||null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:s,className:r,...a}=t;return Object.entries(a).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...l}[t]):{...n,...l}[t]===s})?[...e,s,r]:e},[]);return At(e,i,o,null==s?void 0:s.class,null==s?void 0:s.className)},Wt=e=>{const t=Ut(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const s=e.split("-");return""===s[0]&&1!==s.length&&s.shift(),Bt(s,t)||$t(e)},getConflictingClassGroupIds:(e,t)=>{const a=s[e]||[];return t&&r[e]?[...a,...r[e]]:a}}},Bt=(e,t)=>{if(0===e.length)return t.classGroupId;const s=e[0],r=t.nextPart.get(s),a=r?Bt(e.slice(1),r):void 0;if(a)return a;if(0===t.validators.length)return;const n=e.join("-");return t.validators.find(({validator:e})=>e(n))?.classGroupId},Ft=/^\[(.+)\]$/,$t=e=>{if(Ft.test(e)){const t=Ft.exec(e)[1],s=t?.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},Ut=e=>{const{theme:t,classGroups:s}=e,r={nextPart:new Map,validators:[]};for(const a in s)qt(s[a],r,a,t);return r},qt=(e,t,s,r)=>{e.forEach(e=>{if("string"==typeof e){return void((""===e?t:Ht(t,e)).classGroupId=s)}if("function"==typeof e)return Vt(e)?void qt(e(r),t,s,r):void t.validators.push({validator:e,classGroupId:s});Object.entries(e).forEach(([e,a])=>{qt(a,Ht(t,e),s,r)})})},Ht=(e,t)=>{let s=e;return t.split("-").forEach(e=>{s.nextPart.has(e)||s.nextPart.set(e,{nextPart:new Map,validators:[]}),s=s.nextPart.get(e)}),s},Vt=e=>e.isThemeGetter,Yt=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,r=new Map;const a=(a,n)=>{s.set(a,n),t++,t>e&&(t=0,r=s,s=new Map)};return{get(e){let t=s.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(a(e,t),t):void 0},set(e,t){s.has(e)?s.set(e,t):a(e,t)}}},Xt=e=>{const{prefix:t,experimentalParseClassName:s}=e;let r=e=>{const t=[];let s,r=0,a=0,n=0;for(let o=0;o<e.length;o++){let i=e[o];if(0===r&&0===a){if(":"===i){t.push(e.slice(n,o)),n=o+1;continue}if("/"===i){s=o;continue}}"["===i?r++:"]"===i?r--:"("===i?a++:")"===i&&a--}const i=0===t.length?e:e.substring(n),l=Kt(i);return{modifiers:t,hasImportantModifier:l!==i,baseClassName:l,maybePostfixModifierPosition:s&&s>n?s-n:void 0}};if(t){const e=t+":",s=r;r=t=>t.startsWith(e)?s(t.substring(e.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:t,maybePostfixModifierPosition:void 0}}if(s){const e=r;r=t=>s({className:t,parseClassName:e})}return r},Kt=e=>e.endsWith("!")?e.substring(0,e.length-1):e.startsWith("!")?e.substring(1):e,Jt=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(e=>[e,!0]));return e=>{if(e.length<=1)return e;const s=[];let r=[];return e.forEach(e=>{"["===e[0]||t[e]?(s.push(...r.sort(),e),r=[]):r.push(e)}),s.push(...r.sort()),s}},Gt=/\s+/;function Zt(){let e,t,s=0,r="";for(;s<arguments.length;)(e=arguments[s++])&&(t=Qt(e))&&(r&&(r+=" "),r+=t);return r}const Qt=e=>{if("string"==typeof e)return e;let t,s="";for(let r=0;r<e.length;r++)e[r]&&(t=Qt(e[r]))&&(s&&(s+=" "),s+=t);return s};function es(e,...t){let s,r,a,n=function(l){const o=t.reduce((e,t)=>t(e),e());return s=(e=>({cache:Yt(e.cacheSize),parseClassName:Xt(e),sortModifiers:Jt(e),...Wt(e)}))(o),r=s.cache.get,a=s.cache.set,n=i,i(l)};function i(e){const t=r(e);if(t)return t;const n=((e,t)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:a,sortModifiers:n}=t,i=[],l=e.trim().split(Gt);let o="";for(let d=l.length-1;d>=0;d-=1){const e=l[d],{isExternal:t,modifiers:c,hasImportantModifier:m,baseClassName:x,maybePostfixModifierPosition:u}=s(e);if(t){o=e+(o.length>0?" "+o:o);continue}let h=!!u,p=r(h?x.substring(0,u):x);if(!p){if(!h){o=e+(o.length>0?" "+o:o);continue}if(p=r(x),!p){o=e+(o.length>0?" "+o:o);continue}h=!1}const g=n(c).join(":"),f=m?g+"!":g,b=f+p;if(i.includes(b))continue;i.push(b);const y=a(p,h);for(let s=0;s<y.length;++s){const e=y[s];i.push(f+e)}o=e+(o.length>0?" "+o:o)}return o})(e,s);return a(e,n),n}return function(){return n(Zt.apply(null,arguments))}}const ts=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},ss=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,rs=/^\((?:(\w[\w-]*):)?(.+)\)$/i,as=/^\d+\/\d+$/,ns=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,is=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ls=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,os=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ds=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,cs=e=>as.test(e),ms=e=>!!e&&!Number.isNaN(Number(e)),xs=e=>!!e&&Number.isInteger(Number(e)),us=e=>e.endsWith("%")&&ms(e.slice(0,-1)),hs=e=>ns.test(e),ps=()=>!0,gs=e=>is.test(e)&&!ls.test(e),fs=()=>!1,bs=e=>os.test(e),ys=e=>ds.test(e),js=e=>!ws(e)&&!zs(e),vs=e=>Ps(e,Ws,fs),ws=e=>ss.test(e),Ns=e=>Ps(e,Bs,gs),ks=e=>Ps(e,Fs,ms),Ss=e=>Ps(e,As,fs),Cs=e=>Ps(e,Os,ys),_s=e=>Ps(e,Us,bs),zs=e=>rs.test(e),Es=e=>Ms(e,Bs),Rs=e=>Ms(e,$s),Ts=e=>Ms(e,As),Ds=e=>Ms(e,Ws),Is=e=>Ms(e,Os),Ls=e=>Ms(e,Us,!0),Ps=(e,t,s)=>{const r=ss.exec(e);return!!r&&(r[1]?t(r[1]):s(r[2]))},Ms=(e,t,s=!1)=>{const r=rs.exec(e);return!!r&&(r[1]?t(r[1]):s)},As=e=>"position"===e||"percentage"===e,Os=e=>"image"===e||"url"===e,Ws=e=>"length"===e||"size"===e||"bg-size"===e,Bs=e=>"length"===e,Fs=e=>"number"===e,$s=e=>"family-name"===e,Us=e=>"shadow"===e,qs=es(()=>{const e=ts("color"),t=ts("font"),s=ts("text"),r=ts("font-weight"),a=ts("tracking"),n=ts("leading"),i=ts("breakpoint"),l=ts("container"),o=ts("spacing"),d=ts("radius"),c=ts("shadow"),m=ts("inset-shadow"),x=ts("text-shadow"),u=ts("drop-shadow"),h=ts("blur"),p=ts("perspective"),g=ts("aspect"),f=ts("ease"),b=ts("animate"),y=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",zs,ws],j=()=>[zs,ws,o],v=()=>[cs,"full","auto",...j()],w=()=>[xs,"none","subgrid",zs,ws],N=()=>["auto",{span:["full",xs,zs,ws]},xs,zs,ws],k=()=>[xs,"auto",zs,ws],S=()=>["auto","min","max","fr",zs,ws],C=()=>["auto",...j()],_=()=>[cs,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...j()],z=()=>[e,zs,ws],E=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",Ts,Ss,{position:[zs,ws]}],R=()=>["auto","cover","contain",Ds,vs,{size:[zs,ws]}],T=()=>[us,Es,Ns],D=()=>["","none","full",d,zs,ws],I=()=>["",ms,Es,Ns],L=()=>[ms,us,Ts,Ss],P=()=>["","none",h,zs,ws],M=()=>["none",ms,zs,ws],A=()=>["none",ms,zs,ws],O=()=>[ms,zs,ws],W=()=>[cs,"full",...j()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[hs],breakpoint:[hs],color:[ps],container:[hs],"drop-shadow":[hs],ease:["in","out","in-out"],font:[js],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[hs],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[hs],shadow:[hs],spacing:["px",ms],text:[hs],"text-shadow":[hs],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",cs,ws,zs,g]}],container:["container"],columns:[{columns:[ms,ws,zs,l]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:y()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:v()}],"inset-x":[{"inset-x":v()}],"inset-y":[{"inset-y":v()}],start:[{start:v()}],end:[{end:v()}],top:[{top:v()}],right:[{right:v()}],bottom:[{bottom:v()}],left:[{left:v()}],visibility:["visible","invisible","collapse"],z:[{z:[xs,"auto",zs,ws]}],basis:[{basis:[cs,"full","auto",l,...j()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ms,cs,"auto","initial","none",ws]}],grow:[{grow:["",ms,zs,ws]}],shrink:[{shrink:["",ms,zs,ws]}],order:[{order:[xs,"first","last","none",zs,ws]}],"grid-cols":[{"grid-cols":w()}],"col-start-end":[{col:N()}],"col-start":[{"col-start":k()}],"col-end":[{"col-end":k()}],"grid-rows":[{"grid-rows":w()}],"row-start-end":[{row:N()}],"row-start":[{"row-start":k()}],"row-end":[{"row-end":k()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":S()}],"auto-rows":[{"auto-rows":S()}],gap:[{gap:j()}],"gap-x":[{"gap-x":j()}],"gap-y":[{"gap-y":j()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:j()}],px:[{px:j()}],py:[{py:j()}],ps:[{ps:j()}],pe:[{pe:j()}],pt:[{pt:j()}],pr:[{pr:j()}],pb:[{pb:j()}],pl:[{pl:j()}],m:[{m:C()}],mx:[{mx:C()}],my:[{my:C()}],ms:[{ms:C()}],me:[{me:C()}],mt:[{mt:C()}],mr:[{mr:C()}],mb:[{mb:C()}],ml:[{ml:C()}],"space-x":[{"space-x":j()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":j()}],"space-y-reverse":["space-y-reverse"],size:[{size:_()}],w:[{w:[l,"screen",..._()]}],"min-w":[{"min-w":[l,"screen","none",..._()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[i]},..._()]}],h:[{h:["screen","lh",..._()]}],"min-h":[{"min-h":["screen","lh","none",..._()]}],"max-h":[{"max-h":["screen","lh",..._()]}],"font-size":[{text:["base",s,Es,Ns]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,zs,ks]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",us,ws]}],"font-family":[{font:[Rs,ws,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,zs,ws]}],"line-clamp":[{"line-clamp":[ms,"none",zs,ks]}],leading:[{leading:[n,...j()]}],"list-image":[{"list-image":["none",zs,ws]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",zs,ws]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:z()}],"text-color":[{text:z()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[ms,"from-font","auto",zs,Ns]}],"text-decoration-color":[{decoration:z()}],"underline-offset":[{"underline-offset":[ms,"auto",zs,ws]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",zs,ws]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",zs,ws]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:E()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:R()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xs,zs,ws],radial:["",zs,ws],conic:[xs,zs,ws]},Is,Cs]}],"bg-color":[{bg:z()}],"gradient-from-pos":[{from:T()}],"gradient-via-pos":[{via:T()}],"gradient-to-pos":[{to:T()}],"gradient-from":[{from:z()}],"gradient-via":[{via:z()}],"gradient-to":[{to:z()}],rounded:[{rounded:D()}],"rounded-s":[{"rounded-s":D()}],"rounded-e":[{"rounded-e":D()}],"rounded-t":[{"rounded-t":D()}],"rounded-r":[{"rounded-r":D()}],"rounded-b":[{"rounded-b":D()}],"rounded-l":[{"rounded-l":D()}],"rounded-ss":[{"rounded-ss":D()}],"rounded-se":[{"rounded-se":D()}],"rounded-ee":[{"rounded-ee":D()}],"rounded-es":[{"rounded-es":D()}],"rounded-tl":[{"rounded-tl":D()}],"rounded-tr":[{"rounded-tr":D()}],"rounded-br":[{"rounded-br":D()}],"rounded-bl":[{"rounded-bl":D()}],"border-w":[{border:I()}],"border-w-x":[{"border-x":I()}],"border-w-y":[{"border-y":I()}],"border-w-s":[{"border-s":I()}],"border-w-e":[{"border-e":I()}],"border-w-t":[{"border-t":I()}],"border-w-r":[{"border-r":I()}],"border-w-b":[{"border-b":I()}],"border-w-l":[{"border-l":I()}],"divide-x":[{"divide-x":I()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":I()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:z()}],"border-color-x":[{"border-x":z()}],"border-color-y":[{"border-y":z()}],"border-color-s":[{"border-s":z()}],"border-color-e":[{"border-e":z()}],"border-color-t":[{"border-t":z()}],"border-color-r":[{"border-r":z()}],"border-color-b":[{"border-b":z()}],"border-color-l":[{"border-l":z()}],"divide-color":[{divide:z()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[ms,zs,ws]}],"outline-w":[{outline:["",ms,Es,Ns]}],"outline-color":[{outline:z()}],shadow:[{shadow:["","none",c,Ls,_s]}],"shadow-color":[{shadow:z()}],"inset-shadow":[{"inset-shadow":["none",m,Ls,_s]}],"inset-shadow-color":[{"inset-shadow":z()}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:z()}],"ring-offset-w":[{"ring-offset":[ms,Ns]}],"ring-offset-color":[{"ring-offset":z()}],"inset-ring-w":[{"inset-ring":I()}],"inset-ring-color":[{"inset-ring":z()}],"text-shadow":[{"text-shadow":["none",x,Ls,_s]}],"text-shadow-color":[{"text-shadow":z()}],opacity:[{opacity:[ms,zs,ws]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ms]}],"mask-image-linear-from-pos":[{"mask-linear-from":L()}],"mask-image-linear-to-pos":[{"mask-linear-to":L()}],"mask-image-linear-from-color":[{"mask-linear-from":z()}],"mask-image-linear-to-color":[{"mask-linear-to":z()}],"mask-image-t-from-pos":[{"mask-t-from":L()}],"mask-image-t-to-pos":[{"mask-t-to":L()}],"mask-image-t-from-color":[{"mask-t-from":z()}],"mask-image-t-to-color":[{"mask-t-to":z()}],"mask-image-r-from-pos":[{"mask-r-from":L()}],"mask-image-r-to-pos":[{"mask-r-to":L()}],"mask-image-r-from-color":[{"mask-r-from":z()}],"mask-image-r-to-color":[{"mask-r-to":z()}],"mask-image-b-from-pos":[{"mask-b-from":L()}],"mask-image-b-to-pos":[{"mask-b-to":L()}],"mask-image-b-from-color":[{"mask-b-from":z()}],"mask-image-b-to-color":[{"mask-b-to":z()}],"mask-image-l-from-pos":[{"mask-l-from":L()}],"mask-image-l-to-pos":[{"mask-l-to":L()}],"mask-image-l-from-color":[{"mask-l-from":z()}],"mask-image-l-to-color":[{"mask-l-to":z()}],"mask-image-x-from-pos":[{"mask-x-from":L()}],"mask-image-x-to-pos":[{"mask-x-to":L()}],"mask-image-x-from-color":[{"mask-x-from":z()}],"mask-image-x-to-color":[{"mask-x-to":z()}],"mask-image-y-from-pos":[{"mask-y-from":L()}],"mask-image-y-to-pos":[{"mask-y-to":L()}],"mask-image-y-from-color":[{"mask-y-from":z()}],"mask-image-y-to-color":[{"mask-y-to":z()}],"mask-image-radial":[{"mask-radial":[zs,ws]}],"mask-image-radial-from-pos":[{"mask-radial-from":L()}],"mask-image-radial-to-pos":[{"mask-radial-to":L()}],"mask-image-radial-from-color":[{"mask-radial-from":z()}],"mask-image-radial-to-color":[{"mask-radial-to":z()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[ms]}],"mask-image-conic-from-pos":[{"mask-conic-from":L()}],"mask-image-conic-to-pos":[{"mask-conic-to":L()}],"mask-image-conic-from-color":[{"mask-conic-from":z()}],"mask-image-conic-to-color":[{"mask-conic-to":z()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:E()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:R()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",zs,ws]}],filter:[{filter:["","none",zs,ws]}],blur:[{blur:P()}],brightness:[{brightness:[ms,zs,ws]}],contrast:[{contrast:[ms,zs,ws]}],"drop-shadow":[{"drop-shadow":["","none",u,Ls,_s]}],"drop-shadow-color":[{"drop-shadow":z()}],grayscale:[{grayscale:["",ms,zs,ws]}],"hue-rotate":[{"hue-rotate":[ms,zs,ws]}],invert:[{invert:["",ms,zs,ws]}],saturate:[{saturate:[ms,zs,ws]}],sepia:[{sepia:["",ms,zs,ws]}],"backdrop-filter":[{"backdrop-filter":["","none",zs,ws]}],"backdrop-blur":[{"backdrop-blur":P()}],"backdrop-brightness":[{"backdrop-brightness":[ms,zs,ws]}],"backdrop-contrast":[{"backdrop-contrast":[ms,zs,ws]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ms,zs,ws]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ms,zs,ws]}],"backdrop-invert":[{"backdrop-invert":["",ms,zs,ws]}],"backdrop-opacity":[{"backdrop-opacity":[ms,zs,ws]}],"backdrop-saturate":[{"backdrop-saturate":[ms,zs,ws]}],"backdrop-sepia":[{"backdrop-sepia":["",ms,zs,ws]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":j()}],"border-spacing-x":[{"border-spacing-x":j()}],"border-spacing-y":[{"border-spacing-y":j()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",zs,ws]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ms,"initial",zs,ws]}],ease:[{ease:["linear","initial",f,zs,ws]}],delay:[{delay:[ms,zs,ws]}],animate:[{animate:["none",b,zs,ws]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[p,zs,ws]}],"perspective-origin":[{"perspective-origin":y()}],rotate:[{rotate:M()}],"rotate-x":[{"rotate-x":M()}],"rotate-y":[{"rotate-y":M()}],"rotate-z":[{"rotate-z":M()}],scale:[{scale:A()}],"scale-x":[{"scale-x":A()}],"scale-y":[{"scale-y":A()}],"scale-z":[{"scale-z":A()}],"scale-3d":["scale-3d"],skew:[{skew:O()}],"skew-x":[{"skew-x":O()}],"skew-y":[{"skew-y":O()}],transform:[{transform:[zs,ws,"","none","gpu","cpu"]}],"transform-origin":[{origin:y()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:W()}],"translate-x":[{"translate-x":W()}],"translate-y":[{"translate-y":W()}],"translate-z":[{"translate-z":W()}],"translate-none":["translate-none"],accent:[{accent:z()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:z()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",zs,ws]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",zs,ws]}],fill:[{fill:["none",...z()]}],"stroke-w":[{stroke:[ms,Es,Ns,ks]}],stroke:[{stroke:["none",...z()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}});function Hs(...e){return qs(Le(e))}const Vs=Ot("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function Ys({className:e,variant:t,size:s,asChild:r=!1,...a}){const n=r?Dt:"button";return Qe.jsx(n,{"data-slot":"button",className:Hs(Vs({variant:t,size:s,className:e})),...a})}function Xs(){const e=i(),[t,r]=s.useState(null),[a,n]=s.useState([]),[l,o]=s.useState(!0),[d,c]=s.useState(null);s.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0),c(null);const[e,t]=await Promise.all([Ct.getStats(),Ct.getBookings()]);r(e),t.bookings&&n(t.bookings.slice(0,3))}catch(e){const t=e instanceof Error?e.message:"Ошибка загрузки";c(t),gt.error(`Ошибка: ${t}`)}finally{o(!1)}};if(l)return Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка данных..."})]})});if(d)return Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:d}),Qe.jsx(Ys,{onClick:m,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})});if(!t)return Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:Qe.jsx("p",{className:"text-yellow-800",children:"Нет данных"})})});const x=[{icon:R,label:"Записи ожидают",value:t.pending_bookings||0,color:"text-pink-600",bg:"bg-pink-50"},{icon:y,label:"Новые клиенты",value:t.new_clients||0,color:"text-purple-600",bg:"bg-purple-50"},{icon:T,label:"Общий доход",value:`${(t.total_revenue||0).toFixed(0)} AED`,color:"text-green-600",bg:"bg-green-50"},{icon:D,label:"Конверсия",value:`${(t.conversion_rate||0).toFixed(1)}%`,color:"text-blue-600",bg:"bg-blue-50"}];return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsx("h1",{className:"text-3xl text-gray-900 mb-2",children:"Панель управления"}),Qe.jsx("p",{className:"text-gray-600",children:"Добро пожаловать в систему управления салоном"})]}),Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:x.map((e,t)=>{const s=e.icon;return Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[Qe.jsx("div",{className:"flex items-start justify-between mb-4",children:Qe.jsx("div",{className:`w-12 h-12 ${e.bg} rounded-lg flex items-center justify-center`,children:Qe.jsx(s,{className:`w-6 h-6 ${e.color}`})})}),Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-1",children:e.value}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:e.label})]},t)})}),Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900",children:"Последние записи"}),Qe.jsx(Ys,{variant:"outline",size:"sm",onClick:()=>e("/admin/bookings"),children:"Все записи"})]}),Qe.jsx("div",{className:"space-y-4",children:a.length>0?a.map(t=>{const s={pending:{text:"Ожидание",bg:"bg-yellow-100",color:"text-yellow-800"},confirmed:{text:"Подтверждена",bg:"bg-green-100",color:"text-green-800"},completed:{text:"Завершена",bg:"bg-blue-100",color:"text-blue-800"},cancelled:{text:"Отменена",bg:"bg-red-100",color:"text-red-800"}}[r=t.status]||{text:r,bg:"bg-gray-100",color:"text-gray-800"};var r;return Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>e(`/admin/bookings/${t.id}`),children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center text-pink-600 font-bold",children:t.name?.charAt(0)||"С"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:t.name||"Не указано"}),Qe.jsx("p",{className:"text-xs text-gray-500",children:t.service||"Нет услуги"})]})]}),Qe.jsxs("div",{className:"text-right",children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:new Date(t.datetime).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}),Qe.jsx("span",{className:`text-xs px-2 py-1 rounded ${s.bg} ${s.color}`,children:s.text})]})]},t.id)}):Qe.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Qe.jsx(R,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),Qe.jsx("p",{children:"Нет записей"})]})})]}),Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6",children:"Быстрые действия"}),Qe.jsxs("div",{className:"space-y-3",children:[Qe.jsxs(Ys,{className:"w-full justify-start bg-pink-600 hover:bg-pink-700",onClick:()=>e("/admin/bookings"),children:[Qe.jsx(R,{className:"w-4 h-4 mr-2"}),"Создать запись"]}),Qe.jsxs(Ys,{variant:"outline",className:"w-full justify-start",onClick:()=>e("/admin/clients"),children:[Qe.jsx(y,{className:"w-4 h-4 mr-2"}),"Добавить клиента"]}),Qe.jsxs(Ys,{variant:"outline",className:"w-full justify-start",onClick:()=>e("/admin/users/create"),children:[Qe.jsx(y,{className:"w-4 h-4 mr-2"}),"Создать пользователя"]}),Qe.jsxs(Ys,{variant:"outline",className:"w-full justify-start",onClick:()=>e("/admin/analytics"),children:[Qe.jsx(D,{className:"w-4 h-4 mr-2"}),"Просмотреть аналитику"]}),Qe.jsxs(Ys,{variant:"outline",className:"w-full justify-start",onClick:()=>e("/admin/calendar"),children:[Qe.jsx(R,{className:"w-4 h-4 mr-2"}),"Календарь"]})]})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Всего клиентов"}),Qe.jsx("p",{className:"text-3xl text-gray-900 font-bold",children:t.total_clients}),Qe.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["+",t.new_clients," новых"]})]}),Qe.jsx(y,{className:"w-8 h-8 text-blue-600"})]})}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Всего записей"}),Qe.jsx("p",{className:"text-3xl text-gray-900 font-bold",children:t.total_bookings}),Qe.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[t.completed_bookings," завершено"]})]}),Qe.jsx(I,{className:"w-8 h-8 text-green-600"})]})}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-gray-600 text-sm mb-1",children:"Сообщений"}),Qe.jsx("p",{className:"text-3xl text-gray-900 font-bold",children:(t.total_client_messages||0)+(t.total_bot_messages||0)}),Qe.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["👤 ",t.total_client_messages||0," | 🤖 ",t.total_bot_messages||0]})]}),Qe.jsx(D,{className:"w-8 h-8 text-purple-600"})]})})]})]})}function Ks(e,[t,s]){return Math.min(s,Math.max(t,e))}function Js(e,t,{checkForDefaultPrevented:s=!0}={}){return function(r){if(e?.(r),!1===s||!r.defaultPrevented)return t?.(r)}}function Gs(e,t=[]){let r=[];const a=()=>{const t=r.map(e=>s.createContext(e));return function(r){const a=r?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...r,[e]:a}}),[r,a])}};return a.scopeName=e,[function(t,a){const n=s.createContext(a),i=r.length;r=[...r,a];const l=t=>{const{scope:r,children:a,...l}=t,o=r?.[e]?.[i]||n,d=s.useMemo(()=>l,Object.values(l));return Qe.jsx(o.Provider,{value:d,children:a})};return l.displayName=t+"Provider",[l,function(r,l){const o=l?.[e]?.[i]||n,d=s.useContext(o);if(d)return d;if(void 0!==a)return a;throw new Error(`\`${r}\` must be used within \`${t}\``)}]},Zs(a,...t)]}function Zs(...e){const t=e[0];if(1===e.length)return t;const r=()=>{const r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const a=r.reduce((t,{useScope:s,scopeName:r})=>({...t,...s(e)[`__scope${r}`]}),{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function Qs(e){const t=e+"CollectionProvider",[s,a]=Gs(t),[n,i]=s(t,{collectionRef:{current:null},itemMap:new Map}),l=e=>{const{scope:t,children:s}=e,a=r.useRef(null),i=r.useRef(new Map).current;return Qe.jsx(n,{scope:t,itemMap:i,collectionRef:a,children:s})};l.displayName=t;const o=e+"CollectionSlot",d=Tt(o),c=r.forwardRef((e,t)=>{const{scope:s,children:r}=e,a=Rt(t,i(o,s).collectionRef);return Qe.jsx(d,{ref:a,children:r})});c.displayName=o;const m=e+"CollectionItemSlot",x="data-radix-collection-item",u=Tt(m),h=r.forwardRef((e,t)=>{const{scope:s,children:a,...n}=e,l=r.useRef(null),o=Rt(t,l),d=i(m,s);return r.useEffect(()=>(d.itemMap.set(l,{ref:l,...n}),()=>{d.itemMap.delete(l)})),Qe.jsx(u,{[x]:"",ref:o,children:a})});return h.displayName=m,[{Provider:l,Slot:c,ItemSlot:h},function(t){const s=i(e+"CollectionConsumer",t);return r.useCallback(()=>{const e=s.collectionRef.current;if(!e)return[];const t=Array.from(e.querySelectorAll(`[${x}]`));return Array.from(s.itemMap.values()).sort((e,s)=>t.indexOf(e.ref.current)-t.indexOf(s.ref.current))},[s.collectionRef,s.itemMap])},a]}var er=s.createContext(void 0);function tr(e){const t=s.useContext(er);return e||t||"ltr"}var sr=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{const r=Tt(`Primitive.${t}`),a=s.forwardRef((e,s)=>{const{asChild:a,...n}=e,i=a?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),Qe.jsx(i,{...n,ref:s})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{});function rr(e){const t=s.useRef(e);return s.useEffect(()=>{t.current=e}),s.useMemo(()=>(...e)=>t.current?.(...e),[])}var ar,nr="dismissableLayer.update",ir="dismissableLayer.pointerDownOutside",lr="dismissableLayer.focusOutside",or=s.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),dr=s.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:a,onPointerDownOutside:n,onFocusOutside:i,onInteractOutside:l,onDismiss:o,...d}=e,c=s.useContext(or),[m,x]=s.useState(null),u=m?.ownerDocument??globalThis?.document,[,h]=s.useState({}),p=Rt(t,e=>x(e)),g=Array.from(c.layers),[f]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=g.indexOf(f),y=m?g.indexOf(m):-1,j=c.layersWithOutsidePointerEventsDisabled.size>0,v=y>=b,w=function(e,t=globalThis?.document){const r=rr(e),a=s.useRef(!1),n=s.useRef(()=>{});return s.useEffect(()=>{const e=e=>{if(e.target&&!a.current){let s=function(){mr(ir,r,a,{discrete:!0})};const a={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",n.current),n.current=s,t.addEventListener("click",n.current,{once:!0})):s()}else t.removeEventListener("click",n.current);a.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",e),t.removeEventListener("click",n.current)}},[t,r]),{onPointerDownCapture:()=>a.current=!0}}(e=>{const t=e.target,s=[...c.branches].some(e=>e.contains(t));v&&!s&&(n?.(e),l?.(e),e.defaultPrevented||o?.())},u),N=function(e,t=globalThis?.document){const r=rr(e),a=s.useRef(!1);return s.useEffect(()=>{const e=e=>{if(e.target&&!a.current){mr(lr,r,{originalEvent:e},{discrete:!1})}};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,r]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}(e=>{const t=e.target;[...c.branches].some(e=>e.contains(t))||(i?.(e),l?.(e),e.defaultPrevented||o?.())},u);return function(e,t=globalThis?.document){const r=rr(e);s.useEffect(()=>{const e=e=>{"Escape"===e.key&&r(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})},[r,t])}(e=>{y===c.layers.size-1&&(a?.(e),!e.defaultPrevented&&o&&(e.preventDefault(),o()))},u),s.useEffect(()=>{if(m)return r&&(0===c.layersWithOutsidePointerEventsDisabled.size&&(ar=u.body.style.pointerEvents,u.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(m)),c.layers.add(m),cr(),()=>{r&&1===c.layersWithOutsidePointerEventsDisabled.size&&(u.body.style.pointerEvents=ar)}},[m,u,r,c]),s.useEffect(()=>()=>{m&&(c.layers.delete(m),c.layersWithOutsidePointerEventsDisabled.delete(m),cr())},[m,c]),s.useEffect(()=>{const e=()=>h({});return document.addEventListener(nr,e),()=>document.removeEventListener(nr,e)},[]),Qe.jsx(sr.div,{...d,ref:p,style:{pointerEvents:j?v?"auto":"none":void 0,...e.style},onFocusCapture:Js(e.onFocusCapture,N.onFocusCapture),onBlurCapture:Js(e.onBlurCapture,N.onBlurCapture),onPointerDownCapture:Js(e.onPointerDownCapture,w.onPointerDownCapture)})});dr.displayName="DismissableLayer";function cr(){const e=new CustomEvent(nr);document.dispatchEvent(e)}function mr(e,t,s,{discrete:r}){const a=s.originalEvent.target,n=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});t&&a.addEventListener(e,t,{once:!0}),r?function(e,t){e&&o.flushSync(()=>e.dispatchEvent(t))}(a,n):a.dispatchEvent(n)}s.forwardRef((e,t)=>{const r=s.useContext(or),a=s.useRef(null),n=Rt(t,a);return s.useEffect(()=>{const e=a.current;if(e)return r.branches.add(e),()=>{r.branches.delete(e)}},[r.branches]),Qe.jsx(sr.div,{...e,ref:n})}).displayName="DismissableLayerBranch";var xr=0;function ur(){s.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??hr()),document.body.insertAdjacentElement("beforeend",e[1]??hr()),xr++,()=>{1===xr&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),xr--}},[])}function hr(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var pr="focusScope.autoFocusOnMount",gr="focusScope.autoFocusOnUnmount",fr={bubbles:!1,cancelable:!0},br=s.forwardRef((e,t)=>{const{loop:r=!1,trapped:a=!1,onMountAutoFocus:n,onUnmountAutoFocus:i,...l}=e,[o,d]=s.useState(null),c=rr(n),m=rr(i),x=s.useRef(null),u=Rt(t,e=>d(e)),h=s.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;s.useEffect(()=>{if(a){let e=function(e){if(h.paused||!o)return;const t=e.target;o.contains(t)?x.current=t:wr(x.current,{select:!0})},t=function(e){if(h.paused||!o)return;const t=e.relatedTarget;null!==t&&(o.contains(t)||wr(x.current,{select:!0}))},s=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&wr(o)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const r=new MutationObserver(s);return o&&r.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}},[a,o,h.paused]),s.useEffect(()=>{if(o){Nr.add(h);const t=document.activeElement;if(!o.contains(t)){const s=new CustomEvent(pr,fr);o.addEventListener(pr,c),o.dispatchEvent(s),s.defaultPrevented||(!function(e,{select:t=!1}={}){const s=document.activeElement;for(const r of e)if(wr(r,{select:t}),document.activeElement!==s)return}((e=yr(o),e.filter(e=>"A"!==e.tagName)),{select:!0}),document.activeElement===t&&wr(o))}return()=>{o.removeEventListener(pr,c),setTimeout(()=>{const e=new CustomEvent(gr,fr);o.addEventListener(gr,m),o.dispatchEvent(e),e.defaultPrevented||wr(t??document.body,{select:!0}),o.removeEventListener(gr,m),Nr.remove(h)},0)}}var e},[o,c,m,h]);const p=s.useCallback(e=>{if(!r&&!a)return;if(h.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,s=document.activeElement;if(t&&s){const t=e.currentTarget,[a,n]=function(e){const t=yr(e),s=jr(t,e),r=jr(t.reverse(),e);return[s,r]}(t);a&&n?e.shiftKey||s!==n?e.shiftKey&&s===a&&(e.preventDefault(),r&&wr(n,{select:!0})):(e.preventDefault(),r&&wr(a,{select:!0})):s===t&&e.preventDefault()}},[r,a,h.paused]);return Qe.jsx(sr.div,{tabIndex:-1,...l,ref:u,onKeyDown:p})});function yr(e){const t=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)t.push(s.currentNode);return t}function jr(e,t){for(const s of e)if(!vr(s,{upTo:t}))return s}function vr(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function wr(e,{select:t=!1}={}){if(e&&e.focus){const s=document.activeElement;e.focus({preventScroll:!0}),e!==s&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}br.displayName="FocusScope";var Nr=function(){let e=[];return{add(t){const s=e[0];t!==s&&s?.pause(),e=kr(e,t),e.unshift(t)},remove(t){e=kr(e,t),e[0]?.resume()}}}();function kr(e,t){const s=[...e],r=s.indexOf(t);return-1!==r&&s.splice(r,1),s}var Sr=globalThis?.document?s.useLayoutEffect:()=>{},Cr=d[" useId ".trim().toString()]||(()=>{}),_r=0;function zr(e){const[t,r]=s.useState(Cr());return Sr(()=>{r(e=>e??String(_r++))},[e]),e||(t?`radix-${t}`:"")}const Er=["top","right","bottom","left"],Rr=Math.min,Tr=Math.max,Dr=Math.round,Ir=Math.floor,Lr=e=>({x:e,y:e}),Pr={left:"right",right:"left",bottom:"top",top:"bottom"},Mr={start:"end",end:"start"};function Ar(e,t,s){return Tr(e,Rr(t,s))}function Or(e,t){return"function"==typeof e?e(t):e}function Wr(e){return e.split("-")[0]}function Br(e){return e.split("-")[1]}function Fr(e){return"x"===e?"y":"x"}function $r(e){return"y"===e?"height":"width"}const Ur=new Set(["top","bottom"]);function qr(e){return Ur.has(Wr(e))?"y":"x"}function Hr(e){return Fr(qr(e))}function Vr(e){return e.replace(/start|end/g,e=>Mr[e])}const Yr=["left","right"],Xr=["right","left"],Kr=["top","bottom"],Jr=["bottom","top"];function Gr(e,t,s,r){const a=Br(e);let n=function(e,t,s){switch(e){case"top":case"bottom":return s?t?Xr:Yr:t?Yr:Xr;case"left":case"right":return t?Kr:Jr;default:return[]}}(Wr(e),"start"===s,r);return a&&(n=n.map(e=>e+"-"+a),t&&(n=n.concat(n.map(Vr)))),n}function Zr(e){return e.replace(/left|right|bottom|top/g,e=>Pr[e])}function Qr(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function ea(e){const{x:t,y:s,width:r,height:a}=e;return{width:r,height:a,top:s,left:t,right:t+r,bottom:s+a,x:t,y:s}}function ta(e,t,s){let{reference:r,floating:a}=e;const n=qr(t),i=Hr(t),l=$r(i),o=Wr(t),d="y"===n,c=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,x=r[l]/2-a[l]/2;let u;switch(o){case"top":u={x:c,y:r.y-a.height};break;case"bottom":u={x:c,y:r.y+r.height};break;case"right":u={x:r.x+r.width,y:m};break;case"left":u={x:r.x-a.width,y:m};break;default:u={x:r.x,y:r.y}}switch(Br(t)){case"start":u[i]-=x*(s&&d?-1:1);break;case"end":u[i]+=x*(s&&d?-1:1)}return u}async function sa(e,t){var s;void 0===t&&(t={});const{x:r,y:a,platform:n,rects:i,elements:l,strategy:o}=e,{boundary:d="clippingAncestors",rootBoundary:c="viewport",elementContext:m="floating",altBoundary:x=!1,padding:u=0}=Or(t,e),h=Qr(u),p=l[x?"floating"===m?"reference":"floating":m],g=ea(await n.getClippingRect({element:null==(s=await(null==n.isElement?void 0:n.isElement(p)))||s?p:p.contextElement||await(null==n.getDocumentElement?void 0:n.getDocumentElement(l.floating)),boundary:d,rootBoundary:c,strategy:o})),f="floating"===m?{x:r,y:a,width:i.floating.width,height:i.floating.height}:i.reference,b=await(null==n.getOffsetParent?void 0:n.getOffsetParent(l.floating)),y=await(null==n.isElement?void 0:n.isElement(b))&&await(null==n.getScale?void 0:n.getScale(b))||{x:1,y:1},j=ea(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:f,offsetParent:b,strategy:o}):f);return{top:(g.top-j.top+h.top)/y.y,bottom:(j.bottom-g.bottom+h.bottom)/y.y,left:(g.left-j.left+h.left)/y.x,right:(j.right-g.right+h.right)/y.x}}function ra(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function aa(e){return Er.some(t=>e[t]>=0)}const na=new Set(["left","top"]);function ia(){return"undefined"!=typeof window}function la(e){return ca(e)?(e.nodeName||"").toLowerCase():"#document"}function oa(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function da(e){var t;return null==(t=(ca(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function ca(e){return!!ia()&&(e instanceof Node||e instanceof oa(e).Node)}function ma(e){return!!ia()&&(e instanceof Element||e instanceof oa(e).Element)}function xa(e){return!!ia()&&(e instanceof HTMLElement||e instanceof oa(e).HTMLElement)}function ua(e){return!(!ia()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof oa(e).ShadowRoot)}const ha=new Set(["inline","contents"]);function pa(e){const{overflow:t,overflowX:s,overflowY:r,display:a}=_a(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+s)&&!ha.has(a)}const ga=new Set(["table","td","th"]);function fa(e){return ga.has(la(e))}const ba=[":popover-open",":modal"];function ya(e){return ba.some(t=>{try{return e.matches(t)}catch(s){return!1}})}const ja=["transform","translate","scale","rotate","perspective"],va=["transform","translate","scale","rotate","perspective","filter"],wa=["paint","layout","strict","content"];function Na(e){const t=ka(),s=ma(e)?_a(e):e;return ja.some(e=>!!s[e]&&"none"!==s[e])||!!s.containerType&&"normal"!==s.containerType||!t&&!!s.backdropFilter&&"none"!==s.backdropFilter||!t&&!!s.filter&&"none"!==s.filter||va.some(e=>(s.willChange||"").includes(e))||wa.some(e=>(s.contain||"").includes(e))}function ka(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const Sa=new Set(["html","body","#document"]);function Ca(e){return Sa.has(la(e))}function _a(e){return oa(e).getComputedStyle(e)}function za(e){return ma(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ea(e){if("html"===la(e))return e;const t=e.assignedSlot||e.parentNode||ua(e)&&e.host||da(e);return ua(t)?t.host:t}function Ra(e){const t=Ea(e);return Ca(t)?e.ownerDocument?e.ownerDocument.body:e.body:xa(t)&&pa(t)?t:Ra(t)}function Ta(e,t,s){var r;void 0===t&&(t=[]),void 0===s&&(s=!0);const a=Ra(e),n=a===(null==(r=e.ownerDocument)?void 0:r.body),i=oa(a);if(n){const e=Da(i);return t.concat(i,i.visualViewport||[],pa(a)?a:[],e&&s?Ta(e):[])}return t.concat(a,Ta(a,[],s))}function Da(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Ia(e){const t=_a(e);let s=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=xa(e),n=a?e.offsetWidth:s,i=a?e.offsetHeight:r,l=Dr(s)!==n||Dr(r)!==i;return l&&(s=n,r=i),{width:s,height:r,$:l}}function La(e){return ma(e)?e:e.contextElement}function Pa(e){const t=La(e);if(!xa(t))return Lr(1);const s=t.getBoundingClientRect(),{width:r,height:a,$:n}=Ia(t);let i=(n?Dr(s.width):s.width)/r,l=(n?Dr(s.height):s.height)/a;return i&&Number.isFinite(i)||(i=1),l&&Number.isFinite(l)||(l=1),{x:i,y:l}}const Ma=Lr(0);function Aa(e){const t=oa(e);return ka()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Ma}function Oa(e,t,s,r){void 0===t&&(t=!1),void 0===s&&(s=!1);const a=e.getBoundingClientRect(),n=La(e);let i=Lr(1);t&&(r?ma(r)&&(i=Pa(r)):i=Pa(e));const l=function(e,t,s){return void 0===t&&(t=!1),!(!s||t&&s!==oa(e))&&t}(n,s,r)?Aa(n):Lr(0);let o=(a.left+l.x)/i.x,d=(a.top+l.y)/i.y,c=a.width/i.x,m=a.height/i.y;if(n){const e=oa(n),t=r&&ma(r)?oa(r):r;let s=e,a=Da(s);for(;a&&r&&t!==s;){const e=Pa(a),t=a.getBoundingClientRect(),r=_a(a),n=t.left+(a.clientLeft+parseFloat(r.paddingLeft))*e.x,i=t.top+(a.clientTop+parseFloat(r.paddingTop))*e.y;o*=e.x,d*=e.y,c*=e.x,m*=e.y,o+=n,d+=i,s=oa(a),a=Da(s)}}return ea({width:c,height:m,x:o,y:d})}function Wa(e,t){const s=za(e).scrollLeft;return t?t.left+s:Oa(da(e)).left+s}function Ba(e,t){const s=e.getBoundingClientRect();return{x:s.left+t.scrollLeft-Wa(e,s),y:s.top+t.scrollTop}}const Fa=new Set(["absolute","fixed"]);function $a(e,t,s){let r;if("viewport"===t)r=function(e,t){const s=oa(e),r=da(e),a=s.visualViewport;let n=r.clientWidth,i=r.clientHeight,l=0,o=0;if(a){n=a.width,i=a.height;const e=ka();(!e||e&&"fixed"===t)&&(l=a.offsetLeft,o=a.offsetTop)}const d=Wa(r);if(d<=0){const e=r.ownerDocument,t=e.body,s=getComputedStyle(t),a="CSS1Compat"===e.compatMode&&parseFloat(s.marginLeft)+parseFloat(s.marginRight)||0,i=Math.abs(r.clientWidth-t.clientWidth-a);i<=25&&(n-=i)}else d<=25&&(n+=d);return{width:n,height:i,x:l,y:o}}(e,s);else if("document"===t)r=function(e){const t=da(e),s=za(e),r=e.ownerDocument.body,a=Tr(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),n=Tr(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let i=-s.scrollLeft+Wa(e);const l=-s.scrollTop;return"rtl"===_a(r).direction&&(i+=Tr(t.clientWidth,r.clientWidth)-a),{width:a,height:n,x:i,y:l}}(da(e));else if(ma(t))r=function(e,t){const s=Oa(e,!0,"fixed"===t),r=s.top+e.clientTop,a=s.left+e.clientLeft,n=xa(e)?Pa(e):Lr(1);return{width:e.clientWidth*n.x,height:e.clientHeight*n.y,x:a*n.x,y:r*n.y}}(t,s);else{const s=Aa(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return ea(r)}function Ua(e,t){const s=Ea(e);return!(s===t||!ma(s)||Ca(s))&&("fixed"===_a(s).position||Ua(s,t))}function qa(e,t,s){const r=xa(t),a=da(t),n="fixed"===s,i=Oa(e,!0,n,t);let l={scrollLeft:0,scrollTop:0};const o=Lr(0);function d(){o.x=Wa(a)}if(r||!r&&!n)if(("body"!==la(t)||pa(a))&&(l=za(t)),r){const e=Oa(t,!0,n,t);o.x=e.x+t.clientLeft,o.y=e.y+t.clientTop}else a&&d();n&&!r&&a&&d();const c=!a||r||n?Lr(0):Ba(a,l);return{x:i.left+l.scrollLeft-o.x-c.x,y:i.top+l.scrollTop-o.y-c.y,width:i.width,height:i.height}}function Ha(e){return"static"===_a(e).position}function Va(e,t){if(!xa(e)||"fixed"===_a(e).position)return null;if(t)return t(e);let s=e.offsetParent;return da(e)===s&&(s=s.ownerDocument.body),s}function Ya(e,t){const s=oa(e);if(ya(e))return s;if(!xa(e)){let t=Ea(e);for(;t&&!Ca(t);){if(ma(t)&&!Ha(t))return t;t=Ea(t)}return s}let r=Va(e,t);for(;r&&fa(r)&&Ha(r);)r=Va(r,t);return r&&Ca(r)&&Ha(r)&&!Na(r)?s:r||function(e){let t=Ea(e);for(;xa(t)&&!Ca(t);){if(Na(t))return t;if(ya(t))return null;t=Ea(t)}return null}(e)||s}const Xa={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:s,offsetParent:r,strategy:a}=e;const n="fixed"===a,i=da(r),l=!!t&&ya(t.floating);if(r===i||l&&n)return s;let o={scrollLeft:0,scrollTop:0},d=Lr(1);const c=Lr(0),m=xa(r);if((m||!m&&!n)&&(("body"!==la(r)||pa(i))&&(o=za(r)),xa(r))){const e=Oa(r);d=Pa(r),c.x=e.x+r.clientLeft,c.y=e.y+r.clientTop}const x=!i||m||n?Lr(0):Ba(i,o);return{width:s.width*d.x,height:s.height*d.y,x:s.x*d.x-o.scrollLeft*d.x+c.x+x.x,y:s.y*d.y-o.scrollTop*d.y+c.y+x.y}},getDocumentElement:da,getClippingRect:function(e){let{element:t,boundary:s,rootBoundary:r,strategy:a}=e;const n=[..."clippingAncestors"===s?ya(t)?[]:function(e,t){const s=t.get(e);if(s)return s;let r=Ta(e,[],!1).filter(e=>ma(e)&&"body"!==la(e)),a=null;const n="fixed"===_a(e).position;let i=n?Ea(e):e;for(;ma(i)&&!Ca(i);){const t=_a(i),s=Na(i);s||"fixed"!==t.position||(a=null),(n?!s&&!a:!s&&"static"===t.position&&a&&Fa.has(a.position)||pa(i)&&!s&&Ua(e,i))?r=r.filter(e=>e!==i):a=t,i=Ea(i)}return t.set(e,r),r}(t,this._c):[].concat(s),r],i=n[0],l=n.reduce((e,s)=>{const r=$a(t,s,a);return e.top=Tr(r.top,e.top),e.right=Rr(r.right,e.right),e.bottom=Rr(r.bottom,e.bottom),e.left=Tr(r.left,e.left),e},$a(t,i,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:Ya,getElementRects:async function(e){const t=this.getOffsetParent||Ya,s=this.getDimensions,r=await s(e.floating);return{reference:qa(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:s}=Ia(e);return{width:t,height:s}},getScale:Pa,isElement:ma,isRTL:function(e){return"rtl"===_a(e).direction}};function Ka(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Ja(e,t,s,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:n=!0,elementResize:i="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:o=!1}=r,d=La(e),c=a||n?[...d?Ta(d):[],...Ta(t)]:[];c.forEach(e=>{a&&e.addEventListener("scroll",s,{passive:!0}),n&&e.addEventListener("resize",s)});const m=d&&l?function(e,t){let s,r=null;const a=da(e);function n(){var e;clearTimeout(s),null==(e=r)||e.disconnect(),r=null}return function i(l,o){void 0===l&&(l=!1),void 0===o&&(o=1),n();const d=e.getBoundingClientRect(),{left:c,top:m,width:x,height:u}=d;if(l||t(),!x||!u)return;const h={rootMargin:-Ir(m)+"px "+-Ir(a.clientWidth-(c+x))+"px "+-Ir(a.clientHeight-(m+u))+"px "+-Ir(c)+"px",threshold:Tr(0,Rr(1,o))||1};let p=!0;function g(t){const r=t[0].intersectionRatio;if(r!==o){if(!p)return i();r?i(!1,r):s=setTimeout(()=>{i(!1,1e-7)},1e3)}1!==r||Ka(d,e.getBoundingClientRect())||i(),p=!1}try{r=new IntersectionObserver(g,{...h,root:a.ownerDocument})}catch(f){r=new IntersectionObserver(g,h)}r.observe(e)}(!0),n}(d,s):null;let x,u=-1,h=null;i&&(h=new ResizeObserver(e=>{let[r]=e;r&&r.target===d&&h&&(h.unobserve(t),cancelAnimationFrame(u),u=requestAnimationFrame(()=>{var e;null==(e=h)||e.observe(t)})),s()}),d&&!o&&h.observe(d),h.observe(t));let p=o?Oa(e):null;return o&&function t(){const r=Oa(e);p&&!Ka(p,r)&&s();p=r,x=requestAnimationFrame(t)}(),s(),()=>{var e;c.forEach(e=>{a&&e.removeEventListener("scroll",s),n&&e.removeEventListener("resize",s)}),null==m||m(),null==(e=h)||e.disconnect(),h=null,o&&cancelAnimationFrame(x)}}const Ga=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var s,r;const{x:a,y:n,placement:i,middlewareData:l}=t,o=await async function(e,t){const{placement:s,platform:r,elements:a}=e,n=await(null==r.isRTL?void 0:r.isRTL(a.floating)),i=Wr(s),l=Br(s),o="y"===qr(s),d=na.has(i)?-1:1,c=n&&o?-1:1,m=Or(t,e);let{mainAxis:x,crossAxis:u,alignmentAxis:h}="number"==typeof m?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&"number"==typeof h&&(u="end"===l?-1*h:h),o?{x:u*c,y:x*d}:{x:x*d,y:u*c}}(t,e);return i===(null==(s=l.offset)?void 0:s.placement)&&null!=(r=l.arrow)&&r.alignmentOffset?{}:{x:a+o.x,y:n+o.y,data:{...o,placement:i}}}}},Za=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:s,y:r,placement:a}=t,{mainAxis:n=!0,crossAxis:i=!1,limiter:l={fn:e=>{let{x:t,y:s}=e;return{x:t,y:s}}},...o}=Or(e,t),d={x:s,y:r},c=await sa(t,o),m=qr(Wr(a)),x=Fr(m);let u=d[x],h=d[m];if(n){const e="y"===x?"bottom":"right";u=Ar(u+c["y"===x?"top":"left"],u,u-c[e])}if(i){const e="y"===m?"bottom":"right";h=Ar(h+c["y"===m?"top":"left"],h,h-c[e])}const p=l.fn({...t,[x]:u,[m]:h});return{...p,data:{x:p.x-s,y:p.y-r,enabled:{[x]:n,[m]:i}}}}}},Qa=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var s,r;const{placement:a,middlewareData:n,rects:i,initialPlacement:l,platform:o,elements:d}=t,{mainAxis:c=!0,crossAxis:m=!0,fallbackPlacements:x,fallbackStrategy:u="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:p=!0,...g}=Or(e,t);if(null!=(s=n.arrow)&&s.alignmentOffset)return{};const f=Wr(a),b=qr(l),y=Wr(l)===l,j=await(null==o.isRTL?void 0:o.isRTL(d.floating)),v=x||(y||!p?[Zr(l)]:function(e){const t=Zr(e);return[Vr(e),t,Vr(t)]}(l)),w="none"!==h;!x&&w&&v.push(...Gr(l,p,h,j));const N=[l,...v],k=await sa(t,g),S=[];let C=(null==(r=n.flip)?void 0:r.overflows)||[];if(c&&S.push(k[f]),m){const e=function(e,t,s){void 0===s&&(s=!1);const r=Br(e),a=Hr(e),n=$r(a);let i="x"===a?r===(s?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[n]>t.floating[n]&&(i=Zr(i)),[i,Zr(i)]}(a,i,j);S.push(k[e[0]],k[e[1]])}if(C=[...C,{placement:a,overflows:S}],!S.every(e=>e<=0)){var _,z;const e=((null==(_=n.flip)?void 0:_.index)||0)+1,t=N[e];if(t){if(!("alignment"===m&&b!==qr(t))||C.every(e=>qr(e.placement)!==b||e.overflows[0]>0))return{data:{index:e,overflows:C},reset:{placement:t}}}let s=null==(z=C.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:z.placement;if(!s)switch(u){case"bestFit":{var E;const e=null==(E=C.filter(e=>{if(w){const t=qr(e.placement);return t===b||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:E[0];e&&(s=e);break}case"initialPlacement":s=l}if(a!==s)return{reset:{placement:s}}}return{}}}},en=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var s,r;const{placement:a,rects:n,platform:i,elements:l}=t,{apply:o=()=>{},...d}=Or(e,t),c=await sa(t,d),m=Wr(a),x=Br(a),u="y"===qr(a),{width:h,height:p}=n.floating;let g,f;"top"===m||"bottom"===m?(g=m,f=x===(await(null==i.isRTL?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(f=m,g="end"===x?"top":"bottom");const b=p-c.top-c.bottom,y=h-c.left-c.right,j=Rr(p-c[g],b),v=Rr(h-c[f],y),w=!t.middlewareData.shift;let N=j,k=v;if(null!=(s=t.middlewareData.shift)&&s.enabled.x&&(k=y),null!=(r=t.middlewareData.shift)&&r.enabled.y&&(N=b),w&&!x){const e=Tr(c.left,0),t=Tr(c.right,0),s=Tr(c.top,0),r=Tr(c.bottom,0);u?k=h-2*(0!==e||0!==t?e+t:Tr(c.left,c.right)):N=p-2*(0!==s||0!==r?s+r:Tr(c.top,c.bottom))}await o({...t,availableWidth:k,availableHeight:N});const S=await i.getDimensions(l.floating);return h!==S.width||p!==S.height?{reset:{rects:!0}}:{}}}},tn=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:s}=t,{strategy:r="referenceHidden",...a}=Or(e,t);switch(r){case"referenceHidden":{const e=ra(await sa(t,{...a,elementContext:"reference"}),s.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:aa(e)}}}case"escaped":{const e=ra(await sa(t,{...a,altBoundary:!0}),s.floating);return{data:{escapedOffsets:e,escaped:aa(e)}}}default:return{}}}}},sn=e=>({name:"arrow",options:e,async fn(t){const{x:s,y:r,placement:a,rects:n,platform:i,elements:l,middlewareData:o}=t,{element:d,padding:c=0}=Or(e,t)||{};if(null==d)return{};const m=Qr(c),x={x:s,y:r},u=Hr(a),h=$r(u),p=await i.getDimensions(d),g="y"===u,f=g?"top":"left",b=g?"bottom":"right",y=g?"clientHeight":"clientWidth",j=n.reference[h]+n.reference[u]-x[u]-n.floating[h],v=x[u]-n.reference[u],w=await(null==i.getOffsetParent?void 0:i.getOffsetParent(d));let N=w?w[y]:0;N&&await(null==i.isElement?void 0:i.isElement(w))||(N=l.floating[y]||n.floating[h]);const k=j/2-v/2,S=N/2-p[h]/2-1,C=Rr(m[f],S),_=Rr(m[b],S),z=C,E=N-p[h]-_,R=N/2-p[h]/2+k,T=Ar(z,R,E),D=!o.arrow&&null!=Br(a)&&R!==T&&n.reference[h]/2-(R<z?C:_)-p[h]/2<0,I=D?R<z?R-z:R-E:0;return{[u]:x[u]+I,data:{[u]:T,centerOffset:R-T-I,...D&&{alignmentOffset:I}},reset:D}}}),rn=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:s,y:r,placement:a,rects:n,middlewareData:i}=t,{offset:l=0,mainAxis:o=!0,crossAxis:d=!0}=Or(e,t),c={x:s,y:r},m=qr(a),x=Fr(m);let u=c[x],h=c[m];const p=Or(l,t),g="number"==typeof p?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(o){const e="y"===x?"height":"width",t=n.reference[x]-n.floating[e]+g.mainAxis,s=n.reference[x]+n.reference[e]-g.mainAxis;u<t?u=t:u>s&&(u=s)}if(d){var f,b;const e="y"===x?"width":"height",t=na.has(Wr(a)),s=n.reference[m]-n.floating[e]+(t&&(null==(f=i.offset)?void 0:f[m])||0)+(t?0:g.crossAxis),r=n.reference[m]+n.reference[e]+(t?0:(null==(b=i.offset)?void 0:b[m])||0)-(t?g.crossAxis:0);h<s?h=s:h>r&&(h=r)}return{[x]:u,[m]:h}}}},an=(e,t,s)=>{const r=new Map,a={platform:Xa,...s},n={...a.platform,_c:r};return(async(e,t,s)=>{const{placement:r="bottom",strategy:a="absolute",middleware:n=[],platform:i}=s,l=n.filter(Boolean),o=await(null==i.isRTL?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:m}=ta(d,r,o),x=r,u={},h=0;for(let p=0;p<l.length;p++){const{name:s,fn:n}=l[p],{x:g,y:f,data:b,reset:y}=await n({x:c,y:m,initialPlacement:r,placement:x,strategy:a,middlewareData:u,rects:d,platform:i,elements:{reference:e,floating:t}});c=null!=g?g:c,m=null!=f?f:m,u={...u,[s]:{...u[s],...b}},y&&h<=50&&(h++,"object"==typeof y&&(y.placement&&(x=y.placement),y.rects&&(d=!0===y.rects?await i.getElementRects({reference:e,floating:t,strategy:a}):y.rects),({x:c,y:m}=ta(d,x,o))),p=-1)}return{x:c,y:m,placement:x,strategy:a,middlewareData:u}})(e,t,{...a,platform:n})};var nn="undefined"!=typeof document?s.useLayoutEffect:function(){};function ln(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let s,r,a;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(s=e.length,s!==t.length)return!1;for(r=s;0!==r--;)if(!ln(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),s=a.length,s!==Object.keys(t).length)return!1;for(r=s;0!==r--;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=s;0!==r--;){const s=a[r];if(("_owner"!==s||!e.$$typeof)&&!ln(e[s],t[s]))return!1}return!0}return e!=e&&t!=t}function on(e){if("undefined"==typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function dn(e,t){const s=on(e);return Math.round(t*s)/s}function cn(e){const t=s.useRef(e);return nn(()=>{t.current=e}),t}const mn=e=>({name:"arrow",options:e,fn(t){const{element:s,padding:r}="function"==typeof e?e(t):e;return s&&(a=s,{}.hasOwnProperty.call(a,"current"))?null!=s.current?sn({element:s.current,padding:r}).fn(t):{}:s?sn({element:s,padding:r}).fn(t):{};var a}}),xn=(e,t)=>({...Ga(e),options:[e,t]}),un=(e,t)=>({...Za(e),options:[e,t]}),hn=(e,t)=>({...rn(e),options:[e,t]}),pn=(e,t)=>({...Qa(e),options:[e,t]}),gn=(e,t)=>({...en(e),options:[e,t]}),fn=(e,t)=>({...tn(e),options:[e,t]}),bn=(e,t)=>({...mn(e),options:[e,t]});var yn=s.forwardRef((e,t)=>{const{children:s,width:r=10,height:a=5,...n}=e;return Qe.jsx(sr.svg,{...n,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?s:Qe.jsx("polygon",{points:"0,0 30,0 15,10"})})});yn.displayName="Arrow";var jn=yn;function vn(e){const[t,r]=s.useState(void 0);return Sr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const t=new ResizeObserver(t=>{if(!Array.isArray(t))return;if(!t.length)return;const s=t[0];let a,n;if("borderBoxSize"in s){const e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,n=t.blockSize}else a=e.offsetWidth,n=e.offsetHeight;r({width:a,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}var wn="Popper",[Nn,kn]=Gs(wn),[Sn,Cn]=Nn(wn),_n=e=>{const{__scopePopper:t,children:r}=e,[a,n]=s.useState(null);return Qe.jsx(Sn,{scope:t,anchor:a,onAnchorChange:n,children:r})};_n.displayName=wn;var zn="PopperAnchor",En=s.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:a,...n}=e,i=Cn(zn,r),l=s.useRef(null),o=Rt(t,l),d=s.useRef(null);return s.useEffect(()=>{const e=d.current;d.current=a?.current||l.current,e!==d.current&&i.onAnchorChange(d.current)}),a?null:Qe.jsx(sr.div,{...n,ref:o})});En.displayName=zn;var Rn="PopperContent",[Tn,Dn]=Nn(Rn),In=s.forwardRef((e,t)=>{const{__scopePopper:r,side:a="bottom",sideOffset:n=0,align:i="center",alignOffset:l=0,arrowPadding:d=0,avoidCollisions:c=!0,collisionBoundary:m=[],collisionPadding:x=0,sticky:u="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...f}=e,b=Cn(Rn,r),[y,j]=s.useState(null),v=Rt(t,e=>j(e)),[w,N]=s.useState(null),k=vn(w),S=k?.width??0,C=k?.height??0,_=a+("center"!==i?"-"+i:""),z="number"==typeof x?x:{top:0,right:0,bottom:0,left:0,...x},E=Array.isArray(m)?m:[m],R=E.length>0,T={padding:z,boundary:E.filter(An),altBoundary:R},{refs:D,floatingStyles:I,placement:L,isPositioned:P,middlewareData:M}=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:a=[],platform:n,elements:{reference:i,floating:l}={},transform:d=!0,whileElementsMounted:c,open:m}=e,[x,u]=s.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=s.useState(a);ln(h,a)||p(a);const[g,f]=s.useState(null),[b,y]=s.useState(null),j=s.useCallback(e=>{e!==k.current&&(k.current=e,f(e))},[]),v=s.useCallback(e=>{e!==S.current&&(S.current=e,y(e))},[]),w=i||g,N=l||b,k=s.useRef(null),S=s.useRef(null),C=s.useRef(x),_=null!=c,z=cn(c),E=cn(n),R=cn(m),T=s.useCallback(()=>{if(!k.current||!S.current)return;const e={placement:t,strategy:r,middleware:h};E.current&&(e.platform=E.current),an(k.current,S.current,e).then(e=>{const t={...e,isPositioned:!1!==R.current};D.current&&!ln(C.current,t)&&(C.current=t,o.flushSync(()=>{u(t)}))})},[h,t,r,E,R]);nn(()=>{!1===m&&C.current.isPositioned&&(C.current.isPositioned=!1,u(e=>({...e,isPositioned:!1})))},[m]);const D=s.useRef(!1);nn(()=>(D.current=!0,()=>{D.current=!1}),[]),nn(()=>{if(w&&(k.current=w),N&&(S.current=N),w&&N){if(z.current)return z.current(w,N,T);T()}},[w,N,T,z,_]);const I=s.useMemo(()=>({reference:k,floating:S,setReference:j,setFloating:v}),[j,v]),L=s.useMemo(()=>({reference:w,floating:N}),[w,N]),P=s.useMemo(()=>{const e={position:r,left:0,top:0};if(!L.floating)return e;const t=dn(L.floating,x.x),s=dn(L.floating,x.y);return d?{...e,transform:"translate("+t+"px, "+s+"px)",...on(L.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:s}},[r,d,L.floating,x.x,x.y]);return s.useMemo(()=>({...x,update:T,refs:I,elements:L,floatingStyles:P}),[x,T,I,L,P])}({strategy:"fixed",placement:_,whileElementsMounted:(...e)=>Ja(...e,{animationFrame:"always"===p}),elements:{reference:b.anchor},middleware:[xn({mainAxis:n+C,alignmentAxis:l}),c&&un({mainAxis:!0,crossAxis:!1,limiter:"partial"===u?hn():void 0,...T}),c&&pn({...T}),gn({...T,apply:({elements:e,rects:t,availableWidth:s,availableHeight:r})=>{const{width:a,height:n}=t.reference,i=e.floating.style;i.setProperty("--radix-popper-available-width",`${s}px`),i.setProperty("--radix-popper-available-height",`${r}px`),i.setProperty("--radix-popper-anchor-width",`${a}px`),i.setProperty("--radix-popper-anchor-height",`${n}px`)}}),w&&bn({element:w,padding:d}),On({arrowWidth:S,arrowHeight:C}),h&&fn({strategy:"referenceHidden",...T})]}),[A,O]=Wn(L),W=rr(g);Sr(()=>{P&&W?.()},[P,W]);const B=M.arrow?.x,F=M.arrow?.y,$=0!==M.arrow?.centerOffset,[U,q]=s.useState();return Sr(()=>{y&&q(window.getComputedStyle(y).zIndex)},[y]),Qe.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:P?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:U,"--radix-popper-transform-origin":[M.transformOrigin?.x,M.transformOrigin?.y].join(" "),...M.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:Qe.jsx(Tn,{scope:r,placedSide:A,onArrowChange:N,arrowX:B,arrowY:F,shouldHideArrow:$,children:Qe.jsx(sr.div,{"data-side":A,"data-align":O,...f,ref:v,style:{...f.style,animation:P?void 0:"none"}})})})});In.displayName=Rn;var Ln="PopperArrow",Pn={top:"bottom",right:"left",bottom:"top",left:"right"},Mn=s.forwardRef(function(e,t){const{__scopePopper:s,...r}=e,a=Dn(Ln,s),n=Pn[a.placedSide];return Qe.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[n]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:Qe.jsx(jn,{...r,ref:t,style:{...r.style,display:"block"}})})});function An(e){return null!==e}Mn.displayName=Ln;var On=e=>({name:"transformOrigin",options:e,fn(t){const{placement:s,rects:r,middlewareData:a}=t,n=0!==a.arrow?.centerOffset,i=n?0:e.arrowWidth,l=n?0:e.arrowHeight,[o,d]=Wn(s),c={start:"0%",center:"50%",end:"100%"}[d],m=(a.arrow?.x??0)+i/2,x=(a.arrow?.y??0)+l/2;let u="",h="";return"bottom"===o?(u=n?c:`${m}px`,h=-l+"px"):"top"===o?(u=n?c:`${m}px`,h=`${r.floating.height+l}px`):"right"===o?(u=-l+"px",h=n?c:`${x}px`):"left"===o&&(u=`${r.floating.width+l}px`,h=n?c:`${x}px`),{data:{x:u,y:h}}}});function Wn(e){const[t,s="center"]=e.split("-");return[t,s]}var Bn=_n,Fn=En,$n=In,Un=Mn,qn=s.forwardRef((e,t)=>{const{container:r,...n}=e,[i,l]=s.useState(!1);Sr(()=>l(!0),[]);const o=r||i&&globalThis?.document?.body;return o?a.createPortal(Qe.jsx(sr.div,{...n,ref:t}),o):null});qn.displayName="Portal";var Hn=d[" useInsertionEffect ".trim().toString()]||Sr;function Vn({prop:e,defaultProp:t,onChange:r=()=>{},caller:a}){const[n,i,l]=function({defaultProp:e,onChange:t}){const[r,a]=s.useState(e),n=s.useRef(r),i=s.useRef(t);return Hn(()=>{i.current=t},[t]),s.useEffect(()=>{n.current!==r&&(i.current?.(r),n.current=r)},[r,n]),[r,a,i]}({defaultProp:t,onChange:r}),o=void 0!==e,d=o?e:n;{const t=s.useRef(void 0!==e);s.useEffect(()=>{const e=t.current;if(e!==o){}t.current=o},[o,a])}const c=s.useCallback(t=>{if(o){const s=function(e){return"function"==typeof e}(t)?t(e):t;s!==e&&l.current?.(s)}else i(t)},[o,e,i,l]);return[d,c]}function Yn(e){const t=s.useRef({value:e,previous:e});return s.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Xn=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"});s.forwardRef((e,t)=>Qe.jsx(sr.span,{...e,ref:t,style:{...Xn,...e.style}})).displayName="VisuallyHidden";var Kn=new WeakMap,Jn=new WeakMap,Gn={},Zn=0,Qn=function(e){return e&&(e.host||Qn(e.parentNode))},ei=function(e,t,s,r){var a=function(e,t){return t.map(function(t){if(e.contains(t))return t;var s=Qn(t);return s&&e.contains(s)?s:null}).filter(function(e){return Boolean(e)})}(t,Array.isArray(e)?e:[e]);Gn[s]||(Gn[s]=new WeakMap);var n=Gn[s],i=[],l=new Set,o=new Set(a),d=function(e){e&&!l.has(e)&&(l.add(e),d(e.parentNode))};a.forEach(d);var c=function(e){e&&!o.has(e)&&Array.prototype.forEach.call(e.children,function(e){if(l.has(e))c(e);else try{var t=e.getAttribute(r),a=null!==t&&"false"!==t,o=(Kn.get(e)||0)+1,d=(n.get(e)||0)+1;Kn.set(e,o),n.set(e,d),i.push(e),1===o&&a&&Jn.set(e,!0),1===d&&e.setAttribute(s,"true"),a||e.setAttribute(r,"true")}catch(m){}})};return c(t),l.clear(),Zn++,function(){i.forEach(function(e){var t=Kn.get(e)-1,a=n.get(e)-1;Kn.set(e,t),n.set(e,a),t||(Jn.has(e)||e.removeAttribute(r),Jn.delete(e)),a||e.removeAttribute(s)}),--Zn||(Kn=new WeakMap,Kn=new WeakMap,Jn=new WeakMap,Gn={})}},ti=function(e,t,s){void 0===s&&(s="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=function(e){return"undefined"==typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body}(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),ei(r,a,s,"aria-hidden")):function(){return null}},si=function(){return si=Object.assign||function(e){for(var t,s=1,r=arguments.length;s<r;s++)for(var a in t=arguments[s])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},si.apply(this,arguments)};function ri(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}"function"==typeof SuppressedError&&SuppressedError;var ai="right-scroll-bar-position",ni="width-before-scroll-bar";function ii(e,t){return"function"==typeof e?e(t):e&&(e.current=t),e}var li="undefined"!=typeof window?s.useLayoutEffect:s.useEffect,oi=new WeakMap;function di(e,t){var r,a,n,i=(r=null,a=function(t){return e.forEach(function(e){return ii(e,t)})},(n=s.useState(function(){return{value:r,callback:a,facade:{get current(){return n.value},set current(e){var t=n.value;t!==e&&(n.value=e,n.callback(e,t))}}}})[0]).callback=a,n.facade);return li(function(){var t=oi.get(i);if(t){var s=new Set(t),r=new Set(e),a=i.current;s.forEach(function(e){r.has(e)||ii(e,null)}),r.forEach(function(e){s.has(e)||ii(e,a)})}oi.set(i,e)},[e]),i}function ci(e){return e}var mi=function(e){var t=e.sideCar,r=ri(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var a=t.read();if(!a)throw new Error("Sidecar medium not found");return s.createElement(a,si({},r))};mi.isSideCarExport=!0;var xi=function(e){void 0===e&&(e={});var t=function(e,t){void 0===t&&(t=ci);var s=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:e},useMedium:function(e){var a=t(e,r);return s.push(a),function(){s=s.filter(function(e){return e!==a})}},assignSyncMedium:function(e){for(r=!0;s.length;){var t=s;s=[],t.forEach(e)}s={push:function(t){return e(t)},filter:function(){return s}}},assignMedium:function(e){r=!0;var t=[];if(s.length){var a=s;s=[],a.forEach(e),t=s}var n=function(){var s=t;t=[],s.forEach(e)},i=function(){return Promise.resolve().then(n)};i(),s={push:function(e){t.push(e),i()},filter:function(e){return t=t.filter(e),s}}}};return a}(null);return t.options=si({async:!0,ssr:!1},e),t}(),ui=function(){},hi=s.forwardRef(function(e,t){var r=s.useRef(null),a=s.useState({onScrollCapture:ui,onWheelCapture:ui,onTouchMoveCapture:ui}),n=a[0],i=a[1],l=e.forwardProps,o=e.children,d=e.className,c=e.removeScrollBar,m=e.enabled,x=e.shards,u=e.sideCar,h=e.noRelative,p=e.noIsolation,g=e.inert,f=e.allowPinchZoom,b=e.as,y=void 0===b?"div":b,j=e.gapMode,v=ri(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=u,N=di([r,t]),k=si(si({},v),n);return s.createElement(s.Fragment,null,m&&s.createElement(w,{sideCar:xi,removeScrollBar:c,shards:x,noRelative:h,noIsolation:p,inert:g,setCallbacks:i,allowPinchZoom:!!f,lockRef:r,gapMode:j}),l?s.cloneElement(s.Children.only(o),si(si({},k),{ref:N})):s.createElement(y,si({},k,{className:d,ref:N}),o))});hi.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},hi.classNames={fullWidth:ni,zeroRight:ai};function pi(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=function(){if("undefined"!=typeof __webpack_nonce__)return __webpack_nonce__}();return t&&e.setAttribute("nonce",t),e}var gi=function(){var e=0,t=null;return{add:function(s){var r,a;0==e&&(t=pi())&&(a=s,(r=t).styleSheet?r.styleSheet.cssText=a:r.appendChild(document.createTextNode(a)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){! --e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},fi=function(){var e,t=(e=gi(),function(t,r){s.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])});return function(e){var s=e.styles,r=e.dynamic;return t(s,r),null}},bi={left:0,top:0,right:0,gap:0},yi=function(e){return parseInt(e||"",10)||0},ji=function(e){if(void 0===e&&(e="margin"),"undefined"==typeof window)return bi;var t=function(e){var t=window.getComputedStyle(document.body),s=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],a=t["padding"===e?"paddingRight":"marginRight"];return[yi(s),yi(r),yi(a)]}(e),s=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-s+t[2]-t[0])}},vi=fi(),wi="data-scroll-locked",Ni=function(e,t,s,r){var a=e.left,n=e.top,i=e.right,l=e.gap;return void 0===s&&(s="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(l,"px ").concat(r,";\n  }\n  body[").concat(wi,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===s&&"\n    padding-left: ".concat(a,"px;\n    padding-top: ").concat(n,"px;\n    padding-right: ").concat(i,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(l,"px ").concat(r,";\n    "),"padding"===s&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(ai," {\n    right: ").concat(l,"px ").concat(r,";\n  }\n  \n  .").concat(ni," {\n    margin-right: ").concat(l,"px ").concat(r,";\n  }\n  \n  .").concat(ai," .").concat(ai," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(ni," .").concat(ni," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(wi,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(l,"px;\n  }\n")},ki=function(){var e=parseInt(document.body.getAttribute(wi)||"0",10);return isFinite(e)?e:0},Si=function(e){var t=e.noRelative,r=e.noImportant,a=e.gapMode,n=void 0===a?"margin":a;s.useEffect(function(){return document.body.setAttribute(wi,(ki()+1).toString()),function(){var e=ki()-1;e<=0?document.body.removeAttribute(wi):document.body.setAttribute(wi,e.toString())}},[]);var i=s.useMemo(function(){return ji(n)},[n]);return s.createElement(vi,{styles:Ni(i,!t,n,r?"":"!important")})},Ci=!1;if("undefined"!=typeof window)try{var _i=Object.defineProperty({},"passive",{get:function(){return Ci=!0,!0}});window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch(jx){Ci=!1}var zi=!!Ci&&{passive:!1},Ei=function(e,t){if(!(e instanceof Element))return!1;var s=window.getComputedStyle(e);return"hidden"!==s[t]&&!(s.overflowY===s.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===s[t])},Ri=function(e,t){var s=t.ownerDocument,r=t;do{if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),Ti(e,r)){var a=Di(e,r);if(a[1]>a[2])return!0}r=r.parentNode}while(r&&r!==s.body);return!1},Ti=function(e,t){return"v"===e?function(e){return Ei(e,"overflowY")}(t):function(e){return Ei(e,"overflowX")}(t)},Di=function(e,t){return"v"===e?[(s=t).scrollTop,s.scrollHeight,s.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var s},Ii=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Li=function(e){return[e.deltaX,e.deltaY]},Pi=function(e){return e&&"current"in e?e.current:e},Mi=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},Ai=0,Oi=[];function Wi(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Bi=(Fi=function(e){var t=s.useRef([]),r=s.useRef([0,0]),a=s.useRef(),n=s.useState(Ai++)[0],i=s.useState(fi)[0],l=s.useRef(e);s.useEffect(function(){l.current=e},[e]),s.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(n));var t=function(e,t,s){if(s||2===arguments.length)for(var r,a=0,n=t.length;a<n;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}([e.lockRef.current],(e.shards||[]).map(Pi),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(n))}),function(){document.body.classList.remove("block-interactivity-".concat(n)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(n))})}}},[e.inert,e.lockRef.current,e.shards]);var o=s.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!l.current.allowPinchZoom;var s,n=Ii(e),i=r.current,o="deltaX"in e?e.deltaX:i[0]-n[0],d="deltaY"in e?e.deltaY:i[1]-n[1],c=e.target,m=Math.abs(o)>Math.abs(d)?"h":"v";if("touches"in e&&"h"===m&&"range"===c.type)return!1;var x=Ri(m,c);if(!x)return!0;if(x?s=m:(s="v"===m?"h":"v",x=Ri(m,c)),!x)return!1;if(!a.current&&"changedTouches"in e&&(o||d)&&(a.current=s),!s)return!0;var u=a.current||s;return function(e,t,s,r){var a=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),n=a*r,i=s.target,l=t.contains(i),o=!1,d=n>0,c=0,m=0;do{if(!i)break;var x=Di(e,i),u=x[0],h=x[1]-x[2]-a*u;(u||h)&&Ti(e,i)&&(c+=h,m+=u);var p=i.parentNode;i=p&&p.nodeType===Node.DOCUMENT_FRAGMENT_NODE?p.host:p}while(!l&&i!==document.body||l&&(t.contains(i)||t===i));return(d&&Math.abs(c)<1||!d&&Math.abs(m)<1)&&(o=!0),o}(u,t,e,"h"===u?o:d)},[]),d=s.useCallback(function(e){var s=e;if(Oi.length&&Oi[Oi.length-1]===i){var r="deltaY"in s?Li(s):Ii(s),a=t.current.filter(function(e){return e.name===s.type&&(e.target===s.target||s.target===e.shadowParent)&&function(e,t){return e[0]===t[0]&&e[1]===t[1]}(e.delta,r)})[0];if(a&&a.should)s.cancelable&&s.preventDefault();else if(!a){var n=(l.current.shards||[]).map(Pi).filter(Boolean).filter(function(e){return e.contains(s.target)});(n.length>0?o(s,n[0]):!l.current.noIsolation)&&s.cancelable&&s.preventDefault()}}},[]),c=s.useCallback(function(e,s,r,a){var n={name:e,delta:s,target:r,should:a,shadowParent:Wi(r)};t.current.push(n),setTimeout(function(){t.current=t.current.filter(function(e){return e!==n})},1)},[]),m=s.useCallback(function(e){r.current=Ii(e),a.current=void 0},[]),x=s.useCallback(function(t){c(t.type,Li(t),t.target,o(t,e.lockRef.current))},[]),u=s.useCallback(function(t){c(t.type,Ii(t),t.target,o(t,e.lockRef.current))},[]);s.useEffect(function(){return Oi.push(i),e.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:u}),document.addEventListener("wheel",d,zi),document.addEventListener("touchmove",d,zi),document.addEventListener("touchstart",m,zi),function(){Oi=Oi.filter(function(e){return e!==i}),document.removeEventListener("wheel",d,zi),document.removeEventListener("touchmove",d,zi),document.removeEventListener("touchstart",m,zi)}},[]);var h=e.removeScrollBar,p=e.inert;return s.createElement(s.Fragment,null,p?s.createElement(i,{styles:Mi(n)}):null,h?s.createElement(Si,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},xi.useMedium(Fi),mi);var Fi,$i=s.forwardRef(function(e,t){return s.createElement(hi,si({},e,{ref:t,sideCar:Bi}))});$i.classNames=hi.classNames;var Ui=[" ","Enter","ArrowUp","ArrowDown"],qi=[" ","Enter"],Hi="Select",[Vi,Yi,Xi]=Qs(Hi),[Ki]=Gs(Hi,[Xi,kn]),Ji=kn(),[Gi,Zi]=Ki(Hi),[Qi,el]=Ki(Hi),tl=e=>{const{__scopeSelect:t,children:r,open:a,defaultOpen:n,onOpenChange:i,value:l,defaultValue:o,onValueChange:d,dir:c,name:m,autoComplete:x,disabled:u,required:h,form:p}=e,g=Ji(t),[f,b]=s.useState(null),[y,j]=s.useState(null),[v,w]=s.useState(!1),N=tr(c),[k,S]=Vn({prop:a,defaultProp:n??!1,onChange:i,caller:Hi}),[C,_]=Vn({prop:l,defaultProp:o,onChange:d,caller:Hi}),z=s.useRef(null),E=!f||(p||!!f.closest("form")),[R,T]=s.useState(new Set),D=Array.from(R).map(e=>e.props.value).join(";");return Qe.jsx(Bn,{...g,children:Qe.jsxs(Gi,{required:h,scope:t,trigger:f,onTriggerChange:b,valueNode:y,onValueNodeChange:j,valueNodeHasChildren:v,onValueNodeHasChildrenChange:w,contentId:zr(),value:C,onValueChange:_,open:k,onOpenChange:S,dir:N,triggerPointerDownPosRef:z,disabled:u,children:[Qe.jsx(Vi.Provider,{scope:t,children:Qe.jsx(Qi,{scope:e.__scopeSelect,onNativeOptionAdd:s.useCallback(e=>{T(t=>new Set(t).add(e))},[]),onNativeOptionRemove:s.useCallback(e=>{T(t=>{const s=new Set(t);return s.delete(e),s})},[]),children:r})}),E?Qe.jsxs(Wl,{"aria-hidden":!0,required:h,tabIndex:-1,name:m,autoComplete:x,value:C,onChange:e=>_(e.target.value),disabled:u,form:p,children:[void 0===C?Qe.jsx("option",{value:""}):null,Array.from(R)]},D):null]})})};tl.displayName=Hi;var sl="SelectTrigger",rl=s.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:a=!1,...n}=e,i=Ji(r),l=Zi(sl,r),o=l.disabled||a,d=Rt(t,l.onTriggerChange),c=Yi(r),m=s.useRef("touch"),[x,u,h]=Fl(e=>{const t=c().filter(e=>!e.disabled),s=t.find(e=>e.value===l.value),r=$l(t,e,s);void 0!==r&&l.onValueChange(r.value)}),p=e=>{o||(l.onOpenChange(!0),h()),e&&(l.triggerPointerDownPosRef.current={x:Math.round(e.pageX),y:Math.round(e.pageY)})};return Qe.jsx(Fn,{asChild:!0,...i,children:Qe.jsx(sr.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Bl(l.value)?"":void 0,...n,ref:d,onClick:Js(n.onClick,e=>{e.currentTarget.focus(),"mouse"!==m.current&&p(e)}),onPointerDown:Js(n.onPointerDown,e=>{m.current=e.pointerType;const t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0===e.button&&!1===e.ctrlKey&&"mouse"===e.pointerType&&(p(e),e.preventDefault())}),onKeyDown:Js(n.onKeyDown,e=>{const t=""!==x.current;e.ctrlKey||e.altKey||e.metaKey||1!==e.key.length||u(e.key),t&&" "===e.key||Ui.includes(e.key)&&(p(),e.preventDefault())})})})});rl.displayName=sl;var al="SelectValue",nl=s.forwardRef((e,t)=>{const{__scopeSelect:s,className:r,style:a,children:n,placeholder:i="",...l}=e,o=Zi(al,s),{onValueNodeHasChildrenChange:d}=o,c=void 0!==n,m=Rt(t,o.onValueNodeChange);return Sr(()=>{d(c)},[d,c]),Qe.jsx(sr.span,{...l,ref:m,style:{pointerEvents:"none"},children:Bl(o.value)?Qe.jsx(Qe.Fragment,{children:i}):n})});nl.displayName=al;var il=s.forwardRef((e,t)=>{const{__scopeSelect:s,children:r,...a}=e;return Qe.jsx(sr.span,{"aria-hidden":!0,...a,ref:t,children:r||"▼"})});il.displayName="SelectIcon";var ll=e=>Qe.jsx(qn,{asChild:!0,...e});ll.displayName="SelectPortal";var ol="SelectContent",dl=s.forwardRef((e,t)=>{const r=Zi(ol,e.__scopeSelect),[a,n]=s.useState();if(Sr(()=>{n(new DocumentFragment)},[]),!r.open){const t=a;return t?o.createPortal(Qe.jsx(ml,{scope:e.__scopeSelect,children:Qe.jsx(Vi.Slot,{scope:e.__scopeSelect,children:Qe.jsx("div",{children:e.children})})}),t):null}return Qe.jsx(hl,{...e,ref:t})});dl.displayName=ol;var cl=10,[ml,xl]=Ki(ol),ul=Tt("SelectContent.RemoveScroll"),hl=s.forwardRef((e,t)=>{const{__scopeSelect:r,position:a="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:i,onPointerDownOutside:l,side:o,sideOffset:d,align:c,alignOffset:m,arrowPadding:x,collisionBoundary:u,collisionPadding:h,sticky:p,hideWhenDetached:g,avoidCollisions:f,...b}=e,y=Zi(ol,r),[j,v]=s.useState(null),[w,N]=s.useState(null),k=Rt(t,e=>v(e)),[S,C]=s.useState(null),[_,z]=s.useState(null),E=Yi(r),[R,T]=s.useState(!1),D=s.useRef(!1);s.useEffect(()=>{if(j)return ti(j)},[j]),ur();const I=s.useCallback(e=>{const[t,...s]=E().map(e=>e.ref.current),[r]=s.slice(-1),a=document.activeElement;for(const n of e){if(n===a)return;if(n?.scrollIntoView({block:"nearest"}),n===t&&w&&(w.scrollTop=0),n===r&&w&&(w.scrollTop=w.scrollHeight),n?.focus(),document.activeElement!==a)return}},[E,w]),L=s.useCallback(()=>I([S,j]),[I,S,j]);s.useEffect(()=>{R&&L()},[R,L]);const{onOpenChange:P,triggerPointerDownPosRef:M}=y;s.useEffect(()=>{if(j){let e={x:0,y:0};const t=t=>{e={x:Math.abs(Math.round(t.pageX)-(M.current?.x??0)),y:Math.abs(Math.round(t.pageY)-(M.current?.y??0))}},s=s=>{e.x<=10&&e.y<=10?s.preventDefault():j.contains(s.target)||P(!1),document.removeEventListener("pointermove",t),M.current=null};return null!==M.current&&(document.addEventListener("pointermove",t),document.addEventListener("pointerup",s,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",t),document.removeEventListener("pointerup",s,{capture:!0})}}},[j,P,M]),s.useEffect(()=>{const e=()=>P(!1);return window.addEventListener("blur",e),window.addEventListener("resize",e),()=>{window.removeEventListener("blur",e),window.removeEventListener("resize",e)}},[P]);const[A,O]=Fl(e=>{const t=E().filter(e=>!e.disabled),s=t.find(e=>e.ref.current===document.activeElement),r=$l(t,e,s);r&&setTimeout(()=>r.ref.current.focus())}),W=s.useCallback((e,t,s)=>{const r=!D.current&&!s;(void 0!==y.value&&y.value===t||r)&&(C(e),r&&(D.current=!0))},[y.value]),B=s.useCallback(()=>j?.focus(),[j]),F=s.useCallback((e,t,s)=>{const r=!D.current&&!s;(void 0!==y.value&&y.value===t||r)&&z(e)},[y.value]),$="popper"===a?gl:pl,U=$===gl?{side:o,sideOffset:d,align:c,alignOffset:m,arrowPadding:x,collisionBoundary:u,collisionPadding:h,sticky:p,hideWhenDetached:g,avoidCollisions:f}:{};return Qe.jsx(ml,{scope:r,content:j,viewport:w,onViewportChange:N,itemRefCallback:W,selectedItem:S,onItemLeave:B,itemTextRefCallback:F,focusSelectedItem:L,selectedItemText:_,position:a,isPositioned:R,searchRef:A,children:Qe.jsx($i,{as:ul,allowPinchZoom:!0,children:Qe.jsx(br,{asChild:!0,trapped:y.open,onMountAutoFocus:e=>{e.preventDefault()},onUnmountAutoFocus:Js(n,e=>{y.trigger?.focus({preventScroll:!0}),e.preventDefault()}),children:Qe.jsx(dr,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:Qe.jsx($,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:e=>e.preventDefault(),...b,...U,onPlaced:()=>T(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:Js(b.onKeyDown,e=>{const t=e.ctrlKey||e.altKey||e.metaKey;if("Tab"===e.key&&e.preventDefault(),t||1!==e.key.length||O(e.key),["ArrowUp","ArrowDown","Home","End"].includes(e.key)){let t=E().filter(e=>!e.disabled).map(e=>e.ref.current);if(["ArrowUp","End"].includes(e.key)&&(t=t.slice().reverse()),["ArrowUp","ArrowDown"].includes(e.key)){const s=e.target,r=t.indexOf(s);t=t.slice(r+1)}setTimeout(()=>I(t)),e.preventDefault()}})})})})})})});hl.displayName="SelectContentImpl";var pl=s.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:a,...n}=e,i=Zi(ol,r),l=xl(ol,r),[o,d]=s.useState(null),[c,m]=s.useState(null),x=Rt(t,e=>m(e)),u=Yi(r),h=s.useRef(!1),p=s.useRef(!0),{viewport:g,selectedItem:f,selectedItemText:b,focusSelectedItem:y}=l,j=s.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&g&&f&&b){const e=i.trigger.getBoundingClientRect(),t=c.getBoundingClientRect(),s=i.valueNode.getBoundingClientRect(),r=b.getBoundingClientRect();if("rtl"!==i.dir){const a=r.left-t.left,n=s.left-a,i=e.left-n,l=e.width+i,d=Math.max(l,t.width),c=window.innerWidth-cl,m=Ks(n,[cl,Math.max(cl,c-d)]);o.style.minWidth=l+"px",o.style.left=m+"px"}else{const a=t.right-r.right,n=window.innerWidth-s.right-a,i=window.innerWidth-e.right-n,l=e.width+i,d=Math.max(l,t.width),c=window.innerWidth-cl,m=Ks(n,[cl,Math.max(cl,c-d)]);o.style.minWidth=l+"px",o.style.right=m+"px"}const n=u(),l=window.innerHeight-2*cl,d=g.scrollHeight,m=window.getComputedStyle(c),x=parseInt(m.borderTopWidth,10),p=parseInt(m.paddingTop,10),y=parseInt(m.borderBottomWidth,10),j=x+p+d+parseInt(m.paddingBottom,10)+y,v=Math.min(5*f.offsetHeight,j),w=window.getComputedStyle(g),N=parseInt(w.paddingTop,10),k=parseInt(w.paddingBottom,10),S=e.top+e.height/2-cl,C=l-S,_=f.offsetHeight/2,z=x+p+(f.offsetTop+_),E=j-z;if(z<=S){const e=n.length>0&&f===n[n.length-1].ref.current;o.style.bottom="0px";const t=c.clientHeight-g.offsetTop-g.offsetHeight,s=z+Math.max(C,_+(e?k:0)+t+y);o.style.height=s+"px"}else{const e=n.length>0&&f===n[0].ref.current;o.style.top="0px";const t=Math.max(S,x+g.offsetTop+(e?N:0)+_)+E;o.style.height=t+"px",g.scrollTop=z-S+g.offsetTop}o.style.margin=`${cl}px 0`,o.style.minHeight=v+"px",o.style.maxHeight=l+"px",a?.(),requestAnimationFrame(()=>h.current=!0)}},[u,i.trigger,i.valueNode,o,c,g,f,b,i.dir,a]);Sr(()=>j(),[j]);const[v,w]=s.useState();Sr(()=>{c&&w(window.getComputedStyle(c).zIndex)},[c]);const N=s.useCallback(e=>{e&&!0===p.current&&(j(),y?.(),p.current=!1)},[j,y]);return Qe.jsx(fl,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:h,onScrollButtonChange:N,children:Qe.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:v},children:Qe.jsx(sr.div,{...n,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});pl.displayName="SelectItemAlignedPosition";var gl=s.forwardRef((e,t)=>{const{__scopeSelect:s,align:r="start",collisionPadding:a=cl,...n}=e,i=Ji(s);return Qe.jsx($n,{...i,...n,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...n.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});gl.displayName="SelectPopperPosition";var[fl,bl]=Ki(ol,{}),yl="SelectViewport",jl=s.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:a,...n}=e,i=xl(yl,r),l=bl(yl,r),o=Rt(t,i.onViewportChange),d=s.useRef(0);return Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),Qe.jsx(Vi.Slot,{scope:r,children:Qe.jsx(sr.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:Js(n.onScroll,e=>{const t=e.currentTarget,{contentWrapper:s,shouldExpandOnScrollRef:r}=l;if(r?.current&&s){const e=Math.abs(d.current-t.scrollTop);if(e>0){const r=window.innerHeight-2*cl,a=parseFloat(s.style.minHeight),n=parseFloat(s.style.height),i=Math.max(a,n);if(i<r){const a=i+e,n=Math.min(r,a),l=a-n;s.style.height=n+"px","0px"===s.style.bottom&&(t.scrollTop=l>0?l:0,s.style.justifyContent="flex-end")}}}d.current=t.scrollTop})})})]})});jl.displayName=yl;var vl="SelectGroup",[wl,Nl]=Ki(vl);s.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e,a=zr();return Qe.jsx(wl,{scope:s,id:a,children:Qe.jsx(sr.div,{role:"group","aria-labelledby":a,...r,ref:t})})}).displayName=vl;var kl="SelectLabel";s.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e,a=Nl(kl,s);return Qe.jsx(sr.div,{id:a.id,...r,ref:t})}).displayName=kl;var Sl="SelectItem",[Cl,_l]=Ki(Sl),zl=s.forwardRef((e,t)=>{const{__scopeSelect:r,value:a,disabled:n=!1,textValue:i,...l}=e,o=Zi(Sl,r),d=xl(Sl,r),c=o.value===a,[m,x]=s.useState(i??""),[u,h]=s.useState(!1),p=Rt(t,e=>d.itemRefCallback?.(e,a,n)),g=zr(),f=s.useRef("touch"),b=()=>{n||(o.onValueChange(a),o.onOpenChange(!1))};if(""===a)throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return Qe.jsx(Cl,{scope:r,value:a,disabled:n,textId:g,isSelected:c,onItemTextChange:s.useCallback(e=>{x(t=>t||(e?.textContent??"").trim())},[]),children:Qe.jsx(Vi.ItemSlot,{scope:r,value:a,disabled:n,textValue:m,children:Qe.jsx(sr.div,{role:"option","aria-labelledby":g,"data-highlighted":u?"":void 0,"aria-selected":c&&u,"data-state":c?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...l,ref:p,onFocus:Js(l.onFocus,()=>h(!0)),onBlur:Js(l.onBlur,()=>h(!1)),onClick:Js(l.onClick,()=>{"mouse"!==f.current&&b()}),onPointerUp:Js(l.onPointerUp,()=>{"mouse"===f.current&&b()}),onPointerDown:Js(l.onPointerDown,e=>{f.current=e.pointerType}),onPointerMove:Js(l.onPointerMove,e=>{f.current=e.pointerType,n?d.onItemLeave?.():"mouse"===f.current&&e.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Js(l.onPointerLeave,e=>{e.currentTarget===document.activeElement&&d.onItemLeave?.()}),onKeyDown:Js(l.onKeyDown,e=>{""!==d.searchRef?.current&&" "===e.key||(qi.includes(e.key)&&b()," "===e.key&&e.preventDefault())})})})})});zl.displayName=Sl;var El="SelectItemText",Rl=s.forwardRef((e,t)=>{const{__scopeSelect:r,className:a,style:n,...i}=e,l=Zi(El,r),d=xl(El,r),c=_l(El,r),m=el(El,r),[x,u]=s.useState(null),h=Rt(t,e=>u(e),c.onItemTextChange,e=>d.itemTextRefCallback?.(e,c.value,c.disabled)),p=x?.textContent,g=s.useMemo(()=>Qe.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:f,onNativeOptionRemove:b}=m;return Sr(()=>(f(g),()=>b(g)),[f,b,g]),Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(sr.span,{id:c.textId,...i,ref:h}),c.isSelected&&l.valueNode&&!l.valueNodeHasChildren?o.createPortal(i.children,l.valueNode):null]})});Rl.displayName=El;var Tl="SelectItemIndicator",Dl=s.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e;return _l(Tl,s).isSelected?Qe.jsx(sr.span,{"aria-hidden":!0,...r,ref:t}):null});Dl.displayName=Tl;var Il="SelectScrollUpButton",Ll=s.forwardRef((e,t)=>{const r=xl(Il,e.__scopeSelect),a=bl(Il,e.__scopeSelect),[n,i]=s.useState(!1),l=Rt(t,a.onScrollButtonChange);return Sr(()=>{if(r.viewport&&r.isPositioned){let e=function(){const e=t.scrollTop>0;i(e)};const t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),n?Qe.jsx(Al,{...e,ref:l,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop-t.offsetHeight)}}):null});Ll.displayName=Il;var Pl="SelectScrollDownButton",Ml=s.forwardRef((e,t)=>{const r=xl(Pl,e.__scopeSelect),a=bl(Pl,e.__scopeSelect),[n,i]=s.useState(!1),l=Rt(t,a.onScrollButtonChange);return Sr(()=>{if(r.viewport&&r.isPositioned){let e=function(){const e=t.scrollHeight-t.clientHeight,s=Math.ceil(t.scrollTop)<e;i(s)};const t=r.viewport;return e(),t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)}},[r.viewport,r.isPositioned]),n?Qe.jsx(Al,{...e,ref:l,onAutoScroll:()=>{const{viewport:e,selectedItem:t}=r;e&&t&&(e.scrollTop=e.scrollTop+t.offsetHeight)}}):null});Ml.displayName=Pl;var Al=s.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:a,...n}=e,i=xl("SelectScrollButton",r),l=s.useRef(null),o=Yi(r),d=s.useCallback(()=>{null!==l.current&&(window.clearInterval(l.current),l.current=null)},[]);return s.useEffect(()=>()=>d(),[d]),Sr(()=>{const e=o().find(e=>e.ref.current===document.activeElement);e?.ref.current?.scrollIntoView({block:"nearest"})},[o]),Qe.jsx(sr.div,{"aria-hidden":!0,...n,ref:t,style:{flexShrink:0,...n.style},onPointerDown:Js(n.onPointerDown,()=>{null===l.current&&(l.current=window.setInterval(a,50))}),onPointerMove:Js(n.onPointerMove,()=>{i.onItemLeave?.(),null===l.current&&(l.current=window.setInterval(a,50))}),onPointerLeave:Js(n.onPointerLeave,()=>{d()})})});s.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e;return Qe.jsx(sr.div,{"aria-hidden":!0,...r,ref:t})}).displayName="SelectSeparator";var Ol="SelectArrow";s.forwardRef((e,t)=>{const{__scopeSelect:s,...r}=e,a=Ji(s),n=Zi(Ol,s),i=xl(Ol,s);return n.open&&"popper"===i.position?Qe.jsx(Un,{...a,...r,ref:t}):null}).displayName=Ol;var Wl=s.forwardRef(({__scopeSelect:e,value:t,...r},a)=>{const n=s.useRef(null),i=Rt(a,n),l=Yn(t);return s.useEffect(()=>{const e=n.current;if(!e)return;const s=window.HTMLSelectElement.prototype,r=Object.getOwnPropertyDescriptor(s,"value").set;if(l!==t&&r){const s=new Event("change",{bubbles:!0});r.call(e,t),e.dispatchEvent(s)}},[l,t]),Qe.jsx(sr.select,{...r,style:{...Xn,...r.style},ref:i,defaultValue:t})});function Bl(e){return""===e||void 0===e}function Fl(e){const t=rr(e),r=s.useRef(""),a=s.useRef(0),n=s.useCallback(e=>{const s=r.current+e;t(s),function e(t){r.current=t,window.clearTimeout(a.current),""!==t&&(a.current=window.setTimeout(()=>e(""),1e3))}(s)},[t]),i=s.useCallback(()=>{r.current="",window.clearTimeout(a.current)},[]);return s.useEffect(()=>()=>window.clearTimeout(a.current),[]),[r,n,i]}function $l(e,t,s){const r=t.length>1&&Array.from(t).every(e=>e===t[0])?t[0]:t,a=s?e.indexOf(s):-1;let n=(i=e,l=Math.max(a,0),i.map((e,t)=>i[(l+t)%i.length]));var i,l;1===r.length&&(n=n.filter(e=>e!==s));const o=n.find(e=>e.textValue.toLowerCase().startsWith(r.toLowerCase()));return o!==s?o:void 0}Wl.displayName="SelectBubbleInput";var Ul=tl,ql=rl,Hl=nl,Vl=il,Yl=ll,Xl=dl,Kl=jl,Jl=zl,Gl=Rl,Zl=Dl,Ql=Ll,eo=Ml;function to({...e}){return Qe.jsx(Ul,{"data-slot":"select",...e})}function so({...e}){return Qe.jsx(Hl,{"data-slot":"select-value",...e})}function ro({className:e,size:t="default",children:s,...r}){return Qe.jsxs(ql,{"data-slot":"select-trigger","data-size":t,className:Hs("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[s,Qe.jsx(Vl,{asChild:!0,children:Qe.jsx(L,{className:"size-4 opacity-50"})})]})}function ao({className:e,children:t,position:s="popper",...r}){return Qe.jsx(Yl,{children:Qe.jsxs(Xl,{"data-slot":"select-content",className:Hs("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...r,children:[Qe.jsx(io,{}),Qe.jsx(Kl,{className:Hs("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),Qe.jsx(lo,{})]})})}function no({className:e,children:t,...s}){return Qe.jsxs(Jl,{"data-slot":"select-item",className:Hs("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...s,children:[Qe.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:Qe.jsx(Zl,{children:Qe.jsx(P,{className:"size-4"})})}),Qe.jsx(Gl,{children:t})]})}function io({className:e,...t}){return Qe.jsx(Ql,{"data-slot":"select-scroll-up-button",className:Hs("flex cursor-default items-center justify-center py-1",e),...t,children:Qe.jsx(M,{className:"size-4"})})}function lo({className:e,...t}){return Qe.jsx(eo,{"data-slot":"select-scroll-down-button",className:Hs("flex cursor-default items-center justify-center py-1",e),...t,children:Qe.jsx(L,{className:"size-4"})})}function oo({className:e,type:t,...s}){return Qe.jsx("input",{type:t,"data-slot":"input",className:Hs("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}function co({period:e,dateFrom:t,dateTo:s,onPeriodChange:r,onDateFromChange:a,onDateToChange:n,className:i="",showAllOption:l=!0}){return Qe.jsxs("div",{className:`flex flex-wrap gap-4 items-center ${i}`,children:[Qe.jsxs(to,{value:e,onValueChange:r,children:[Qe.jsxs(ro,{className:"w-full md:w-[200px]",children:[Qe.jsx(R,{className:"w-4 h-4 mr-2"}),Qe.jsx(so,{placeholder:"Период"})]}),Qe.jsxs(ao,{children:[l&&Qe.jsx(no,{value:"all",children:"Все периоды"}),Qe.jsx(no,{value:"today",children:"Сегодня"}),Qe.jsx(no,{value:"7",children:"Последние 7 дней"}),Qe.jsx(no,{value:"14",children:"Последние 14 дней"}),Qe.jsx(no,{value:"30",children:"Последний месяц"}),Qe.jsx(no,{value:"90",children:"Последние 3 месяца"}),Qe.jsx(no,{value:"custom",children:"Свой период"})]})]}),"custom"===e&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(oo,{type:"date",value:t,onChange:e=>a(e.target.value),placeholder:"От",className:"w-full md:w-[180px]"}),Qe.jsx(oo,{type:"date",value:s,onChange:e=>n(e.target.value),placeholder:"До",className:"w-full md:w-[180px]"})]})]})}function mo({label:e,icon:t,options:r,disabled:a=!1,loading:n=!1,variant:i="outline",className:l=""}){const[o,d]=s.useState(!1),c=s.useRef(null);s.useEffect(()=>{function e(e){c.current&&!c.current.contains(e.target)&&d(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);return Qe.jsxs("div",{ref:c,className:"relative",children:[Qe.jsxs("button",{onClick:()=>d(!o),disabled:a||n,className:`relative inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${{default:"bg-pink-600 text-white hover:bg-pink-700",outline:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"bg-transparent text-gray-700 hover:bg-gray-100"}[i]} ${l} ${a||n?"opacity-50 cursor-not-allowed":""}`,children:[t,Qe.jsx("span",{children:n?"Загрузка...":e}),Qe.jsx(L,{className:"w-4 h-4 transition-transform "+(o?"rotate-180":"")})]}),o&&Qe.jsx("div",{className:"absolute right-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[180px]",children:r.map((e,t)=>Qe.jsxs("button",{onClick:()=>{e.onClick(),d(!1)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center gap-3 transition-colors "+(t<r.length-1?"border-b border-gray-100":""),children:[e.icon,Qe.jsx("span",{className:`text-sm ${e.color||"text-gray-900"}`,children:e.label})]},e.value))})]})}function xo({onExport:e,disabled:t,loading:s}){const r=[{label:"Экспорт в CSV",value:"csv",icon:Qe.jsx(O,{className:"w-4 h-4 text-gray-600"}),onClick:()=>e("csv")},{label:"Экспорт в Excel",value:"excel",icon:Qe.jsx(W,{className:"w-4 h-4 text-green-600"}),onClick:()=>e("excel")},{label:"Экспорт в PDF",value:"pdf",icon:Qe.jsx(O,{className:"w-4 h-4 text-red-600"}),onClick:()=>e("pdf")}];return Qe.jsx(mo,{label:s?"Экспорт...":"Экспорт",icon:Qe.jsx(A,{className:"w-4 h-4"}),options:r,disabled:t,loading:s})}function uo({items:e,period:t,dateFrom:r,dateTo:a,getItemDate:n}){return s.useMemo(()=>"all"===t?e:e.filter(e=>{const s=new Date(n(e)),i=new Date;if("today"===t)return s.toDateString()===i.toDateString();if("week"===t){return s>=new Date(i.getTime()-6048e5)}if("7"===t||"14"===t||"30"===t||"90"===t){const e=parseInt(t);return s>=new Date(i.getTime()-24*e*60*60*1e3)}if("custom"===t&&r&&a){const e=new Date(r),t=new Date(a);return t.setHours(23,59,59,999),s>=e&&s<=t}return!0}),[e,t,r,a,n])}const ho=[{name:"Зелёный",value:"bg-green-100 text-green-800"},{name:"Синий",value:"bg-blue-100 text-blue-800"},{name:"Жёлтый",value:"bg-yellow-100 text-yellow-800"},{name:"Оранжевый",value:"bg-orange-100 text-orange-800"},{name:"Красный",value:"bg-red-100 text-red-800"},{name:"Фиолетовый",value:"bg-purple-100 text-purple-800"},{name:"Розовый",value:"bg-pink-100 text-pink-800"},{name:"Серый",value:"bg-gray-100 text-gray-800"}];function po({value:e,onChange:t,options:r,allowAdd:a,onAddStatus:n}){const[i,l]=s.useState(!1),[o,d]=s.useState(""),[c,m]=s.useState(""),[x,u]=s.useState(ho[0].value),[h,p]=s.useState(!1);return Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[Qe.jsxs("select",{value:e,onChange:e=>{"__add_new__"===e.target.value?l(!0):t(e.target.value)},className:`text-sm font-medium border-0 ${r[e]?.color||"bg-gray-100 text-gray-800"}`,style:{minWidth:"120px",paddingLeft:"0.75rem",paddingRight:"2.5rem",paddingTop:"0.375rem",paddingBottom:"0.375rem",borderRadius:"9999px",cursor:"pointer",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%23374151' d='M4 6l4 4 4-4z'/%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"16px 16px",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[Object.entries(r).map(([e,t])=>Qe.jsx("option",{value:e,children:t.label},e)),a&&Qe.jsx("option",{value:"__add_new__",children:"+ Добавить статус"})]}),a&&Qe.jsx("button",{onClick:()=>l(!0),style:{padding:"0.25rem 0.5rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#6b7280"},title:"Добавить новый статус",children:Qe.jsx(B,{style:{width:"14px",height:"14px"}})})]}),i&&Qe.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflow:"auto"},children:[Qe.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#111"},children:"Добавить статус"}),Qe.jsx("button",{onClick:()=>l(!1),disabled:h,style:{backgroundColor:"transparent",border:"none",cursor:h?"not-allowed":"pointer",color:"#6b7280",fontSize:"1.5rem",padding:"0",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center"},children:Qe.jsx(g,{style:{width:"20px",height:"20px"}})})]}),Qe.jsxs("div",{style:{padding:"1.5rem"},children:[Qe.jsxs("div",{style:{marginBottom:"1.25rem"},children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Ключ (на английском) *"}),Qe.jsx("input",{type:"text",value:o,onChange:e=>d(e.target.value),placeholder:"new_status",disabled:h,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}}),Qe.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.25rem"},children:"Используется в системе (lowercase, без пробелов)"})]}),Qe.jsxs("div",{style:{marginBottom:"1.25rem"},children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Название *"}),Qe.jsx("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"Новый статус",disabled:h,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem"},children:"Цвет *"}),Qe.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"0.75rem"},children:ho.map(e=>Qe.jsx("button",{type:"button",onClick:()=>u(e.value),disabled:h,style:{padding:"0.75rem",borderRadius:"0.5rem",border:x===e.value?"3px solid #ec4899":"2px solid #e5e7eb",cursor:h?"not-allowed":"pointer",fontSize:"0.875rem",fontWeight:"500",transition:"all 0.2s",backgroundColor:x===e.value?"#fdf2f8":"#fff"},className:e.value,children:e.name},e.value))})]}),c&&Qe.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",backgroundColor:"#f9fafb",borderRadius:"0.5rem",border:"1px solid #e5e7eb"},children:[Qe.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.5rem",fontWeight:"600"},children:"Предпросмотр:"}),Qe.jsx("span",{className:x,style:{display:"inline-block",padding:"0.375rem 0.75rem",borderRadius:"9999px",fontSize:"0.875rem",fontWeight:"500"},children:c})]})]}),Qe.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e5e7eb",display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[Qe.jsx("button",{onClick:()=>l(!1),disabled:h,style:{padding:"0.625rem 1.25rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontWeight:"500",color:"#374151",cursor:h?"not-allowed":"pointer",fontSize:"0.875rem"},children:"Отмена"}),Qe.jsx("button",{onClick:async()=>{if(!o.trim()||!c.trim()||!n)return;const e=o.trim().toLowerCase().replace(/\s+/g,"_");if(r[e])alert("Статус с таким ключом уже существует");else{p(!0);try{await n(e,c.trim(),x),l(!1),d(""),m(""),u(ho[0].value),t(e)}catch(jx){}finally{p(!1)}}},disabled:h||!o.trim()||!c.trim(),style:{padding:"0.625rem 1.5rem",backgroundColor:"#ec4899",border:"none",borderRadius:"0.5rem",color:"#fff",fontWeight:"500",cursor:!h&&o.trim()&&c.trim()?"pointer":"not-allowed",opacity:!h&&o.trim()&&c.trim()?1:.5,fontSize:"0.875rem"},children:h?"Добавление...":"Добавить"})]})]})})]})}const go={new:{label:"Новый",color:"bg-green-100 text-green-800"},contacted:{label:"Связались",color:"bg-blue-100 text-blue-800"},interested:{label:"Заинтересован",color:"bg-yellow-100 text-yellow-800"},lead:{label:"Лид",color:"bg-orange-100 text-orange-800"},customer:{label:"Клиент",color:"bg-purple-100 text-purple-800"},vip:{label:"VIP",color:"bg-pink-100 text-pink-800"},inactive:{label:"Неактивен",color:"bg-gray-100 text-gray-800"},blocked:{label:"Заблокирован",color:"bg-red-100 text-red-800"}},fo={pending:{label:"Ожидает",color:"bg-yellow-100 text-yellow-800"},confirmed:{label:"Подтверждена",color:"bg-green-100 text-green-800"},completed:{label:"Завершена",color:"bg-blue-100 text-blue-800"},cancelled:{label:"Отменена",color:"bg-red-100 text-red-800"},new:{label:"Новая",color:"bg-purple-100 text-purple-800"}};function bo(){const[e,t]=s.useState(go),[r,a]=s.useState(!0);s.useEffect(()=>{n()},[]);const n=async()=>{try{const e=await Ct.getClientStatuses();e.statuses&&t(e.statuses)}catch(jx){}finally{a(!1)}};return{statuses:e,loading:r,addStatus:async(s,r,a)=>{try{return await Ct.createClientStatus({status_key:s,status_label:r,status_color:a}),t({...e,[s]:{label:r,color:a}}),gt.success("Статус добавлен"),!0}catch(jx){return gt.error("Ошибка добавления статуса"),!1}},reload:n}}const yo={baseURL:"http://localhost:8000",async getBookings(){return(await fetch(`${this.baseURL}/api/bookings`,{credentials:"include"})).json()},async getClients(){return(await fetch(`${this.baseURL}/api/clients`,{credentials:"include"})).json()},async getServices(){return(await fetch(`${this.baseURL}/api/services`,{credentials:"include"})).json()},async createBooking(e){return(await fetch(`${this.baseURL}/api/bookings`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()},async updateBookingStatus(e,t){return(await fetch(`${this.baseURL}/api/bookings/${e}/status`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).json()},async exportBookings(e,t,s){let r=`${this.baseURL}/api/export/bookings?format=${e}`;t&&s&&(r+=`&date_from=${t}&date_to=${s}`);const a=await fetch(r,{credentials:"include"});if(!a.ok)throw new Error("Export failed");return a.blob()},async importBookings(e){const t=new FormData;t.append("file",e);const s=await fetch(`${this.baseURL}/api/import/bookings`,{method:"POST",credentials:"include",body:t});if(!s.ok)throw new Error("Import failed");return s.json()},async downloadImportTemplate(e){const t=await fetch(`${this.baseURL}/api/import/bookings/template?format=${e}`,{credentials:"include"});if(!t.ok)throw new Error("Template download failed");return t.blob()},getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null}};function jo(){const e=i(),{statuses:t}=function(){const[e,t]=s.useState(fo),[r,a]=s.useState(!0);s.useEffect(()=>{n()},[]);const n=async()=>{try{const e=await Ct.getBookingStatuses();e.statuses&&t(e.statuses)}catch(jx){}finally{a(!1)}};return{statuses:e,loading:r,addStatus:async(s,r,a)=>{try{return await Ct.createBookingStatus({status_key:s,status_label:r,status_color:a}),t({...e,[s]:{label:r,color:a}}),gt.success("Статус добавлен"),!0}catch(jx){return gt.error("Ошибка добавления статуса"),!1}},reload:n}}(),[r,a]=s.useState([]),[n,l]=s.useState([]),[o,d]=s.useState([]),[c,m]=s.useState([]),[x,u]=s.useState(""),[h,p]=s.useState("all"),[g,f]=s.useState(!0),[b,y]=s.useState(null),[v,w]=s.useState(!1),[N,k]=s.useState(!1),[S,C]=s.useState(!1),[_,T]=s.useState(""),[D,I]=s.useState(!1),[L,P]=s.useState(null),[M,A]=s.useState(""),[O,W]=s.useState(!1),[H,V]=s.useState(null),[Y,X]=s.useState({phone:"",date:"",time:"",revenue:0}),[K,J]=s.useState(!1),[G,Z]=s.useState(!1),[Q,ee]=s.useState(""),[te,se]=s.useState(""),[re,ae]=s.useState(!1),[ne,ie]=s.useState(!1),[le,oe]=s.useState(null),[de,ce]=s.useState(null),[me,xe]=s.useState("all"),[ue,he]=s.useState(""),[pe,ge]=s.useState(""),fe=yo.getCurrentUser(),be="admin"===fe?.role;s.useEffect(()=>{ye()},[]),uo({items:r,period:me,dateFrom:ue,dateTo:pe,getItemDate:e=>e.datetime||e.created_at}),s.useEffect(()=>{const e=r.filter(e=>{const t=(e.name||"").toLowerCase().includes(x.toLowerCase())||(e.service_name||"").toLowerCase().includes(x.toLowerCase()),s="all"===h||e.status===h;let r=!0;if("all"!==me){const t=new Date(e.datetime||e.created_at),s=new Date;if("today"===me)r=t.toDateString()===s.toDateString();else if("week"===me){r=t>=new Date(s.getTime()-6048e5)}else if("month"===me){r=t>=new Date(s.getTime()-2592e6)}else if("custom"===me&&ue&&pe){const e=new Date(ue),s=new Date(pe);r=t>=e&&t<=s}}return t&&s&&r});m(e)},[x,h,r,me,ue,pe]);const ye=async()=>{try{f(!0),y(null);const[e,t,s]=await Promise.all([yo.getBookings(),yo.getClients(),yo.getServices()]);a(e.bookings||[]),l(t.clients||[]),d(s.services||[])}catch(jx){y(jx.message),gt.error(`Ошибка: ${jx.message}`)}finally{f(!1)}},je=()=>{T(""),A(""),P(null),V(null),X({phone:"",date:"",time:"",revenue:0})},ve=n.filter(e=>(e.display_name||"").toLowerCase().includes(_.toLowerCase())||(e.phone||"").includes(_)),we=o.filter(e=>(e.name_ru||"").toLowerCase().includes(M.toLowerCase())||(e.name||"").toLowerCase().includes(M.toLowerCase())),Ne=e=>{try{const t=new Date(e);return t.toLocaleDateString("ru-RU")+" "+t.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}catch{return e}},ke=async e=>{try{Z(!0);const t=await yo.exportBookings(e,Q,te),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s;const a="excel"===e?"xlsx":e,n=Q&&te?`_${Q}_${te}`:"";r.download=`bookings${n}.${a}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),gt.success(`Файл ${e.toUpperCase()} успешно скачан`),J(!1)}catch(jx){gt.error("Ошибка при экспорте")}finally{Z(!1)}},Se=async e=>{try{const t=await yo.downloadImportTemplate(e),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="bookings_template."+("excel"===e?"xlsx":"csv"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),gt.success("Шаблон скачан")}catch(jx){gt.error("Ошибка при скачивании шаблона")}},Ce={pending:r.filter(e=>"pending"===e.status||"new"===e.status).length,completed:r.filter(e=>"completed"===e.status).length,total:r.length,revenue:r.filter(e=>"completed"===e.status).reduce((e,t)=>e+(t.revenue||0),0)};return g?Qe.jsx("div",{style:{padding:"2rem",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh"},children:Qe.jsx(z,{style:{width:"32px",height:"32px",color:"#ec4899",animation:"spin 1s linear infinite"}})}):b?Qe.jsx("div",{style:{padding:"2rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"0.5rem",padding:"1rem"},children:[Qe.jsx(E,{style:{color:"#c00"}}),Qe.jsx("p",{style:{color:"#800",marginTop:"0.5rem"},children:b})]})}):Qe.jsxs("div",{style:{padding:"2rem"},children:[Qe.jsxs("div",{style:{marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Qe.jsxs("div",{children:[Qe.jsxs("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#111",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[Qe.jsx(R,{style:{width:"32px",height:"32px",color:"#ec4899"}}),"Управление записями"]}),Qe.jsxs("p",{style:{color:"#666"},children:[c.length," записей"]})]}),Qe.jsxs("button",{onClick:async()=>{w(!0),await ye(),w(!1)},disabled:v,style:{padding:"0.5rem 1rem",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"0.5rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[Qe.jsx(F,{style:{width:"16px",height:"16px",animation:v?"spin 1s linear infinite":"none"}}),"Обновить"]})]}),Qe.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[Qe.jsxs("div",{style:{backgroundColor:"#fff",padding:"1.5rem",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[Qe.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"0.5rem"},children:"Ожидают"}),Qe.jsx("h3",{style:{fontSize:"1.875rem",color:"#eab308",fontWeight:"bold"},children:Ce.pending})]}),Qe.jsxs("div",{style:{backgroundColor:"#fff",padding:"1.5rem",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[Qe.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"0.5rem"},children:"Завершённых"}),Qe.jsx("h3",{style:{fontSize:"1.875rem",color:"#3b82f6",fontWeight:"bold"},children:Ce.completed})]}),Qe.jsxs("div",{style:{backgroundColor:"#fff",padding:"1.5rem",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[Qe.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"0.5rem"},children:"Всего"}),Qe.jsx("h3",{style:{fontSize:"1.875rem",color:"#111",fontWeight:"bold"},children:Ce.total})]}),Qe.jsxs("div",{style:{backgroundColor:"#fff",padding:"1.5rem",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[Qe.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem",marginBottom:"0.5rem"},children:"Доход"}),Qe.jsxs("h3",{style:{fontSize:"1.875rem",color:"#10b981",fontWeight:"bold"},children:[Ce.revenue," AED"]})]})]}),Qe.jsx("div",{style:{backgroundColor:"#fff",padding:"1.5rem",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb",marginBottom:"1.5rem"},children:Qe.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[Qe.jsxs("div",{style:{flex:1,position:"relative",minWidth:"200px"},children:[Qe.jsx($,{style:{position:"absolute",left:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"20px",height:"20px",color:"#9ca3af"}}),Qe.jsx("input",{type:"text",placeholder:"Поиск...",value:x,onChange:e=>u(e.target.value),style:{width:"100%",padding:"0.625rem 0.75rem 0.625rem 2.5rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}})]}),Qe.jsxs("select",{value:h,onChange:e=>p(e.target.value),className:"w-full md:w-[200px] px-3 py-2 border border-gray-300 rounded-lg text-sm",style:{paddingRight:"2.5rem",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%236b7280' d='M4 6l4 4 4-4z'/%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"16px 16px",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[Qe.jsx("option",{value:"all",children:"Все статусы"}),Object.entries(t).map(([e,t])=>Qe.jsx("option",{value:e,children:t.label},e))]}),Qe.jsx(co,{period:me,dateFrom:ue,dateTo:pe,onPeriodChange:xe,onDateFromChange:he,onDateToChange:ge,showAllOption:!0}),"custom"===me&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("input",{type:"date",value:ue,onChange:e=>he(e.target.value),style:{padding:"0.625rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",minWidth:"140px"}}),Qe.jsx("input",{type:"date",value:pe,onChange:e=>ge(e.target.value),style:{padding:"0.625rem 0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",minWidth:"140px"}})]}),Qe.jsxs("button",{onClick:()=>k(!0),style:{padding:"0.625rem 1.25rem",backgroundColor:"#ec4899",color:"#fff",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[Qe.jsx(B,{style:{width:"16px",height:"16px"}}),"Добавить"]}),be&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("button",{onClick:()=>ae(!0),disabled:ne,style:{padding:"0.625rem 1.25rem",backgroundColor:"#10b981",color:"#fff",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:ne?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem",opacity:ne?.5:1},children:[Qe.jsx(U,{style:{width:"16px",height:"16px"}}),ne?"Импорт...":"Импорт"]}),Qe.jsx(xo,{onExport:ke,loading:G,disabled:G})]})]})}),Qe.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0.75rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb",overflow:"hidden"},children:c.length>0?Qe.jsx("div",{style:{overflowX:"auto"},children:Qe.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[Qe.jsx("thead",{style:{backgroundColor:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:Qe.jsxs("tr",{children:[Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"ID"}),Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"Клиент"}),Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"Услуга"}),Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"Дата"}),Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"Телефон"}),Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"Статус"}),Qe.jsx("th",{style:{padding:"1rem 1.5rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#6b7280"},children:"Действия"})]})}),Qe.jsx("tbody",{children:c.map((s,n)=>Qe.jsxs("tr",{style:{borderBottom:n!==c.length-1?"1px solid #f3f4f6":"none"},children:[Qe.jsxs("td",{style:{padding:"1rem 1.5rem",fontSize:"0.875rem",color:"#111",fontWeight:"500"},children:["#",s.id]}),Qe.jsx("td",{style:{padding:"1rem 1.5rem"},children:Qe.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[Qe.jsx("div",{style:{width:"40px",height:"40px",backgroundColor:"#fce7f3",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#ec4899",fontWeight:"500",fontSize:"0.875rem"},children:(s.name||"N").charAt(0).toUpperCase()}),Qe.jsx("span",{style:{fontSize:"0.875rem",color:"#111"},children:s.name||"Без имени"})]})}),Qe.jsx("td",{style:{padding:"1rem 1.5rem",fontSize:"0.875rem",color:"#111"},children:s.service_name||"-"}),Qe.jsx("td",{style:{padding:"1rem 1.5rem",fontSize:"0.875rem",color:"#111"},children:Ne(s.datetime)}),Qe.jsx("td",{style:{padding:"1rem 1.5rem",fontSize:"0.875rem",color:"#6b7280"},children:s.phone||"-"}),Qe.jsx("td",{style:{padding:"1rem 1.5rem"},children:Qe.jsx(po,{value:s.status,onChange:e=>(async(e,t)=>{try{await yo.updateBookingStatus(e,t),a(r.map(s=>s.id===e?{...s,status:t}:s)),gt.success("Статус обновлён")}catch(jx){gt.error("Ошибка обновления статуса")}})(s.id,e),options:t})}),Qe.jsx("td",{style:{padding:"1rem 1.5rem"},children:Qe.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[Qe.jsx("button",{onClick:()=>e(`/admin/bookings/${s.id}`),style:{padding:"0.375rem 0.75rem",backgroundColor:"#fff",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:Qe.jsx(q,{style:{width:"16px",height:"16px",color:"#6b7280"}})}),Qe.jsx("button",{onClick:()=>e(`/admin/chat?client_id=${s.client_id}`),style:{padding:"0.375rem 0.75rem",backgroundColor:"#fff",border:"1px solid #d1d5db",borderRadius:"0.375rem",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:Qe.jsx(j,{style:{width:"16px",height:"16px",color:"#10b981"}})})]})})]},s.id))})]})}):Qe.jsxs("div",{style:{padding:"5rem 2rem",textAlign:"center",color:"#9ca3af"},children:[Qe.jsx(R,{style:{width:"64px",height:"64px",color:"#d1d5db",margin:"0 auto 1rem"}}),Qe.jsx("p",{style:{fontSize:"1.125rem"},children:"Записи не найдены"})]})}),re&&Qe.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",width:"100%",maxWidth:"600px",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[Qe.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#111"},children:"Импорт записей"}),Qe.jsx("button",{onClick:()=>{ae(!1),oe(null),ce(null)},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.5rem"},children:"×"})]}),Qe.jsxs("div",{style:{padding:"1.5rem"},children:[Qe.jsx("div",{style:{backgroundColor:"#dbeafe",border:"1px solid #93c5fd",borderRadius:"0.5rem",padding:"1rem",marginBottom:"1.5rem"},children:Qe.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[Qe.jsx(E,{style:{width:"20px",height:"20px",color:"#1e40af",flexShrink:0}}),Qe.jsxs("div",{style:{fontSize:"0.875rem",color:"#1e40af"},children:[Qe.jsx("p",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:"Формат файла:"}),Qe.jsxs("ul",{style:{marginLeft:"1rem",listStyle:"disc"},children:[Qe.jsx("li",{children:"Колонки: instagram_id, name, phone, service, datetime, status, revenue"}),Qe.jsx("li",{children:"Формат даты: YYYY-MM-DD HH:MM (например: 2025-01-15 14:00)"}),Qe.jsx("li",{children:"Поддерживаются CSV и Excel файлы"})]})]})]})}),Qe.jsxs("div",{style:{marginBottom:"1.5rem"},children:[Qe.jsx("p",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Скачать шаблон:"}),Qe.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[Qe.jsx("button",{onClick:()=>Se("csv"),style:{flex:1,padding:"0.5rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",cursor:"pointer"},children:"📄 CSV Шаблон"}),Qe.jsx("button",{onClick:()=>Se("excel"),style:{flex:1,padding:"0.5rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",cursor:"pointer"},children:"📊 Excel Шаблон"})]})]}),Qe.jsxs("div",{style:{marginBottom:"1.5rem"},children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Выберите файл *"}),Qe.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>{const t=e.target.files?.[0];if(t){const e=t.name.split(".").pop()?.toLowerCase();if(!["csv","xlsx","xls"].includes(e||""))return void gt.error("Поддерживаются только CSV и Excel файлы");oe(t),ce(null)}},style:{width:"100%",padding:"0.75rem",border:"2px dashed #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",cursor:"pointer"}}),le&&Qe.jsxs("p",{style:{fontSize:"0.75rem",color:"#10b981",marginTop:"0.5rem"},children:["✓ ",le.name]})]}),de&&Qe.jsxs("div",{style:{backgroundColor:de.imported>0?"#d1fae5":"#fee2e2",border:"1px solid "+(de.imported>0?"#6ee7b7":"#fca5a5"),borderRadius:"0.5rem",padding:"1rem",marginBottom:"1rem"},children:[Qe.jsx("p",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:"Результаты импорта:"}),Qe.jsxs("ul",{style:{fontSize:"0.875rem",marginLeft:"1rem"},children:[Qe.jsxs("li",{children:["✅ Импортировано: ",de.imported]}),Qe.jsxs("li",{children:["⚠️ Пропущено: ",de.skipped]}),de.errors&&de.errors.length>0&&Qe.jsxs("li",{style:{color:"#991b1b",marginTop:"0.5rem"},children:["Ошибки: ",de.errors.slice(0,3).join("; ")]})]})]})]}),Qe.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e5e7eb",display:"flex",gap:"0.75rem"},children:[Qe.jsx("button",{onClick:()=>{ae(!1),oe(null),ce(null)},disabled:ne,style:{flex:1,padding:"0.75rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontWeight:"500",color:"#374151",cursor:"pointer"},children:de?"Закрыть":"Отмена"}),!de&&Qe.jsx("button",{onClick:async()=>{if(le)try{ie(!0);const e=await yo.importBookings(le);ce(e),e.imported>0&&(gt.success(`✅ Импортировано ${e.imported} записей`),await ye()),e.skipped>0&&gt.warning(`⚠️ Пропущено ${e.skipped} записей`)}catch(jx){gt.error(`❌ Ошибка импорта: ${jx.message}`)}finally{ie(!1)}else gt.error("Выберите файл для импорта")},disabled:ne||!le,style:{flex:1,padding:"0.75rem",backgroundColor:"#10b981",border:"none",borderRadius:"0.5rem",color:"#fff",fontWeight:"500",cursor:ne||!le?"not-allowed":"pointer",opacity:ne||!le?.5:1},children:ne?"Импортирование...":"Импортировать"})]})]})}),K&&Qe.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",width:"100%",maxWidth:"400px",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[Qe.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#111"},children:"Экспорт записей"}),Qe.jsx("button",{onClick:()=>J(!1),style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.5rem"},children:"×"})]}),Qe.jsxs("div",{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Период экспорта"}),Qe.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginBottom:"0.75rem"},children:"Оставьте пустым для экспорта всех записей"})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Дата с"}),Qe.jsx("input",{type:"date",value:Q,onChange:e=>ee(e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Дата по"}),Qe.jsx("input",{type:"date",value:te,onChange:e=>se(e.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{style:{paddingTop:"1rem",borderTop:"1px solid #e5e7eb"},children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.75rem"},children:"Формат файла"}),Qe.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[Qe.jsx("button",{onClick:()=>ke("csv"),disabled:G,style:{flex:1,padding:"0.75rem",backgroundColor:"#2563eb",color:"#fff",border:"none",borderRadius:"0.5rem",fontWeight:"500",cursor:G?"not-allowed":"pointer",opacity:G?.5:1},children:"CSV"}),Qe.jsx("button",{onClick:()=>ke("pdf"),disabled:G,style:{flex:1,padding:"0.75rem",backgroundColor:"#2563eb",color:"#fff",border:"none",borderRadius:"0.5rem",fontWeight:"500",cursor:G?"not-allowed":"pointer",opacity:G?.5:1},children:"PDF"}),Qe.jsx("button",{onClick:()=>ke("excel"),disabled:G,style:{flex:1,padding:"0.75rem",backgroundColor:"#2563eb",color:"#fff",border:"none",borderRadius:"0.5rem",fontWeight:"500",cursor:G?"not-allowed":"pointer",opacity:G?.5:1},children:"Excel"})]})]})]}),Qe.jsx("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end"},children:Qe.jsx("button",{onClick:()=>J(!1),disabled:G,style:{padding:"0.75rem 1.5rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontWeight:"500",color:"#374151",cursor:"pointer"},children:"Отмена"})})]})}),N&&Qe.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",width:"100%",maxWidth:"600px",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[Qe.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#111"},children:"Добавить запись"}),Qe.jsx("button",{onClick:()=>{k(!1),je()},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.5rem"},children:"×"})]}),Qe.jsxs("div",{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[Qe.jsxs("div",{style:{position:"relative"},children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Клиент *"}),Qe.jsx("input",{type:"text",placeholder:"Поиск клиента...",value:_,onChange:e=>{T(e.target.value),I(!0)},onFocus:()=>I(!0),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}}),L&&Qe.jsxs("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#f3f4f6",borderRadius:"0.5rem",fontSize:"0.875rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsx("span",{children:L.display_name}),Qe.jsx("button",{onClick:()=>{P(null),T("")},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280"},children:"×"})]}),D&&_&&!L&&Qe.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"#fff",border:"1px solid #d1d5db",borderRadius:"0.5rem",marginTop:"0.25rem",maxHeight:"200px",overflowY:"auto",zIndex:10,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:ve.length>0?ve.map(e=>Qe.jsxs("div",{onClick:()=>{P(e),T(""),I(!1),X({...Y,phone:e.phone||""})},style:{padding:"0.75rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6",fontSize:"0.875rem"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#fff",children:[e.display_name," ",e.phone&&`(${e.phone})`]},e.instagram_id)):Qe.jsx("div",{style:{padding:"0.75rem",fontSize:"0.875rem",color:"#6b7280"},children:"Клиенты не найдены"})})]}),Qe.jsxs("div",{style:{position:"relative"},children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Услуга *"}),Qe.jsx("input",{type:"text",placeholder:"Поиск услуги...",value:M,onChange:e=>{A(e.target.value),W(!0)},onFocus:()=>W(!0),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}}),H&&Qe.jsxs("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#f3f4f6",borderRadius:"0.5rem",fontSize:"0.875rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsxs("span",{children:[H.name_ru," (",H.price," AED)"]}),Qe.jsx("button",{onClick:()=>{V(null),A("")},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280"},children:"×"})]}),O&&M&&!H&&Qe.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"#fff",border:"1px solid #d1d5db",borderRadius:"0.5rem",marginTop:"0.25rem",maxHeight:"200px",overflowY:"auto",zIndex:10,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:we.length>0?we.map(e=>Qe.jsxs("div",{onClick:()=>{V(e),A(""),W(!1),X({...Y,revenue:e.price})},style:{padding:"0.75rem",cursor:"pointer",borderBottom:"1px solid #f3f4f6",fontSize:"0.875rem"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#fff",children:[e.name_ru," - ",e.price," AED"]},e.id)):Qe.jsx("div",{style:{padding:"0.75rem",fontSize:"0.875rem",color:"#6b7280"},children:"Услуги не найдены"})})]}),Qe.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Дата *"}),Qe.jsx("input",{type:"date",value:Y.date,onChange:e=>X({...Y,date:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Время *"}),Qe.jsx("input",{type:"time",value:Y.time,onChange:e=>X({...Y,time:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}})]})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Телефон"}),Qe.jsx("input",{type:"tel",placeholder:"+971 XX XXX XXXX",value:Y.phone,onChange:e=>X({...Y,phone:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.875rem",boxSizing:"border-box"}})]})]}),Qe.jsxs("div",{style:{padding:"1rem 1.5rem",borderTop:"1px solid #e5e7eb",display:"flex",gap:"0.75rem"},children:[Qe.jsx("button",{onClick:()=>{k(!1),je()},disabled:S,style:{flex:1,padding:"0.75rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontWeight:"500",color:"#374151",cursor:"pointer"},children:"Отмена"}),Qe.jsx("button",{onClick:async()=>{if(L&&H&&Y.date&&Y.time)try{C(!0),await yo.createBooking({instagram_id:L.instagram_id,name:L.display_name,phone:Y.phone||L.phone||"",service:H.name_ru,date:Y.date,time:Y.time,revenue:Y.revenue||H.price}),gt.success("Запись создана ✅"),k(!1),je(),await ye()}catch(jx){gt.error(`❌ Ошибка: ${jx.message}`)}finally{C(!1)}else gt.error("Заполните все обязательные поля (клиент, услуга, дата, время)")},disabled:S,style:{flex:1,padding:"0.75rem",backgroundColor:"#ec4899",border:"none",borderRadius:"0.5rem",color:"#fff",fontWeight:"500",cursor:S?"not-allowed":"pointer",opacity:S?.5:1},children:S?"Создание...":"Создать запись"})]})]})}),Qe.jsx("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n      "})]})}const vo="https://mlediamant.com";async function wo(e,t={}){const s=`${vo}${e}`;!t.body||t.body instanceof FormData||(t.body=JSON.stringify(t.body));const r={credentials:"include",headers:{"Content-Type":"application/json"},...t},a=await fetch(s,r);if(!a.ok){const e=await a.json().catch(()=>({error:"Unknown error"}));throw new Error(e.error||e.message||"API Error")}return a.json()}const No=()=>wo("/api/bookings"),ko=(e,t)=>wo(`/api/bookings/${e}/status`,{method:"POST",body:{status:t}}),So=()=>wo("/public/salon-info"),Co=()=>wo("/public/services"),_o=()=>wo("/api/employees?active_only=true");function zo(){const{id:e}=c(),t=i(),[r,a]=s.useState(null),[n,l]=s.useState(!0),[o,d]=s.useState(!1),[m,x]=s.useState("");s.useEffect(()=>{u()},[e]);const u=async()=>{try{l(!0);const s=(await No()).bookings.find(t=>t.id===parseInt(e));s?(a(s),x(s.status)):(gt.error("Запись не найдена"),t("/admin/bookings"))}catch(jx){gt.error("Ошибка загрузки записи")}finally{l(!1)}};if(n)return Qe.jsx("div",{className:"p-8 flex items-center justify-center",children:Qe.jsxs("div",{className:"text-center",children:[Qe.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full animate-spin mx-auto"}),Qe.jsx("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})});if(!r)return Qe.jsx("div",{className:"p-8",children:Qe.jsxs("div",{className:"text-center",children:[Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Запись не найдена"}),Qe.jsx(Ys,{onClick:()=>t("/admin/bookings"),children:"← Вернуться к записям"})]})});const h=e=>{try{return new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}};return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[Qe.jsx("button",{onClick:()=>t("/admin/bookings"),className:"p-2 hover:bg-gray-100 rounded-lg",children:Qe.jsx(H,{className:"w-6 h-6"})}),Qe.jsxs("div",{children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-1",children:["Запись #",r.id]}),Qe.jsx("p",{className:"text-gray-600",children:"Детальная информация"})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[Qe.jsx("div",{className:"lg:col-span-2",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Информация о записи"}),Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(V,{className:"w-6 h-6 text-pink-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Клиент"}),Qe.jsx("p",{className:"text-lg text-gray-900 font-medium",children:r.name}),Qe.jsx("button",{onClick:()=>t(`/admin/clients/${r.client_id}`),className:"text-sm text-pink-600 hover:underline mt-1",children:"Профиль клиента →"})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(Y,{className:"w-6 h-6 text-purple-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Услуга"}),Qe.jsx("p",{className:"text-lg text-gray-900 font-medium",children:r.service})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(R,{className:"w-6 h-6 text-blue-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Дата и время"}),Qe.jsx("p",{className:"text-lg text-gray-900 font-medium",children:h(r.datetime)})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(X,{className:"w-6 h-6 text-green-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Телефон"}),Qe.jsx("p",{className:"text-lg text-gray-900 font-medium",children:r.phone})]})]}),r.revenue>0&&Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(Y,{className:"w-6 h-6 text-yellow-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Сумма"}),Qe.jsxs("p",{className:"text-lg text-gray-900 font-medium",children:[r.revenue," AED"]})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(K,{className:"w-6 h-6 text-gray-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Создана"}),Qe.jsx("p",{className:"text-lg text-gray-900 font-medium",children:h(r.created_at)})]})]})]})]})}),Qe.jsxs("div",{children:[Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsxs("h3",{className:"text-lg text-gray-900 mb-4 flex items-center gap-2",children:[Qe.jsx(J,{className:"w-5 h-5"}),"Статус записи"]}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs(to,{value:m,onValueChange:x,children:[Qe.jsx(ro,{children:Qe.jsx(so,{})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"new",children:"Новая"}),Qe.jsx(no,{value:"confirmed",children:"Подтверждена"}),Qe.jsx(no,{value:"completed",children:"Завершена"}),Qe.jsx(no,{value:"cancelled",children:"Отменена"})]})]}),Qe.jsx(Ys,{onClick:async()=>{if(r&&m)try{d(!0),await ko(r.id,m),gt.success("Статус обновлён ✅"),a({...r,status:m})}catch(jx){gt.error("Ошибка обновления статуса")}finally{d(!1)}},disabled:o||m===r.status,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600",children:o?"Обновление...":"Обновить статус"}),Qe.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[Qe.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Текущий статус"}),Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx("div",{className:"w-3 h-3 rounded-full "+("completed"===r.status?"bg-green-500":"cancelled"===r.status?"bg-red-500":"confirmed"===r.status?"bg-blue-500":"bg-yellow-500")}),Qe.jsx("span",{className:"text-sm text-gray-900 font-medium capitalize",children:"new"===r.status?"Новая":"confirmed"===r.status?"Подтверждена":"completed"===r.status?"Завершена":"Отменена"})]})]})]})]}),Qe.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"Действия"}),Qe.jsx(Ys,{onClick:()=>t(`/admin/chat?client_id=${r.client_id}`),variant:"outline",className:"w-full",children:"💬 Написать клиенту"})]})]})]})]})}const Eo=({cx:e,cy:t,midAngle:s,innerRadius:r,outerRadius:a,percent:n})=>{const i=Math.PI/180,l=r+.5*(a-r),o=e+l*Math.cos(-s*i),d=t+l*Math.sin(-s*i);return n<.05?null:Qe.jsxs("text",{x:o,y:d,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontSize:14,fontWeight:"bold",children:[(100*n).toFixed(0),"%"]})};function Ro(){const[e,t]=s.useState("30"),[r,a]=s.useState([]),[n,i]=s.useState(""),[l,o]=s.useState(""),[d,c]=s.useState(!1),[m,x]=s.useState(!0),[u,h]=s.useState(!1),[p,g]=s.useState(null),[f,b]=s.useState(null),[y,j]=s.useState(null);s.useEffect(()=>{"custom"!==e&&w()},[e]);const w=async()=>{try{x(!0),j(null);const t=await Ct.getStats();let s;if(g(t),n&&l)s=await Ct.getAnalytics(0,n,l);else{const t=parseInt(e);if(isNaN(t))throw new Error("Некорректный период");s=await Ct.getAnalytics(t)}b(s)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки";j(t),gt.error(`Ошибка загрузки аналитики: ${t}`)}finally{x(!1)}};if(y)return Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки аналитики"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:y}),Qe.jsx(Ys,{onClick:w,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})});if(m)return Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка аналитики..."})]})});const N=f?.bookings_by_day?.map(([e,t])=>({name:new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"short"}),"записи":t}))||[],k=f?.services_stats?.map(([e,t,s])=>({name:e,value:t,revenue:s,color:`hsl(${360*Math.random()}, 70%, 60%)`}))||[],S=f?.status_stats?.map(([e,t])=>({name:"pending"===e?"Ожидает":"completed"===e?"Завершена":"cancelled"===e?"Отменена":"Подтверждена","записи":t}))||[],C=f?.services_stats?.slice(0,5).map(([e,t,s])=>({name:e,count:t,revenue:s}))||[];return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(v,{className:"w-8 h-8 text-pink-600"}),"Аналитика и отчеты"]}),Qe.jsx("p",{className:"text-gray-600",children:"Детальный анализ работы салона"})]}),Qe.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6",children:Qe.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 flex-wrap items-stretch sm:items-end",children:[Qe.jsx(co,{period:e,dateFrom:n,dateTo:l,onPeriodChange:e=>{t(e),c("custom"===e),"custom"!==e&&(i(""),o(""),setTimeout(()=>w(),0))},onDateFromChange:i,onDateToChange:o,showAllOption:!1}),"custom"===e&&Qe.jsx(Ys,{onClick:()=>{n&&l?n>l?gt.error("Дата начала должна быть раньше даты конца"):w():gt.error("Выберите обе даты")},className:"bg-pink-600 hover:bg-pink-700 w-full sm:w-auto",children:"Применить"}),Qe.jsxs(Ys,{variant:"outline",onClick:w,className:"md:ml-auto",children:[Qe.jsx(F,{className:"w-4 h-4 mr-2"}),"Обновить"]}),Qe.jsxs(Ys,{onClick:async()=>{try{h(!0);const t=await Ct.exportAnalytics("csv",parseInt(e)),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`analytics_${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),gt.success("Файл успешно скачан")}catch(jx){gt.error("Ошибка при экспорте файла")}finally{h(!1)}},disabled:u,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 gap-2",children:[Qe.jsx(A,{className:"w-4 h-4"}),u?"Экспорт...":"Экспортировать"]})]})}),p&&Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsxs("h3",{className:"text-3xl text-gray-900 mb-2",children:[p.conversion_rate.toFixed(1),"%"]}),Qe.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Конверсия"}),Qe.jsx("div",{className:"text-sm text-green-600",children:"От посетителей к клиентам"})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsxs("h3",{className:"text-3xl text-gray-900 mb-2",children:[f?.avg_response_time.toFixed(0)||0," мин"]}),Qe.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Время ответа"}),Qe.jsx("div",{className:"text-sm text-blue-600",children:"Среднее время"})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsxs("h3",{className:"text-3xl text-gray-900 mb-2",children:[p.total_revenue.toLocaleString()," AED"]}),Qe.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Доход"}),Qe.jsx("div",{className:"text-sm text-green-600",children:"За период"})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsxs("h3",{className:"text-3xl text-gray-900 mb-2",children:[p.total_revenue>0?(p.total_revenue/p.total_bookings).toFixed(0):0," AED"]}),Qe.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Средний чек"}),Qe.jsx("div",{className:"text-sm text-green-600",children:"На запись"})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[N.length>0&&Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6",children:"Динамика записей"}),Qe.jsx(Pe,{width:"100%",height:300,children:Qe.jsxs(Me,{data:N,children:[Qe.jsx(Ae,{strokeDasharray:"3 3"}),Qe.jsx(Oe,{dataKey:"name"}),Qe.jsx(We,{}),Qe.jsx(Be,{}),Qe.jsx(Fe,{}),Qe.jsx($e,{type:"monotone",dataKey:"записи",stroke:"#ec4899",strokeWidth:2,dot:{fill:"#ec4899"}})]})})]}),k.length>0&&Qe.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("h2",{className:"text-lg sm:text-xl text-gray-900 mb-4 sm:mb-6",children:"Распределение услуг"}),Qe.jsx(Pe,{width:"100%",height:window.innerWidth<432?350:450,children:Qe.jsxs(Ue,{children:[Qe.jsx(qe,{data:k,dataKey:"value",nameKey:"name",cx:"50%",cy:window.innerWidth<432?"40%":"45%",outerRadius:window.innerWidth<432?70:100,label:window.innerWidth<432?void 0:Eo,children:k.map((e,t)=>Qe.jsx(He,{fill:e.color},`cell-${t}`))}),Qe.jsx(Be,{}),window.innerWidth<1004&&Qe.jsx("div",{className:"mt-4 space-y-2 px-2",children:k.map((e,t)=>Qe.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[Qe.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),Qe.jsx("span",{className:"truncate flex-1",children:e.name}),Qe.jsx("span",{className:"text-gray-700 font-semibold flex-shrink-0 ml-2",children:e.value})]},t))})]})}),window.innerWidth<1004&&Qe.jsx("div",{className:"mt-4 space-y-2 px-2",children:k.map((e,t)=>Qe.jsxs("div",{className:"flex items-center justify-between gap-3 text-xs",children:[Qe.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[Qe.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),Qe.jsx("span",{className:"truncate",children:e.name})]}),Qe.jsx("span",{className:"text-gray-700 font-semibold flex-shrink-0",children:e.value})]},t))})]}),S.length>0&&Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6",children:"Статусы записей"}),Qe.jsx(Pe,{width:"100%",height:300,children:Qe.jsxs(Ve,{data:S,children:[Qe.jsx(Ae,{strokeDasharray:"3 3"}),Qe.jsx(Oe,{dataKey:"name"}),Qe.jsx(We,{}),Qe.jsx(Be,{}),Qe.jsx(Fe,{}),Qe.jsx(Ye,{dataKey:"записи",fill:"#8b5cf6"})]})})]})]}),C.length>0&&Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[Qe.jsx("div",{className:"p-6 border-b border-gray-200",children:Qe.jsx("h2",{className:"text-xl text-gray-900",children:"Топ услуг"})}),Qe.jsx("div",{className:"overflow-x-auto",children:Qe.jsxs("table",{className:"w-full",children:[Qe.jsx("thead",{className:"bg-gray-50",children:Qe.jsxs("tr",{children:[Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Название"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Количество"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Доход"})]})}),Qe.jsx("tbody",{className:"divide-y divide-gray-200",children:C.map((e,t)=>Qe.jsxs("tr",{className:"hover:bg-gray-50",children:[Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.name}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:e.count}),Qe.jsxs("td",{className:"px-6 py-4 text-sm text-green-600",children:["number"==typeof e.revenue?e.revenue.toLocaleString():0," AED"]})]},t))})]})})]})]})}const To=Ot("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Do({className:e,variant:t,asChild:s=!1,...r}){const a=s?Dt:"span";return Qe.jsx(a,{"data-slot":"badge",className:Hs(To({variant:t}),e),...r})}var Io=e=>{const{present:t,children:r}=e,a=function(e){const[t,r]=s.useState(),a=s.useRef(null),n=s.useRef(e),i=s.useRef("none"),l=e?"mounted":"unmounted",[o,d]=function(e,t){return s.useReducer((e,s)=>t[e][s]??e,e)}(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const e=Lo(a.current);i.current="mounted"===o?e:"none"},[o]),Sr(()=>{const t=a.current,s=n.current;if(s!==e){const r=i.current,a=Lo(t);if(e)d("MOUNT");else if("none"===a||"none"===t?.display)d("UNMOUNT");else{d(s&&r!==a?"ANIMATION_OUT":"UNMOUNT")}n.current=e}},[e,d]),Sr(()=>{if(t){let e;const s=t.ownerDocument.defaultView??window,r=r=>{const i=Lo(a.current).includes(CSS.escape(r.animationName));if(r.target===t&&i&&(d("ANIMATION_END"),!n.current)){const r=t.style.animationFillMode;t.style.animationFillMode="forwards",e=s.setTimeout(()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=r)})}},l=e=>{e.target===t&&(i.current=Lo(a.current))};return t.addEventListener("animationstart",l),t.addEventListener("animationcancel",r),t.addEventListener("animationend",r),()=>{s.clearTimeout(e),t.removeEventListener("animationstart",l),t.removeEventListener("animationcancel",r),t.removeEventListener("animationend",r)}}d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:s.useCallback(e=>{a.current=e?getComputedStyle(e):null,r(e)},[])}}(t),n="function"==typeof r?r({present:a.isPresent}):s.Children.only(r),i=Rt(a.ref,function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning;if(s)return e.ref;if(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning,s)return e.props.ref;return e.props.ref||e.ref}(n));return"function"==typeof r||a.isPresent?s.cloneElement(n,{ref:i}):null};function Lo(e){return e?.animationName||"none"}Io.displayName="Presence";var Po="Dialog",[Mo]=Gs(Po),[Ao,Oo]=Mo(Po),Wo=e=>{const{__scopeDialog:t,children:r,open:a,defaultOpen:n,onOpenChange:i,modal:l=!0}=e,o=s.useRef(null),d=s.useRef(null),[c,m]=Vn({prop:a,defaultProp:n??!1,onChange:i,caller:Po});return Qe.jsx(Ao,{scope:t,triggerRef:o,contentRef:d,contentId:zr(),titleId:zr(),descriptionId:zr(),open:c,onOpenChange:m,onOpenToggle:s.useCallback(()=>m(e=>!e),[m]),modal:l,children:r})};Wo.displayName=Po;var Bo="DialogTrigger";s.forwardRef((e,t)=>{const{__scopeDialog:s,...r}=e,a=Oo(Bo,s),n=Rt(t,a.triggerRef);return Qe.jsx(sr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":nd(a.open),...r,ref:n,onClick:Js(e.onClick,a.onOpenToggle)})}).displayName=Bo;var Fo="DialogPortal",[$o,Uo]=Mo(Fo,{forceMount:void 0}),qo=e=>{const{__scopeDialog:t,forceMount:r,children:a,container:n}=e,i=Oo(Fo,t);return Qe.jsx($o,{scope:t,forceMount:r,children:s.Children.map(a,e=>Qe.jsx(Io,{present:r||i.open,children:Qe.jsx(qn,{asChild:!0,container:n,children:e})}))})};qo.displayName=Fo;var Ho="DialogOverlay",Vo=s.forwardRef((e,t)=>{const s=Uo(Ho,e.__scopeDialog),{forceMount:r=s.forceMount,...a}=e,n=Oo(Ho,e.__scopeDialog);return n.modal?Qe.jsx(Io,{present:r||n.open,children:Qe.jsx(Xo,{...a,ref:t})}):null});Vo.displayName=Ho;var Yo=Tt("DialogOverlay.RemoveScroll"),Xo=s.forwardRef((e,t)=>{const{__scopeDialog:s,...r}=e,a=Oo(Ho,s);return Qe.jsx($i,{as:Yo,allowPinchZoom:!0,shards:[a.contentRef],children:Qe.jsx(sr.div,{"data-state":nd(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Ko="DialogContent",Jo=s.forwardRef((e,t)=>{const s=Uo(Ko,e.__scopeDialog),{forceMount:r=s.forceMount,...a}=e,n=Oo(Ko,e.__scopeDialog);return Qe.jsx(Io,{present:r||n.open,children:n.modal?Qe.jsx(Go,{...a,ref:t}):Qe.jsx(Zo,{...a,ref:t})})});Jo.displayName=Ko;var Go=s.forwardRef((e,t)=>{const r=Oo(Ko,e.__scopeDialog),a=s.useRef(null),n=Rt(t,r.contentRef,a);return s.useEffect(()=>{const e=a.current;if(e)return ti(e)},[]),Qe.jsx(Qo,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Js(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Js(e.onPointerDownOutside,e=>{const t=e.detail.originalEvent,s=0===t.button&&!0===t.ctrlKey;(2===t.button||s)&&e.preventDefault()}),onFocusOutside:Js(e.onFocusOutside,e=>e.preventDefault())})}),Zo=s.forwardRef((e,t)=>{const r=Oo(Ko,e.__scopeDialog),a=s.useRef(!1),n=s.useRef(!1);return Qe.jsx(Qo,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(a.current||r.triggerRef.current?.focus(),t.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(n.current=!0));const s=t.target,i=r.triggerRef.current?.contains(s);i&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&n.current&&t.preventDefault()}})}),Qo=s.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:i,...l}=e,o=Oo(Ko,r),d=s.useRef(null),c=Rt(t,d);return ur(),Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(br,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:i,children:Qe.jsx(dr,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":nd(o.open),...l,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(dd,{titleId:o.titleId}),Qe.jsx(cd,{contentRef:d,descriptionId:o.descriptionId})]})]})}),ed="DialogTitle",td=s.forwardRef((e,t)=>{const{__scopeDialog:s,...r}=e,a=Oo(ed,s);return Qe.jsx(sr.h2,{id:a.titleId,...r,ref:t})});td.displayName=ed;var sd="DialogDescription";s.forwardRef((e,t)=>{const{__scopeDialog:s,...r}=e,a=Oo(sd,s);return Qe.jsx(sr.p,{id:a.descriptionId,...r,ref:t})}).displayName=sd;var rd="DialogClose",ad=s.forwardRef((e,t)=>{const{__scopeDialog:s,...r}=e,a=Oo(rd,s);return Qe.jsx(sr.button,{type:"button",...r,ref:t,onClick:Js(e.onClick,()=>a.onOpenChange(!1))})});function nd(e){return e?"open":"closed"}ad.displayName=rd;var id="DialogTitleWarning",[ld,od]=function(e,t){const r=s.createContext(t),a=e=>{const{children:t,...a}=e,n=s.useMemo(()=>a,Object.values(a));return Qe.jsx(r.Provider,{value:n,children:t})};return a.displayName=e+"Provider",[a,function(a){const n=s.useContext(r);if(n)return n;if(void 0!==t)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}]}(id,{contentName:Ko,titleName:ed,docsSlug:"dialog"}),dd=({titleId:e})=>{const t=od(id),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.\n\nIf you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return s.useEffect(()=>{if(e){document.getElementById(e)}},[r,e]),null},cd=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${od("DialogDescriptionWarning").contentName}}.`;return s.useEffect(()=>{const s=e.current?.getAttribute("aria-describedby");if(t&&s){document.getElementById(t)}},[r,e,t]),null},md=Wo,xd=qo,ud=Vo,hd=Jo,pd=td,gd=ad;function fd({...e}){return Qe.jsx(md,{"data-slot":"dialog",...e})}function bd({...e}){return Qe.jsx(xd,{"data-slot":"dialog-portal",...e})}function yd({className:e,...t}){return Qe.jsx(ud,{"data-slot":"dialog-overlay",className:Hs("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function jd({className:e,children:t,...s}){return Qe.jsxs(bd,{"data-slot":"dialog-portal",children:[Qe.jsx(yd,{}),Qe.jsxs(hd,{"data-slot":"dialog-content",className:Hs("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...s,children:[t,Qe.jsxs(gd,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[Qe.jsx(g,{}),Qe.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function vd({className:e,...t}){return Qe.jsx("div",{"data-slot":"dialog-header",className:Hs("flex flex-col gap-2 text-center sm:text-left",e),...t})}function wd({className:e,...t}){return Qe.jsx("div",{"data-slot":"dialog-footer",className:Hs("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function Nd({className:e,...t}){return Qe.jsx(pd,{"data-slot":"dialog-title",className:Hs("text-lg leading-none font-semibold",e),...t})}var kd=s.forwardRef((e,t)=>Qe.jsx(sr.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));kd.displayName="Label";var Sd=kd;function Cd({className:e,...t}){return Qe.jsx(Sd,{"data-slot":"label",className:Hs("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function _d({className:e,...t}){return Qe.jsx("textarea",{"data-slot":"textarea",className:Hs("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const zd=["Permanent Makeup","Facial","Massage","Nails","Hair","Lashes","Brows","Waxing"],Ed=e=>{const t=e.min_price&&"null"!==e.min_price?Number(e.min_price):null,s=e.max_price&&"null"!==e.max_price?Number(e.max_price):null;return t&&s&&t!==s?`${t} — ${s} ${e.currency}`:`${e.price} ${e.currency}`};function Rd(){const[e,t]=s.useState("services"),[r,a]=s.useState([]),[n,i]=s.useState([]),[l,o]=s.useState(""),[d,c]=s.useState("all"),[m,x]=s.useState(!1),[u,h]=s.useState(null),[p,g]=s.useState([]),[f,b]=s.useState([]),[y,j]=s.useState(""),[v,N]=s.useState("all"),[k,S]=s.useState(!1),[C,_]=s.useState(null),[T,D]=s.useState(!0),[I,L]=s.useState(null),[P,M]=s.useState(!1),[A,O]=s.useState({key:"",name:"",name_ru:"",price:0,min_price:"",max_price:"",duration:"",currency:"AED",category:"",description:"",description_ru:"",benefits:""}),[W,F]=s.useState({name:"",name_ru:"",description:"",description_ru:"",original_price:0,special_price:0,currency:"AED",services_included:"",promo_code:"",keywords:"",valid_from:"",valid_until:"",is_active:!0,max_usage:0});s.useEffect(()=>{U()},[e]),s.useEffect(()=>{if("services"===e){const e=r.filter(e=>{const t=e.name.toLowerCase().includes(l.toLowerCase())||e.name_ru.toLowerCase().includes(l.toLowerCase()),s="all"===d||e.category===d;return t&&s});i(e)}else{const e=p.filter(e=>{const t=e.name.toLowerCase().includes(y.toLowerCase())||e.name_ru.toLowerCase().includes(y.toLowerCase())||e.promo_code?.toLowerCase().includes(y.toLowerCase()),s="all"===v||"active"===v&&e.is_active||"inactive"===v&&!e.is_active;return t&&s});b(e)}},[l,d,y,v,r,p,e]);const U=async()=>{try{if(D(!0),L(null),"services"===e){const e=await Ct.getServices(!1);a(e.services||[])}else{const e=await Ct.getSpecialPackages();g(e.packages||[])}}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки";L(t),gt.error(`Ошибка: ${t}`)}finally{D(!1)}},q=()=>{_(null),F({name:"",name_ru:"",description:"",description_ru:"",original_price:0,special_price:0,currency:"AED",services_included:"",promo_code:"",keywords:"",valid_from:"",valid_until:"",is_active:!0,max_usage:0}),S(!0)},H=()=>W.original_price>0&&W.special_price>0?Math.round((W.original_price-W.special_price)/W.original_price*100):0;return T?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка..."})]})}):Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(w,{className:"w-8 h-8 text-pink-600"}),"Услуги и спецпредложения"]}),Qe.jsx("p",{className:"text-gray-600",children:"Управление прайс-листом и акциями салона"})]}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6 p-1",children:Qe.jsxs("div",{className:"flex gap-2",children:[Qe.jsxs("button",{onClick:()=>t("services"),className:"flex-1 px-6 py-3 rounded-lg font-medium transition-all "+("services"===e?"bg-pink-100 text-pink-700":"text-gray-600 hover:bg-gray-50"),children:[Qe.jsx(w,{className:"w-5 h-5 inline-block mr-2"}),"Услуги (",n.length,")"]}),Qe.jsxs("button",{onClick:()=>t("packages"),className:"flex-1 px-6 py-3 rounded-lg font-medium transition-all "+("packages"===e?"bg-pink-100 text-pink-700":"text-gray-600 hover:bg-gray-50"),children:[Qe.jsx(G,{className:"w-5 h-5 inline-block mr-2"}),"Специальные пакеты (",f.length,")"]})]})}),"services"===e&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6",children:Qe.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[Qe.jsxs("div",{className:"flex-1 relative",children:[Qe.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{type:"text",placeholder:"Поиск услуг...",value:l,onChange:e=>o(e.target.value),className:"pl-10"})]}),Qe.jsxs(to,{value:d,onValueChange:c,children:[Qe.jsx(ro,{className:"w-full md:w-[200px]",children:Qe.jsx(so,{placeholder:"Категория"})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"all",children:"Все категории"}),zd.map(e=>Qe.jsx(no,{value:e,children:e},e))]})]}),Qe.jsxs(Ys,{className:"bg-pink-600 hover:bg-pink-700",onClick:()=>{h(null),O({key:"",name:"",name_ru:"",price:0,min_price:"",max_price:"",duration:"",currency:"AED",category:"",description:"",description_ru:"",benefits:""}),x(!0)},children:[Qe.jsx(B,{className:"w-4 h-4 mr-2"}),"Добавить услугу"]})]})}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:n.length>0?Qe.jsx("div",{className:"overflow-x-auto",children:Qe.jsxs("table",{className:"w-full",children:[Qe.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:Qe.jsxs("tr",{children:[Qe.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-600",children:"Название"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-600",children:"Цена"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-600",children:"Длительность"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-600",children:"Категория"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-600",children:"Статус"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-600",children:"Действия"})]})}),Qe.jsx("tbody",{className:"divide-y divide-gray-200",children:n.map(e=>Qe.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.name}),Qe.jsx("p",{className:"text-xs text-gray-500",children:e.name_ru})]})}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsx("div",{className:"text-sm font-semibold text-gray-900",children:Ed(e)})}),Qe.jsx("td",{className:"px-6 py-4",children:e.duration&&"null"!==e.duration?Qe.jsxs(Do,{className:"bg-blue-100 text-blue-800 flex items-center gap-1 w-fit",children:[Qe.jsx(K,{className:"w-3 h-3"}),e.duration]}):Qe.jsx("span",{className:"text-xs text-gray-400",children:"—"})}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsx(Do,{className:"bg-purple-100 text-purple-800",children:e.category})}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsx("button",{onClick:()=>(async e=>{try{const t=await fetch(`https://mlediamant.com/api/services/${e.id}/toggle-status`,{method:"POST",credentials:"include"});if(!t.ok)throw new Error("Toggle failed");const s=await t.json();a(r.map(t=>t.id===e.id?{...t,is_active:s.is_active}:t)),gt.success(s.is_active?"Услуга активирована":"Услуга деактивирована")}catch(jx){gt.error("Ошибка изменения статуса")}})(e),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors "+(e.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"),children:e.is_active?"Активна":"Неактивна"})}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>(e=>{h(e),O({key:e.key,name:e.name,name_ru:e.name_ru,price:e.price,min_price:e.min_price?.toString()||"",max_price:e.max_price?.toString()||"",duration:e.duration||"",currency:e.currency,category:e.category,description:e.description||"",description_ru:e.description_ru||"",benefits:Array.isArray(e.benefits)?e.benefits.join(" | "):""}),x(!0)})(e),children:Qe.jsx(Z,{className:"w-4 h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>(async e=>{if(confirm("Удалить эту услугу?"))try{await Ct.deleteService(e),a(r.filter(t=>t.id!==e)),gt.success("Услуга удалена")}catch(jx){gt.error(`Ошибка: ${jx instanceof Error?jx.message:"Неизвестная ошибка"}`)}})(e.id),children:Qe.jsx(Q,{className:"w-4 h-4"})})]})})]},e.id))})]})}):Qe.jsxs("div",{className:"py-20 text-center text-gray-500",children:[Qe.jsx(w,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qe.jsx("p",{children:"Услуги не найдены"})]})})]}),"packages"===e&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-blue-800 font-medium",children:"Как работают специальные пакеты:"}),Qe.jsxs("ul",{className:"text-blue-700 text-sm mt-2 space-y-1 list-disc list-inside",children:[Qe.jsx("li",{children:"Когда клиент упоминает ключевые слова или промокод, бот предложит специальную цену"}),Qe.jsx("li",{children:"Бот автоматически распознает контекст рекламной кампании"}),Qe.jsx("li",{children:"Пакеты можно ограничить по времени и количеству использований"})]})]})]})}),Qe.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6",children:Qe.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[Qe.jsxs("div",{className:"flex-1 relative",children:[Qe.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{type:"text",placeholder:"Поиск пакетов, промокодов...",value:y,onChange:e=>j(e.target.value),className:"pl-10"})]}),Qe.jsxs(to,{value:v,onValueChange:e=>N(e),children:[Qe.jsx(ro,{className:"w-full md:w-[200px]",children:Qe.jsx(so,{placeholder:"Статус"})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"all",children:"Все пакеты"}),Qe.jsx(no,{value:"active",children:"Активные"}),Qe.jsx(no,{value:"inactive",children:"Неактивные"})]})]}),Qe.jsxs(Ys,{className:"bg-pink-600 hover:bg-pink-700",onClick:q,children:[Qe.jsx(B,{className:"w-4 h-4 mr-2"}),"Создать пакет"]})]})}),Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(e=>Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[Qe.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:e.name_ru}),Qe.jsx("p",{className:"text-sm text-gray-500",children:e.name})]}),Qe.jsx(Do,{className:e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:e.is_active?"Активен":"Неактивен"})]}),e.promo_code&&Qe.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg px-3 py-2 mb-4 flex items-center gap-2",children:[Qe.jsx(ee,{className:"w-4 h-4 text-purple-600"}),Qe.jsx("span",{className:"text-purple-900 font-mono font-medium",children:e.promo_code})]}),Qe.jsxs("div",{className:"mb-4",children:[Qe.jsxs("div",{className:"flex items-baseline gap-2",children:[Qe.jsxs("span",{className:"text-2xl font-bold text-pink-600",children:[e.special_price," ",e.currency]}),Qe.jsxs("span",{className:"text-lg text-gray-400 line-through",children:[e.original_price," ",e.currency]})]}),Qe.jsxs("div",{className:"text-sm text-green-600 font-medium",children:["Скидка ",e.discount_percent,"%"]})]}),Qe.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.description_ru||e.description}),e.keywords.length>0&&Qe.jsxs("div",{className:"mb-4",children:[Qe.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Ключевые слова:"}),Qe.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.keywords.slice(0,3).map((e,t)=>Qe.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:e},t)),e.keywords.length>3&&Qe.jsxs("span",{className:"text-xs text-gray-500",children:["+",e.keywords.length-3]})]})]}),Qe.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-4",children:[Qe.jsx(R,{className:"w-4 h-4"}),Qe.jsxs("span",{children:[new Date(e.valid_from).toLocaleDateString()," - ",new Date(e.valid_until).toLocaleDateString()]})]}),e.max_usage&&Qe.jsxs("div",{className:"text-xs text-gray-500 mb-4",children:["Использовано: ",e.usage_count," / ",e.max_usage]}),Qe.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-gray-100",children:[Qe.jsxs(Ys,{size:"sm",variant:"outline",onClick:()=>(e=>{_(e),F({name:e.name,name_ru:e.name_ru,description:e.description,description_ru:e.description_ru,original_price:e.original_price,special_price:e.special_price,currency:e.currency,services_included:e.services_included.join(", "),promo_code:e.promo_code||"",keywords:e.keywords.join(", "),valid_from:e.valid_from,valid_until:e.valid_until,is_active:e.is_active,max_usage:e.max_usage||0}),S(!0)})(e),className:"flex-1",children:[Qe.jsx(Z,{className:"w-4 h-4 mr-1"}),"Изменить"]}),Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>(async e=>{try{await Ct.updateSpecialPackage(e.id,{is_active:!e.is_active}),g(p.map(t=>t.id===e.id?{...t,is_active:!t.is_active}:t)),gt.success(e.is_active?"Пакет деактивирован":"Пакет активирован")}catch(jx){gt.error("Ошибка изменения статуса")}})(e),className:e.is_active?"text-orange-600":"text-green-600",children:e.is_active?"Отключить":"Включить"}),Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>(async e=>{if(confirm("Удалить этот пакет?"))try{await Ct.deleteSpecialPackage(e),g(p.filter(t=>t.id!==e)),gt.success("Пакет удален")}catch(jx){gt.error(`Ошибка: ${jx instanceof Error?jx.message:"Неизвестная ошибка"}`)}})(e.id),className:"text-red-600",children:Qe.jsx(Q,{className:"w-4 h-4"})})]})]},e.id))}),0===f.length&&Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 py-20 text-center",children:[Qe.jsx(G,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qe.jsx("p",{className:"text-gray-500 mb-4",children:"Специальные пакеты не найдены"}),Qe.jsx(Ys,{onClick:q,className:"bg-pink-600 hover:bg-pink-700",children:"Создать первый пакет"})]})]}),Qe.jsx(fd,{open:m,onOpenChange:x,children:Qe.jsxs(jd,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[Qe.jsx(vd,{children:Qe.jsx(Nd,{children:u?"Редактировать услугу":"Добавить услугу"})}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"key",children:"Ключ *"}),Qe.jsx(oo,{id:"key",value:A.key,onChange:e=>O({...A,key:e.target.value}),placeholder:"permanent_makeup_brows"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"category",children:"Категория *"}),Qe.jsxs(to,{value:A.category,onValueChange:e=>O({...A,category:e}),children:[Qe.jsx(ro,{children:Qe.jsx(so,{placeholder:"Выберите категорию"})}),Qe.jsx(ao,{children:zd.map(e=>Qe.jsx(no,{value:e,children:e},e))})]})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"name",children:"Название (EN) *"}),Qe.jsx(oo,{id:"name",value:A.name,onChange:e=>O({...A,name:e.target.value}),placeholder:"Permanent Makeup - Brows"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"nameRu",children:"Название (RU) *"}),Qe.jsx(oo,{id:"nameRu",value:A.name_ru,onChange:e=>O({...A,name_ru:e.target.value}),placeholder:"Перманентный макияж бровей"})]}),Qe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"price",children:"Базовая цена *"}),Qe.jsx(oo,{id:"price",type:"number",value:A.price,onChange:e=>O({...A,price:Number(e.target.value)})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"currency",children:"Валюта"}),Qe.jsxs(to,{value:A.currency,onValueChange:e=>O({...A,currency:e}),children:[Qe.jsx(ro,{children:Qe.jsx(so,{})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"AED",children:"AED"}),Qe.jsx(no,{value:"USD",children:"USD"})]})]})]})]}),Qe.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"minPrice",children:"Мин. цена"}),Qe.jsx(oo,{id:"minPrice",type:"number",value:A.min_price,onChange:e=>O({...A,min_price:e.target.value}),placeholder:"Опционально"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"maxPrice",children:"Макс. цена"}),Qe.jsx(oo,{id:"maxPrice",type:"number",value:A.max_price,onChange:e=>O({...A,max_price:e.target.value}),placeholder:"Опционально"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"duration",children:"Длительность"}),Qe.jsx(oo,{id:"duration",value:A.duration,onChange:e=>O({...A,duration:e.target.value}),placeholder:"1h, 30min"})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"description",children:"Описание (EN)"}),Qe.jsx(_d,{id:"description",value:A.description,onChange:e=>O({...A,description:e.target.value}),placeholder:"Professional brow tattooing"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"descriptionRu",children:"Описание (RU)"}),Qe.jsx(_d,{id:"descriptionRu",value:A.description_ru,onChange:e=>O({...A,description_ru:e.target.value}),placeholder:"Профессиональный татуаж бровей"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"benefits",children:"Преимущества (разделяйте через |)"}),Qe.jsx(_d,{id:"benefits",value:A.benefits,onChange:e=>O({...A,benefits:e.target.value}),placeholder:"Long-lasting | Natural look | Waterproof"})]})]}),Qe.jsxs(wd,{children:[Qe.jsx(Ys,{variant:"outline",onClick:()=>x(!1),children:"Отмена"}),Qe.jsx(Ys,{onClick:async()=>{try{if(!(A.key&&A.name&&A.name_ru&&A.category))return void gt.error("Заполните обязательные поля");M(!0);const e={key:A.key,name:A.name,name_ru:A.name_ru,price:A.price,min_price:A.min_price?Number(A.min_price):null,max_price:A.max_price?Number(A.max_price):null,duration:A.duration||null,currency:A.currency,category:A.category,description:A.description,description_ru:A.description_ru,benefits:A.benefits.split(" | ").filter(e=>e.trim())};u?(await Ct.updateService(u.id,e),gt.success("Услуга обновлена")):(await Ct.createService(e),gt.success("Услуга добавлена")),await U(),x(!1)}catch(jx){gt.error(`Ошибка: ${jx instanceof Error?jx.message:"Неизвестная ошибка"}`)}finally{M(!1)}},className:"bg-pink-600 hover:bg-pink-700",disabled:P,children:P?"Сохранение...":"Сохранить"})]})]})}),Qe.jsx(fd,{open:k,onOpenChange:S,children:Qe.jsxs(jd,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[Qe.jsx(vd,{children:Qe.jsx(Nd,{children:C?"Редактировать пакет":"Создать пакет"})}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"pkgName",children:"Название (EN) *"}),Qe.jsx(oo,{id:"pkgName",value:W.name,onChange:e=>F({...W,name:e.target.value}),placeholder:"Summer Special Package"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"pkgNameRu",children:"Название (RU) *"}),Qe.jsx(oo,{id:"pkgNameRu",value:W.name_ru,onChange:e=>F({...W,name_ru:e.target.value}),placeholder:"Летний специальный пакет"})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"pkgDescRu",children:"Описание (RU)"}),Qe.jsx(_d,{id:"pkgDescRu",value:W.description_ru,onChange:e=>F({...W,description_ru:e.target.value}),placeholder:"Включает маникюр + педикюр по специальной цене",rows:2})]}),Qe.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"origPrice",children:"Обычная цена *"}),Qe.jsx(oo,{id:"origPrice",type:"number",value:W.original_price,onChange:e=>F({...W,original_price:Number(e.target.value)})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"specPrice",children:"Специальная цена *"}),Qe.jsx(oo,{id:"specPrice",type:"number",value:W.special_price,onChange:e=>F({...W,special_price:Number(e.target.value)})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{children:"Скидка"}),Qe.jsxs("div",{className:"h-10 flex items-center text-2xl font-bold text-green-600",children:[H(),"%"]})]})]}),Qe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"promoCode",children:"Промокод"}),Qe.jsx(oo,{id:"promoCode",value:W.promo_code,onChange:e=>F({...W,promo_code:e.target.value.toUpperCase()}),placeholder:"SUMMER2025"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"maxUsage",children:"Макс. использований"}),Qe.jsx(oo,{id:"maxUsage",type:"number",value:W.max_usage,onChange:e=>F({...W,max_usage:Number(e.target.value)}),placeholder:"0 = без ограничений"})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"keywords",children:"Ключевые слова (через запятую) *"}),Qe.jsx(_d,{id:"keywords",value:W.keywords,onChange:e=>F({...W,keywords:e.target.value}),placeholder:"летняя акция, summer promo, маникюр педикюр вместе",rows:2}),Qe.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Когда клиент упоминает эти слова, бот предложит этот пакет"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"services",children:"Включенные услуги (ключи через запятую)"}),Qe.jsx(_d,{id:"services",value:W.services_included,onChange:e=>F({...W,services_included:e.target.value}),placeholder:"manicure_gelish, pedicure_gelish",rows:2})]}),Qe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"validFrom",children:"Действует с *"}),Qe.jsx(oo,{id:"validFrom",type:"date",value:W.valid_from,onChange:e=>F({...W,valid_from:e.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"validUntil",children:"Действует до *"}),Qe.jsx(oo,{id:"validUntil",type:"date",value:W.valid_until,onChange:e=>F({...W,valid_until:e.target.value})})]})]}),Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx("input",{type:"checkbox",id:"pkgActive",checked:W.is_active,onChange:e=>F({...W,is_active:e.target.checked}),className:"w-4 h-4 text-pink-600 rounded"}),Qe.jsx(Cd,{htmlFor:"pkgActive",className:"cursor-pointer",children:"Активен (доступен для клиентов)"})]})]}),Qe.jsxs(wd,{children:[Qe.jsx(Ys,{variant:"outline",onClick:()=>S(!1),children:"Отмена"}),Qe.jsx(Ys,{onClick:async()=>{try{if(!W.name||!W.name_ru)return void gt.error("Заполните название пакета");if(W.special_price>=W.original_price)return void gt.error("Специальная цена должна быть меньше обычной");M(!0);const e={name:W.name,name_ru:W.name_ru,description:W.description,description_ru:W.description_ru,original_price:W.original_price,special_price:W.special_price,currency:W.currency,discount_percent:H(),services_included:W.services_included.split(",").map(e=>e.trim()).filter(Boolean),promo_code:W.promo_code,keywords:W.keywords.split(",").map(e=>e.trim()).filter(Boolean),valid_from:W.valid_from,valid_until:W.valid_until,is_active:W.is_active,max_usage:W.max_usage||null};C?(await Ct.updateSpecialPackage(C.id,e),gt.success("Пакет обновлен")):(await Ct.createSpecialPackage(e),gt.success("Пакет создан")),await U(),S(!1)}catch(jx){gt.error(`Ошибка: ${jx instanceof Error?jx.message:"Неизвестная ошибка"}`)}finally{M(!1)}},className:"bg-pink-600 hover:bg-pink-700",disabled:P,children:P?"Сохранение...":"Сохранить"})]})]})})]})}function Td(){const e=i(),{statuses:t,addStatus:r}=bo(),[a,n]=s.useState([]),[l,o]=s.useState([]),[d,c]=s.useState(""),[m,x]=s.useState("all"),[u,h]=s.useState(!0),[p,f]=s.useState(null),[b,v]=s.useState(!1),[w,N]=s.useState(null),[k,S]=s.useState(!1),[C,_]=s.useState(!1),[R,T]=s.useState("all"),[D,I]=s.useState(""),[L,P]=s.useState(""),[M,U]=s.useState(!1),[H,V]=s.useState(null),[Y,X]=s.useState({name:"",phone:"",notes:""}),[K,G]=s.useState(!1),[Z,ee]=s.useState(!1),[se,re]=s.useState({name:"",phone:"",instagram_id:"",notes:""}),[ae,ne]=s.useState(!1),[ie,le]=s.useState(!1),[oe,de]=s.useState(null),[ce,me]=s.useState(!1);s.useEffect(()=>{ue()},[]);const xe=uo({items:a,period:R,dateFrom:D,dateTo:L,getItemDate:e=>e.last_contact});s.useEffect(()=>{const e=xe.filter(e=>{const t=(e.display_name||"").toLowerCase().includes(d.toLowerCase())||(e.phone||"").includes(d)||(e.username||"").toLowerCase().includes(d.toLowerCase())||(e.name||"").toLowerCase().includes(d.toLowerCase()),s="all"===m||e.status===m;return t&&s});o(e)},[d,m,xe]);const ue=async()=>{try{h(!0),f(null);const e=await Ct.getClients(),t=e.clients||(Array.isArray(e)?e:[]);n(t),0===t.length&&gt.info("Клиентов не найдено")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки клиентов";f(t),gt.error(`Ошибка: ${t}`)}finally{h(!1)}},he=async e=>{try{S(!0);const t=await Ct.exportFullData(e),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s;const a="excel"===e?"xlsx":e;r.download=`full_data_${(new Date).toISOString().split("T")[0]}.${a}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),gt.success(`Полный экспорт ${e.toUpperCase()} завершен`),_(!1)}catch(jx){gt.error("Ошибка при экспорте")}finally{S(!1)}},pe={total:a.length,vip:a.filter(e=>"vip"===e.status).length,new:a.filter(e=>"new"===e.status).length,active:a.filter(e=>e.total_messages>0).length};return u?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка клиентов..."})]})}):p?Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:p}),Qe.jsx(Ys,{onClick:ue,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})}):Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(y,{className:"w-8 h-8 text-pink-600"}),"База клиентов"]}),Qe.jsxs("p",{className:"text-gray-600",children:[l.length," клиентов"]})]}),Qe.jsxs(Ys,{onClick:async()=>{v(!0),await ue(),v(!1),gt.success("Данные обновлены")},disabled:b,variant:"outline",children:[Qe.jsx(F,{className:"w-4 h-4 mr-2 "+(b?"animate-spin":"")}),"Обновить"]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Всего клиентов"}),Qe.jsx("h3",{className:"text-3xl text-gray-900",children:pe.total})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"VIP клиентов"}),Qe.jsx("h3",{className:"text-3xl text-purple-600",children:pe.vip})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Новых клиентов"}),Qe.jsx("h3",{className:"text-3xl text-green-600",children:pe.new})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Активных"}),Qe.jsx("h3",{className:"text-3xl text-blue-600",children:pe.active})]})]}),Qe.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6",children:Qe.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[Qe.jsxs("div",{className:"flex-1 relative",children:[Qe.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{type:"text",placeholder:"Поиск по имени, телефону, Instagram...",value:d,onChange:e=>c(e.target.value),className:"pl-10"})]}),Qe.jsxs("select",{value:m,onChange:e=>x(e.target.value),className:"w-full md:w-[200px] px-3 py-2 border border-gray-300 rounded-lg text-sm",style:{paddingRight:"2.5rem",backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%236b7280' d='M4 6l4 4 4-4z'/%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"16px 16px",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[Qe.jsx("option",{value:"all",children:"Все статусы"}),Object.entries(t).map(([e,t])=>Qe.jsx("option",{value:e,children:t.label},e))]}),Qe.jsx(co,{period:R,dateFrom:D,dateTo:L,onPeriodChange:T,onDateFromChange:I,onDateToChange:P,showAllOption:!0}),"custom"===R&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(oo,{type:"date",value:D,onChange:e=>I(e.target.value),className:"w-full md:w-[180px]"}),Qe.jsx(oo,{type:"date",value:L,onChange:e=>P(e.target.value),className:"w-full md:w-[180px]"})]}),Qe.jsxs(Ys,{className:"bg-pink-600 hover:bg-pink-700",onClick:()=>ee(!0),children:[Qe.jsx(B,{className:"w-4 h-4 mr-2"}),"Добавить клиента"]}),Qe.jsxs("div",{className:"flex gap-2",children:[Qe.jsx(xo,{onExport:async e=>{try{S(!0);const t=await Ct.exportClients(e),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s;const a="excel"===e?"xlsx":e;r.download=`clients_${(new Date).toISOString().split("T")[0]}.${a}`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),gt.success(`Файл ${e.toUpperCase()} успешно скачан`),me(!1)}catch(jx){gt.error("Ошибка при экспорте")}finally{S(!1)}},loading:k,disabled:k}),Qe.jsxs(Ys,{variant:"outline",onClick:()=>_(!0),disabled:k,className:"border-green-600 text-green-600 hover:bg-green-50",children:[Qe.jsx(A,{className:"w-4 h-4 mr-2"}),"Полный экспорт"]})]})]})}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:l.length>0?Qe.jsx("div",{className:"overflow-x-auto",children:Qe.jsxs("table",{className:"w-full",children:[Qe.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:Qe.jsxs("tr",{children:[Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Клиент"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Контакты"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Сообщений"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"LTV"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Последний контакт"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Статус"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Действия"})]})}),Qe.jsx("tbody",{className:"divide-y divide-gray-200",children:l.map(s=>Qe.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsxs("div",{className:"flex items-center gap-3",children:[1===s.is_pinned&&Qe.jsx(te,{className:"w-4 h-4 text-pink-600 fill-pink-600"}),s.profile_pic&&""!==s.profile_pic.trim()?Qe.jsx("img",{src:s.profile_pic,alt:s.display_name,className:"w-10 h-10 rounded-full object-cover border-2 border-white shadow-sm",crossOrigin:"anonymous",onError:e=>{e.currentTarget.style.display="none";const t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null,Qe.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-medium "+(s.profile_pic&&""!==s.profile_pic.trim()?"hidden":""),style:{display:s.profile_pic&&""!==s.profile_pic.trim()?"none":"flex"},children:s.name?s.name.charAt(0).toUpperCase():"?"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.display_name}),s.username&&Qe.jsxs("p",{className:"text-xs text-gray-500",children:["@",s.username]})]})]})}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsx("p",{className:"text-sm text-gray-900",children:s.phone||"-"})}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.total_messages}),Qe.jsxs("td",{className:"px-6 py-4 text-sm text-green-600 font-medium",children:[s.lifetime_value," AED"]}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(s.last_contact).toLocaleDateString("ru-RU")}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsx(po,{value:s.status,onChange:async e=>{try{await Ct.updateClientStatus(s.id,e),n(a.map(t=>t.id===s.id?{...t,status:e}:t)),gt.success("Статус обновлён")}catch(jx){gt.error("Ошибка обновления статуса")}},options:t,allowAdd:!0,onAddStatus:r})}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>e(`/admin/clients/${s.id}`),title:"Просмотр информации о клиенте",children:Qe.jsx(q,{className:"w-4 h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",className:"text-blue-600 hover:bg-blue-50",onClick:()=>(e=>{V(e),X({name:e.name||"",phone:e.phone||"",notes:e.notes||""}),U(!0)})(s),title:"Редактировать клиента",children:Qe.jsx(J,{className:"w-4 h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",className:"text-green-600 hover:bg-green-50",onClick:()=>e(`/admin/chat?client_id=${s.id}`),title:"Написать сообщение",children:Qe.jsx(j,{className:"w-4 h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>(async e=>{try{await Ct.pinClient(e),await ue(),gt.success("Изменено")}catch(jx){gt.error("Ошибка")}})(s.id),title:"Закрепить клиента",children:Qe.jsx(te,{className:"w-4 h-4 "+(s.is_pinned?"fill-pink-600 text-pink-600":"")})}),Qe.jsx(Ys,{size:"sm",variant:"outline",className:"text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>(async(e,t)=>{de({id:e,name:t}),le(!0)})(s.id,s.display_name),disabled:w===s.id,title:"Удалить клиента",children:w===s.id?Qe.jsx(z,{className:"w-4 h-4 animate-spin"}):Qe.jsx(Q,{className:"w-4 h-4"})})]})})]},s.id))})]})}):Qe.jsxs("div",{className:"py-20 text-center text-gray-500",children:[Qe.jsx(y,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qe.jsx("p",{children:"Клиенты не найдены"})]})}),Qe.jsx(fd,{open:M,onOpenChange:U,children:Qe.jsxs(jd,{className:"max-w-md",children:[Qe.jsx(vd,{children:Qe.jsx(Nd,{children:"Редактировать клиента"})}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"edit_name",children:"Имя"}),Qe.jsx(oo,{id:"edit_name",value:Y.name,onChange:e=>X({...Y,name:e.target.value}),placeholder:"Анна Петрова"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"edit_phone",children:"Телефон"}),Qe.jsx(oo,{id:"edit_phone",value:Y.phone,onChange:e=>X({...Y,phone:e.target.value}),placeholder:"+971 50 123 4567"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"edit_notes",children:"Заметки"}),Qe.jsx(_d,{id:"edit_notes",value:Y.notes,onChange:e=>X({...Y,notes:e.target.value}),placeholder:"Добавьте любые заметки о клиенте...",className:"min-h-[80px]"})]})]}),Qe.jsxs(wd,{children:[Qe.jsx(Ys,{variant:"outline",onClick:()=>{U(!1),V(null)},disabled:K,children:"Отмена"}),Qe.jsx(Ys,{onClick:async()=>{if(H)try{G(!0),await Ct.updateClient(H.id,{name:Y.name.trim()||null,phone:Y.phone.trim()||null,notes:Y.notes.trim()||null}),n(a.map(e=>e.id===H.id?{...e,name:Y.name.trim()||"",phone:Y.phone.trim()||"",notes:Y.notes.trim()||"",display_name:Y.name.trim()||e.username||e.id.substring(0,15)+"..."}:e)),gt.success("✅ Клиент обновлён"),U(!1),V(null)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка обновления";gt.error(`❌ Ошибка: ${t}`)}finally{G(!1)}},className:"bg-blue-600 hover:bg-blue-700",disabled:K,children:K?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Сохранение..."]}):"Сохранить"})]})]})}),Qe.jsx(fd,{open:Z,onOpenChange:ee,children:Qe.jsxs(jd,{className:"max-w-md",children:[Qe.jsx(vd,{children:Qe.jsx(Nd,{children:"Добавить нового клиента"})}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"name",children:"Имя *"}),Qe.jsx(oo,{id:"name",value:se.name,onChange:e=>re({...se,name:e.target.value}),placeholder:"Анна Петрова"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"phone",children:"Телефон"}),Qe.jsx(oo,{id:"phone",value:se.phone,onChange:e=>re({...se,phone:e.target.value}),placeholder:"+971 50 123 4567"}),Qe.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Необязательно"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"instagram",children:"Instagram ID"}),Qe.jsx(oo,{id:"instagram",value:se.instagram_id,onChange:e=>re({...se,instagram_id:e.target.value}),placeholder:"123456789 или @username"}),Qe.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Необязательно, автоматически сгенерируется"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"notes",children:"Заметки"}),Qe.jsx(_d,{id:"notes",value:se.notes,onChange:e=>re({...se,notes:e.target.value}),placeholder:"Добавьте любые заметки о клиенте...",className:"min-h-[80px]"})]})]}),Qe.jsxs(wd,{children:[Qe.jsx(Ys,{variant:"outline",onClick:()=>ee(!1),disabled:ae,children:"Отмена"}),Qe.jsx(Ys,{onClick:async()=>{if(se.name.trim())try{ne(!0);const e=se.instagram_id.trim()||`manual_${Date.now()}`;await Ct.createClient({instagram_id:e,name:se.name,phone:se.phone||"",notes:se.notes}),gt.success("Клиент создан ✅"),ee(!1),re({name:"",phone:"",instagram_id:"",notes:""}),await ue()}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка создания";gt.error(`❌ Ошибка: ${t}`)}finally{ne(!1)}else gt.error("Заполните имя клиента")},className:"bg-pink-600 hover:bg-pink-700",disabled:ae,children:ae?"Создание...":"Создать"})]})]})}),ie&&oe&&Qe.jsxs("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:[Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)",width:"100%",maxWidth:"420px",overflow:"hidden"},children:[Qe.jsx("div",{style:{backgroundColor:"#fef2f2",borderBottom:"2px solid #fecaca",padding:"1.5rem"},children:Qe.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[Qe.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#fee2e2",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:Qe.jsx(E,{style:{width:"24px",height:"24px",color:"#dc2626"}})}),Qe.jsx("h3",{style:{fontSize:"1.125rem",fontWeight:"bold",color:"#7f1d1d"},children:"Удалить клиента?"})]})}),Qe.jsxs("div",{style:{backgroundColor:"#fff",padding:"1.5rem"},children:[Qe.jsxs("p",{style:{color:"#1f2937",marginBottom:"1rem",fontSize:"0.95rem"},children:["Вы удаляете клиента ",Qe.jsxs("strong",{children:['"',oe.name,'"']})]}),Qe.jsx("div",{style:{backgroundColor:"#fefce8",borderLeft:"4px solid #facc15",padding:"1rem",marginBottom:"1rem",borderRadius:"0.5rem"},children:Qe.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[Qe.jsx(E,{style:{width:"20px",height:"20px",color:"#b45309",flexShrink:0,marginTop:"2px"}}),Qe.jsxs("div",{children:[Qe.jsx("p",{style:{fontSize:"0.875rem",fontWeight:"bold",color:"#92400e",marginBottom:"0.5rem"},children:"⚠️ Это действие необратимо!"}),Qe.jsxs("ul",{style:{fontSize:"0.875rem",color:"#92400e",marginLeft:"1rem"},children:[Qe.jsx("li",{children:"✗ Все сообщения будут удалены"}),Qe.jsx("li",{children:"✗ Все записи будут удалены"}),Qe.jsx("li",{children:"✗ История не восстановится"})]})]})]})})]}),Qe.jsxs("div",{style:{backgroundColor:"#f9fafb",borderTop:"1px solid #e5e7eb",padding:"1rem 1.5rem",display:"flex",justifyContent:"flex-end",gap:"0.75rem"},children:[Qe.jsx("button",{onClick:()=>{le(!1),de(null)},disabled:null!==w,style:{padding:"0.625rem 1.25rem",fontSize:"0.95rem",fontWeight:"500",color:"#374151",backgroundColor:"#fff",border:"1px solid #d1d5db",borderRadius:"0.5rem",cursor:null!==w?"not-allowed":"pointer",opacity:null!==w?.5:1},children:"Отмена"}),Qe.jsx("button",{onClick:async()=>{if(oe)try{N(oe.id),await Ct.deleteClient(oe.id),n(a.filter(e=>e.id!==oe.id)),gt.success("✅ Клиент удалён"),le(!1),de(null)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка удаления";gt.error(`❌ Ошибка: ${t}`)}finally{N(null)}},disabled:null!==w,style:{padding:"0.625rem 1.25rem",fontSize:"0.95rem",fontWeight:"500",color:"#fff",backgroundColor:"#dc2626",border:"1px solid #dc2626",borderRadius:"0.5rem",cursor:null!==w?"not-allowed":"pointer",opacity:null!==w?.5:1,display:"flex",alignItems:"center",gap:"0.5rem"},children:w?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{style:{width:"16px",height:"16px",animation:"spin 1s linear infinite"}}),"Удаляю..."]}):"Удалить"})]})]}),Qe.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}),C&&Qe.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Qe.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Qe.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[Qe.jsx(A,{className:"w-5 h-5 text-green-600"}),"Полный экспорт данных"]}),Qe.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:Qe.jsx(g,{className:"w-5 h-5"})})]}),Qe.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[Qe.jsx("p",{className:"text-sm text-blue-900",children:Qe.jsx("strong",{children:"Экспорт включает:"})}),Qe.jsxs("ul",{className:"text-sm text-blue-800 mt-2 space-y-1",children:[Qe.jsx("li",{children:"✓ Все данные клиентов"}),Qe.jsx("li",{children:"✓ Все сообщения с привязкой к клиентам"}),Qe.jsx("li",{children:"✓ Все записи с привязкой к клиентам"})]})]}),Qe.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Выберите формат экспорта:"}),Qe.jsxs("div",{className:"space-y-3",children:[Qe.jsxs("button",{onClick:()=>he("csv"),disabled:k,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[Qe.jsx(O,{className:"w-5 h-5"}),"CSV (универсальный формат)"]}),Qe.jsxs("button",{onClick:()=>he("excel"),disabled:k,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-4 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[Qe.jsx(W,{className:"w-5 h-5"}),"Excel (с отдельными листами)"]})]}),k&&Qe.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-gray-600",children:[Qe.jsx(z,{className:"w-4 h-4 animate-spin"}),Qe.jsx("span",{className:"text-sm",children:"Подготовка файла..."})]})]})})]})}function Dd(){const{id:e}=c(),t=i(),[r,a]=s.useState(null),[n,l]=s.useState([]),[o,d]=s.useState(!0),[m,x]=s.useState(!1),[u,h]=s.useState(!1),[p,f]=s.useState({name:"",phone:"",notes:""});s.useEffect(()=>{e&&b()},[e]);const b=async()=>{try{d(!0);const t=await Ct.getClient(e);a(t.client),f({name:t.client?.name||"",phone:t.client?.phone||"",notes:t.client?.notes||""}),l(t.chat_history||[])}catch(jx){gt.error("Ошибка загрузки клиента"),t("/admin/clients")}finally{d(!1)}};return o?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"text-center",children:[Qe.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full animate-spin mx-auto"}),Qe.jsx("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})}):r?Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[Qe.jsx("button",{onClick:()=>t("/admin/clients"),className:"p-2 hover:bg-gray-100 rounded-lg",children:Qe.jsx(H,{className:"w-6 h-6"})}),Qe.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[r.profile_pic?Qe.jsx("img",{src:r.profile_pic,alt:r.name||"Клиент",className:"w-16 h-16 rounded-full object-cover border-4 border-white shadow-lg",onError:e=>{e.currentTarget.style.display="none"}}):Qe.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-2xl shadow-lg",children:(r.name||r.username||"К").charAt(0).toUpperCase()}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("h1",{className:"text-3xl text-gray-900",children:r.name||"Клиент"}),r.username&&Qe.jsxs("a",{href:`https://instagram.com/${r.username}`,target:"_blank",rel:"noopener noreferrer",className:"text-pink-600 hover:text-pink-700 hover:underline flex items-center gap-2",children:["@",r.username,Qe.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),!m&&Qe.jsxs(Ys,{onClick:()=>x(!0),variant:"outline",className:"gap-2",children:[Qe.jsx(J,{className:"w-4 h-4"}),"Редактировать"]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[Qe.jsx("div",{className:"lg:col-span-2",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Информация о клиенте"}),m?Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Имя"}),Qe.jsx(oo,{value:p.name,onChange:e=>f({...p,name:e.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Телефон"}),Qe.jsx(oo,{value:p.phone,onChange:e=>f({...p,phone:e.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Заметки"}),Qe.jsx(_d,{value:p.notes,onChange:e=>f({...p,notes:e.target.value}),className:"min-h-[100px]"})]}),Qe.jsxs("div",{className:"flex gap-2",children:[Qe.jsxs(Ys,{onClick:async()=>{if(r)try{h(!0),await Ct.updateClient(r.id,p),a({...r,...p}),x(!1),gt.success("Данные клиента обновлены")}catch(jx){gt.error("Ошибка сохранения")}finally{h(!1)}},disabled:u,className:"bg-pink-600 hover:bg-pink-700",children:[Qe.jsx(se,{className:"w-4 h-4 mr-2"}),u?"Сохранение...":"Сохранить"]}),Qe.jsxs(Ys,{onClick:()=>x(!1),variant:"outline",children:[Qe.jsx(g,{className:"w-4 h-4 mr-2"}),"Отмена"]})]})]}):Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx(X,{className:"w-5 h-5 text-gray-400 mt-1"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Телефон"}),Qe.jsx("p",{className:"text-lg text-gray-900",children:r.phone||"-"})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx(R,{className:"w-5 h-5 text-gray-400 mt-1"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Первый контакт"}),Qe.jsx("p",{className:"text-lg text-gray-900",children:new Date(r.first_contact).toLocaleDateString("ru-RU")})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx(j,{className:"w-5 h-5 text-gray-400 mt-1"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Всего сообщений"}),Qe.jsx("p",{className:"text-lg text-gray-900",children:r.total_messages})]})]}),r.notes&&Qe.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg",children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Заметки"}),Qe.jsx("p",{className:"text-gray-900 mt-1",children:r.notes})]})]})]})}),Qe.jsx("div",{children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-6",children:"Статистика"}),Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Статус"}),Qe.jsx(Do,{className:"bg-blue-100 text-blue-800 capitalize",children:r.status})]}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Lifetime Value"}),Qe.jsxs("p",{className:"text-2xl text-green-600 font-bold",children:[r.lifetime_value," AED"]})]}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Последний контакт"}),Qe.jsx("p",{className:"text-gray-900",children:new Date(r.last_contact).toLocaleDateString("ru-RU")})]}),Qe.jsxs(Ys,{onClick:()=>t(`/admin/chat?client_id=${r.id}`),className:"w-full bg-pink-600 hover:bg-pink-700 gap-2",children:[Qe.jsx(j,{className:"w-4 h-4"}),"Написать сообщение"]})]})]})})]}),Qe.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"История переписки"}),n.length>0?Qe.jsx("div",{className:"space-y-4",children:n.map((e,t)=>Qe.jsx("div",{className:"flex "+("bot"===e.sender?"justify-end":"justify-start"),children:Qe.jsxs("div",{className:"max-w-md px-4 py-3 rounded-lg "+("bot"===e.sender?"bg-pink-100 text-gray-900":"bg-gray-100 text-gray-900"),children:[Qe.jsx("p",{className:"text-sm",children:e.message}),Qe.jsx("p",{className:"text-xs text-gray-600 mt-1",children:new Date(e.timestamp).toLocaleTimeString("ru-RU")})]})},t))}):Qe.jsx("p",{className:"text-gray-500 text-center py-8",children:"Нет сообщений"})]})]}):Qe.jsxs("div",{className:"p-8",children:[Qe.jsx(Ys,{onClick:()=>t("/admin/clients"),variant:"ghost",children:"← Вернуться"}),Qe.jsx("p",{className:"text-gray-600 mt-4",children:"Клиент не найден"})]})}function Id(){const e=i(),[t,r]=s.useState({full_name:"",username:"",email:"",password:"",role:"employee"}),[a,n]=s.useState(!1);return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs(Ys,{variant:"ghost",className:"mb-6",onClick:()=>e("/admin/users"),disabled:a,children:[Qe.jsx(H,{className:"w-4 h-4 mr-2"}),"Назад к пользователям"]}),Qe.jsxs("div",{className:"max-w-2xl mx-auto",children:[Qe.jsx("div",{className:"mb-8",children:Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(N,{className:"w-8 h-8 text-pink-600"}),"Создать нового пользователя"]})}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:Qe.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),t.full_name.trim())if(t.username.trim())if(t.username.length<3)gt.error("Логин должен содержать минимум 3 символа");else if(t.password)if(t.password.length<6)gt.error("Пароль должен содержать минимум 6 символов");else try{n(!0);const s=await fetch("https://mlediamant.com/api/users",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}),r=await s.json();if(!s.ok)throw new Error(r.error||"Ошибка создания пользователя");gt.success("Пользователь успешно создан!"),e("/admin/users")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка создания пользователя";gt.error(`Ошибка: ${t}`)}finally{n(!1)}else gt.error('Заполните поле "Пароль"');else gt.error('Заполните поле "Логин"');else gt.error('Заполните поле "ФИ"')},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"full_name",children:"ФИ *"}),Qe.jsx(oo,{id:"full_name",required:!0,disabled:a,value:t.full_name,onChange:e=>r({...t,full_name:e.target.value}),placeholder:"Анна Петрова"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"username",children:"Логин *"}),Qe.jsx(oo,{id:"username",required:!0,disabled:a,value:t.username,onChange:e=>r({...t,username:e.target.value}),placeholder:"anna_petrova"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Минимум 3 символа, будет использоваться для входа в систему"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"email",children:"Email"}),Qe.jsx(oo,{id:"email",type:"email",disabled:a,value:t.email,onChange:e=>r({...t,email:e.target.value}),placeholder:"anna@example.com"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Необязательно, для восстановления пароля"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"password",children:"Пароль *"}),Qe.jsx(oo,{id:"password",type:"password",required:!0,disabled:a,minLength:6,value:t.password,onChange:e=>r({...t,password:e.target.value}),placeholder:"••••••"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Минимум 6 символов"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"role",children:"Роль *"}),Qe.jsxs(to,{value:t.role,onValueChange:e=>r({...t,role:e}),disabled:a,children:[Qe.jsx(ro,{children:Qe.jsx(so,{})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"employee",children:"Сотрудник"}),Qe.jsx(no,{value:"manager",children:"Менеджер"}),Qe.jsx(no,{value:"admin",children:"Администратор"})]})]}),Qe.jsxs("div",{className:"mt-2 p-4 bg-gray-50 rounded-lg text-sm text-gray-600 space-y-1",children:[Qe.jsxs("p",{children:[Qe.jsx("strong",{children:"Сотрудник:"})," базовые права - просмотр своих записей и графика"]}),Qe.jsxs("p",{children:[Qe.jsx("strong",{children:"Менеджер:"})," расширенные права - работа с клиентами и аналитикой"]}),Qe.jsxs("p",{children:[Qe.jsx("strong",{children:"Администратор:"})," полный доступ ко всем функциям системы"]})]})]}),Qe.jsx(Ys,{type:"submit",disabled:a,className:"w-full bg-pink-600 hover:bg-pink-700",children:a?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Создание..."]}):Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(N,{className:"w-4 h-4 mr-2"}),"Создать аккаунт"]})})]})})]})]})}const Ld={admin:{label:"Администратор",color:"bg-purple-100 text-purple-800"},manager:{label:"Менеджер",color:"bg-blue-100 text-blue-800"},employee:{label:"Сотрудник",color:"bg-green-100 text-green-800"}};function Pd(){const e=i(),[t,r]=s.useState([]),[a,n]=s.useState([]),[l,o]=s.useState(""),[d,c]=s.useState(!0),[m,x]=s.useState(null);s.useEffect(()=>{u()},[]),s.useEffect(()=>{const e=t.filter(e=>e.full_name.toLowerCase().includes(l.toLowerCase())||e.username.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase()));n(e)},[l,t]);const u=async()=>{try{c(!0),x(null);const e=await Ct.getUsers(),t=e.users||(Array.isArray(e)?e:[]);r(t),0===t.length&&gt.info("Пользователей не найдено")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки пользователей";x(t),gt.error(`Ошибка: ${t}`)}finally{c(!1)}},h={total:t.length,admins:t.filter(e=>"admin"===e.role).length,employees:t.filter(e=>"employee"===e.role).length};return d?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка пользователей..."})]})}):m?Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:m}),Qe.jsx(Ys,{onClick:u,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})}):Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(y,{className:"w-8 h-8 text-pink-600"}),"Управление пользователями"]}),Qe.jsxs("p",{className:"text-gray-600",children:[a.length," пользователей"]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Всего пользователей"}),Qe.jsx("h3",{className:"text-3xl text-gray-900",children:h.total})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Администраторов"}),Qe.jsx("h3",{className:"text-3xl text-purple-600",children:h.admins})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Сотрудников"}),Qe.jsx("h3",{className:"text-3xl text-green-600",children:h.employees})]})]}),Qe.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6",children:Qe.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[Qe.jsxs("div",{className:"flex-1 relative",children:[Qe.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{type:"text",placeholder:"Поиск по имени, логину или email...",value:l,onChange:e=>o(e.target.value),className:"pl-10"})]}),Qe.jsxs(Ys,{className:"bg-pink-600 hover:bg-pink-700",onClick:()=>e("/admin/users/create"),children:[Qe.jsx(N,{className:"w-4 h-4 mr-2"}),"Добавить пользователя"]})]})}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:a.length>0?Qe.jsx("div",{className:"overflow-x-auto",children:Qe.jsxs("table",{className:"w-full",children:[Qe.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:Qe.jsxs("tr",{children:[Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Пользователь"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Логин"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Email"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Роль"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Создан"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Действия"})]})}),Qe.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(s=>Qe.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-medium",children:s.full_name?.charAt(0)||"?"}),Qe.jsx("div",{children:Qe.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.full_name})})]})}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:s.username}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.email||"-"}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsx(Do,{className:Ld[s.role]?.color||"bg-gray-100 text-gray-800",children:Ld[s.role]?.label||s.role})}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(s.created_at).toLocaleDateString("ru-RU")}),Qe.jsx("td",{className:"px-6 py-4",children:Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>e(`/admin/users/${s.id}/edit`),children:Qe.jsx(Z,{className:"w-4 h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>(async e=>{if(confirm("Вы уверены, что хотите удалить этого пользователя?"))try{await Ct.deleteUser(e),r(t.filter(t=>t.id!==e)),gt.success("Пользователь удален")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка удаления";gt.error(`Ошибка: ${t}`)}})(s.id),children:Qe.jsx(Q,{className:"w-4 h-4"})})]})})]},s.id))})]})}):Qe.jsxs("div",{className:"py-20 text-center text-gray-500",children:[Qe.jsx(y,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qe.jsx("p",{children:"Пользователи не найдены"})]})})]})}const Md=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],Ad=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],Od=(()=>{const e=[];for(let t=9;t<=21;t++)e.push({hour:t,minute:0,display:`${String(t).padStart(2,"0")}:00`}),t<21&&e.push({hour:t,minute:30,display:`${String(t).padStart(2,"0")}:30`});return e})(),Wd={pending:{bg:"#fef3c7",text:"#92400e",border:"#fcd34d"},confirmed:{bg:"#dcfce7",text:"#166534",border:"#86efac"},completed:{bg:"#dbeafe",text:"#1e40af",border:"#93c5fd"},cancelled:{bg:"#fee2e2",text:"#991b1b",border:"#fca5a5"}},Bd={pending:"Ожидание",confirmed:"Подтверждена",completed:"Завершена",cancelled:"Отменена"};function Fd(){const e=new Date;e.setHours(0,0,0,0);const[t,r]=s.useState(new Date(e)),[a,n]=s.useState([]),[i,l]=s.useState([]),[o,d]=s.useState([]),[c,m]=s.useState([]),[x,u]=s.useState(!0),[h,p]=s.useState(null),[f,b]=s.useState(!1),[y,j]=s.useState(!1),[v,w]=s.useState(!1),[N,k]=s.useState(!1),[S,C]=s.useState(""),[_,z]=s.useState(!1),[E,T]=s.useState(null),[D,I]=s.useState(""),[L,M]=s.useState(!1),[A,O]=s.useState(null),[W,F]=s.useState({phone:"",date:"",time:"",revenue:0,master:""}),$=["pending","confirmed","completed","cancelled"];s.useEffect(()=>{U()},[]);const U=async()=>{try{u(!0);const[e,t,s,r]=await Promise.all([Ct.getBookings(),Ct.getServices(!0),Ct.getClients(),Ct.getUsers()]);n(e.bookings||[]),l(t.services||[]),d(s.clients||[]),m(r.users?.filter(e=>"employee"===e.role||"manager"===e.role||"admin"===e.role)||[])}catch(jx){gt.error("Ошибка загрузки данных")}finally{u(!1)}},q=s.useMemo(()=>{const e=[];for(let s=-3;s<=3;s++){const r=new Date(t);r.setDate(r.getDate()+s),e.push(r)}return e},[t]),H=()=>{V(),w(!1),b(!0)},V=()=>{C(""),I(""),T(null),O(null),F({phone:"",date:t.toISOString().split("T")[0],time:Od[0].display,revenue:0,master:c[0]?.full_name||""})},Y=o.filter(e=>(e.display_name||"").toLowerCase().includes(S.toLowerCase())||(e.phone||"").includes(S)),X=i.filter(e=>(e.name_ru||"").toLowerCase().includes(D.toLowerCase())||(e.name||"").toLowerCase().includes(D.toLowerCase())),J=t=>t.toDateString()===e.toDateString();return x?Qe.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[Qe.jsx("div",{className:"inline-block animate-spin w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full"}),Qe.jsx("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Загрузка..."})]}):Qe.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f9fafb",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[Qe.jsx("div",{style:{marginBottom:"0.75rem"},children:Qe.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:"bold",color:"#111827"},children:"Календарь"})}),Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.75rem",marginBottom:"0.75rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem"},children:[Qe.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[Qe.jsx("button",{onClick:()=>{const e=new Date(t);e.setDate(e.getDate()-1),r(e)},style:{width:"32px",height:"32px",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:Qe.jsx(re,{size:16,color:"#6b7280"})}),Qe.jsx("button",{onClick:()=>{const e=new Date(t);e.setDate(e.getDate()+1),r(e)},style:{width:"32px",height:"32px",border:"1px solid #d1d5db",borderRadius:"0.375rem",backgroundColor:"#fff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:Qe.jsx(ae,{size:16,color:"#6b7280"})})]}),Qe.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.95rem",fontWeight:"600",color:"#111827"},children:[J(t)&&Qe.jsx(R,{size:16,color:"#ec4899"}),Qe.jsxs("span",{style:{color:J(t)?"#ec4899":"#111827"},children:[t.getDate()," ",Ad[t.getMonth()]]})]}),Qe.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[Qe.jsx("button",{onClick:()=>{const e=new Date;e.setHours(0,0,0,0),r(e);const t=(s=e,a.filter(e=>new Date(e.datetime).toDateString()===s.toDateString()));var s;0===t.length?gt.success("📅 Сегодня записей нет - свободный день! 🎉",{duration:3e3}):1===t.length?gt.success("📅 Одна запись на сегодня ⏰",{duration:3e3}):gt.success(`📅 ${t.length} записей на сегодня 🔥`,{duration:3e3})},style:{padding:"0.4rem 0.75rem",backgroundColor:"#fff",border:"2px solid #ec4899",borderRadius:"0.375rem",fontSize:"0.8rem",fontWeight:"600",color:"#ec4899",cursor:"pointer"},children:"Сегодня"}),Qe.jsxs("button",{onClick:H,style:{padding:"0.4rem 0.75rem",backgroundColor:"#2563eb",color:"#fff",border:"none",borderRadius:"0.375rem",fontSize:"0.8rem",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.3rem"},children:[Qe.jsx(B,{size:14}),"Запись"]})]})]}),Qe.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0.5rem",border:"1px solid #e5e7eb",padding:"0.5rem",marginBottom:"0.75rem",display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"0.375rem"},children:q.map((e,s)=>{const a=e.toDateString()===t.toDateString();const n=J(e);return Qe.jsxs("button",{onClick:()=>r(new Date(e)),style:{padding:"0.5rem 0.25rem",backgroundColor:a?"#ec4899":n?"#fef3c7":"#f9fafb",border:a?"2px solid #ec4899":"1px solid #e5e7eb",borderRadius:"0.375rem",cursor:"pointer"},children:[Qe.jsx("div",{style:{fontSize:"0.65rem",fontWeight:"600",color:a?"#fff":"#6b7280",marginBottom:"0.125rem"},children:Md[0===e.getDay()?6:e.getDay()-1]}),Qe.jsx("div",{style:{fontSize:"0.9rem",fontWeight:"bold",color:a?"#fff":"#111827"},children:e.getDate()})]},s)})}),Qe.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0.5rem",border:"1px solid #e5e7eb",overflow:"hidden",flex:1,display:"flex",flexDirection:"column"},children:Qe.jsx("div",{style:{flex:1,overflow:"auto"},children:Od.map((e,s)=>{return Qe.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr",gap:"0",borderBottom:s!==Od.length-1?"1px solid #e5e7eb":"none",minHeight:"50px"},children:[Qe.jsxs("div",{style:{padding:"0.5rem 0.25rem",backgroundColor:"#f9fafb",borderRight:"1px solid #e5e7eb",fontWeight:"600",color:"#6b7280",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",gap:"0.25rem",whiteSpace:"nowrap"},children:[Qe.jsx(K,{size:12}),e.display]}),Qe.jsx("div",{onClick:H,style:{padding:"0.3rem",backgroundColor:"#fff",cursor:"pointer",display:"flex",flexDirection:"column",gap:"0.2rem",overflow:"auto"},children:(r=t,n=e.hour,i=e.minute,a.filter(e=>{const t=new Date(e.datetime);return t.toDateString()===r.toDateString()&&t.getHours()===n&&t.getMinutes()===i})).map(e=>Qe.jsxs("div",{onClick:t=>{t.stopPropagation(),p(e)},style:{padding:"0.35rem",backgroundColor:Wd[e.status]?.bg,color:Wd[e.status]?.text,border:`1px solid ${Wd[e.status]?.border}`,borderRadius:"0.25rem",fontSize:"0.7rem",cursor:"pointer",fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:`${e.name} - ${e.service}`,children:[e.name," - ",e.service]},e.id))})]},s);var r,n,i})})}),f&&Qe.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",width:"100%",maxWidth:"500px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[Qe.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsx("h3",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#111"},children:v?"Редактировать запись":"Добавить запись"}),Qe.jsx("button",{onClick:()=>{b(!1),V()},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.5rem"},children:"×"})]}),Qe.jsxs("div",{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Клиент *"}),Qe.jsxs("div",{style:{position:"relative"},children:[Qe.jsx("input",{type:"text",placeholder:"Поиск клиента по имени или телефону...",value:E?E.display_name:S,onChange:e=>{C(e.target.value),T(null),z(!0)},onFocus:()=>z(!0),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}}),E&&Qe.jsxs("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[Qe.jsx(P,{style:{width:"16px",height:"16px",color:"#10b981"}}),Qe.jsx("button",{onClick:()=>{T(null),C("")},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",padding:0},children:Qe.jsx(g,{style:{width:"16px",height:"16px",color:"#6b7280"}})})]}),_&&!E&&S&&Qe.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"0.5rem",backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 10px 25px rgba(0,0,0,0.1)",maxHeight:"300px",overflowY:"auto",zIndex:10},children:Y.length>0?Y.map(e=>Qe.jsxs("button",{onClick:()=>{T(e),C(""),z(!1),F({...W,phone:e.phone||""})},style:{width:"100%",padding:"0.75rem 1rem",textAlign:"left",border:"none",backgroundColor:"#fff",cursor:"pointer",borderBottom:"1px solid #f3f4f6",display:"flex",alignItems:"center",gap:"0.75rem"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#fff",children:[Qe.jsx("div",{style:{width:"40px",height:"40px",backgroundColor:"#fce7f3",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#ec4899",fontWeight:"500",fontSize:"0.875rem",flexShrink:0},children:(e.display_name||"N").charAt(0).toUpperCase()}),Qe.jsxs("div",{style:{flex:1},children:[Qe.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#111"},children:e.display_name}),e.phone&&Qe.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.phone})]})]},e.id)):Qe.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af",fontSize:"0.875rem"},children:"Клиенты не найдены"})})]})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Услуга *"}),Qe.jsxs("div",{style:{position:"relative"},children:[Qe.jsx("input",{type:"text",placeholder:"Поиск услуги...",value:A?A.name_ru:D,onChange:e=>{I(e.target.value),O(null),M(!0)},onFocus:()=>M(!0),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}}),A&&Qe.jsxs("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[Qe.jsx(P,{style:{width:"16px",height:"16px",color:"#10b981"}}),Qe.jsx("button",{onClick:()=>{O(null),I("")},style:{backgroundColor:"transparent",border:"none",cursor:"pointer",padding:0},children:Qe.jsx(g,{style:{width:"16px",height:"16px",color:"#6b7280"}})})]}),L&&!A&&D&&Qe.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"0.5rem",backgroundColor:"#fff",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 10px 25px rgba(0,0,0,0.1)",maxHeight:"300px",overflowY:"auto",zIndex:10},children:X.length>0?X.map(e=>Qe.jsx("button",{onClick:()=>{O(e),I(""),M(!1),F({...W,revenue:e.price})},style:{width:"100%",padding:"0.75rem 1rem",textAlign:"left",border:"none",backgroundColor:"#fff",cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#f9fafb",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#fff",children:Qe.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Qe.jsxs("div",{children:[Qe.jsx("div",{style:{fontSize:"0.875rem",fontWeight:"500",color:"#111"},children:e.name_ru}),Qe.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.category})]}),Qe.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#ec4899"},children:[e.price," ",e.currency]})]})},e.id)):Qe.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af",fontSize:"0.875rem"},children:"Услуги не найдены"})})]})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Мастер"}),Qe.jsxs("select",{value:W.master,onChange:e=>F({...W,master:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",backgroundColor:"#fff",cursor:"pointer"},children:[Qe.jsx("option",{value:"",children:"Выберите мастера"}),c.map(e=>Qe.jsxs("option",{value:e.full_name,children:[e.full_name," (",e.role,")"]},e.id))]})]}),Qe.jsxs("div",{children:[Qe.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:["Телефон ",!E?.phone&&"*"]}),Qe.jsx("input",{type:"tel",placeholder:"+971 50 123 4567",value:W.phone,onChange:e=>F({...W,phone:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Дата *"}),Qe.jsx("input",{type:"date",value:W.date,onChange:e=>F({...W,date:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Время *"}),Qe.jsx("select",{value:W.time,onChange:e=>F({...W,time:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",backgroundColor:"#fff",cursor:"pointer"},children:Od.map((e,t)=>Qe.jsx("option",{value:e.display,children:e.display},t))})]})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Сумма (AED)"}),Qe.jsx("input",{type:"number",placeholder:"0",value:W.revenue,onChange:e=>F({...W,revenue:Number(e.target.value)}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1rem"},children:[Qe.jsx("button",{onClick:()=>{b(!1),V()},disabled:N,style:{flex:1,padding:"0.75rem",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"0.5rem",cursor:"pointer",fontWeight:"500",color:"#374151"},children:"Отмена"}),Qe.jsx("button",{onClick:async()=>{if(E&&A&&W.date&&W.time)try{k(!0),v&&h?(await Ct.updateBookingStatus(h.id,"cancelled"),await Ct.createBooking({instagram_id:E.instagram_id,name:E.display_name,phone:W.phone||E.phone||"",service:A.name_ru,date:W.date,time:W.time,revenue:W.revenue||A.price,master:W.master}),gt.success("Запись обновлена")):(await Ct.createBooking({instagram_id:E.instagram_id,name:E.display_name,phone:W.phone||E.phone||"",service:A.name_ru,date:W.date,time:W.time,revenue:W.revenue||A.price,master:W.master}),gt.success("Запись создана ✅")),b(!1),V(),await U()}catch(jx){gt.error(`❌ Ошибка: ${jx.message}`)}finally{k(!1)}else gt.error("Заполните все обязательные поля (клиент, услуга, дата, время)")},disabled:N,style:{flex:1,padding:"0.75rem",backgroundColor:"#ec4899",border:"none",borderRadius:"0.5rem",color:"#fff",fontWeight:"500",cursor:N?"not-allowed":"pointer",opacity:N?.5:1},children:N?"Создание...":v?"Сохранить":"Создать"})]})]})]})}),h&&!f&&Qe.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999,padding:"1rem"},children:Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"1rem",width:"100%",maxWidth:"450px",boxShadow:"0 20px 25px rgba(0,0,0,0.1)",maxHeight:"90vh",overflow:"auto"},children:[Qe.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,backgroundColor:"#fff"},children:[Qe.jsxs("h3",{style:{fontSize:"1.125rem",fontWeight:"bold",color:"#111827"},children:["Запись #",h.id]}),Qe.jsx("button",{onClick:()=>p(null),style:{backgroundColor:"transparent",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.5rem"},children:"×"})]}),Qe.jsxs("div",{style:{padding:"1.5rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"500",color:"#6b7280",marginBottom:"0.5rem"},children:"Клиент"}),Qe.jsx("input",{type:"text",value:h.name,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",backgroundColor:"#f9fafb",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"500",color:"#6b7280",marginBottom:"0.5rem"},children:"Услуга"}),Qe.jsx("input",{type:"text",value:h.service,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",backgroundColor:"#f9fafb",fontSize:"0.95rem",boxSizing:"border-box"}})]}),h.master&&Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"500",color:"#6b7280",marginBottom:"0.5rem"},children:"Мастер"}),Qe.jsx("input",{type:"text",value:h.master,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",backgroundColor:"#f9fafb",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"500",color:"#6b7280",marginBottom:"0.5rem"},children:"Телефон"}),Qe.jsx("input",{type:"tel",value:h.phone,readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",backgroundColor:"#f9fafb",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontSize:"0.75rem",fontWeight:"500",color:"#6b7280",marginBottom:"0.5rem"},children:"Дата и время"}),Qe.jsx("input",{type:"text",value:new Date(h.datetime).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),readOnly:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",backgroundColor:"#f9fafb",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{style:{position:"relative"},children:[Qe.jsxs("button",{onClick:()=>j(!y),style:{width:"100%",padding:"0.75rem 1rem",backgroundColor:Wd[h.status]?.bg,borderRadius:"0.5rem",border:`2px solid ${Wd[h.status]?.border}`,color:Wd[h.status]?.text,fontWeight:"bold",cursor:"pointer",fontSize:"0.95rem",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Qe.jsx("span",{children:Bd[h.status]}),Qe.jsx("span",{children:"▼"})]}),y&&Qe.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"0.5rem",backgroundColor:"#fff",border:"2px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",zIndex:1e4,overflow:"hidden"},children:$.map(e=>Qe.jsxs("button",{onClick:()=>(async e=>{if(h)try{await Ct.updateBookingStatus(h.id,e);const t=a.map(t=>t.id===h.id?{...t,status:e}:t);n(t),p({...h,status:e}),j(!1),gt.success("Статус изменён")}catch(jx){gt.error("Ошибка")}})(e),style:{width:"100%",padding:"0.875rem 1rem",textAlign:"left",border:"none",backgroundColor:h.status===e?Wd[e]?.bg:"#fff",borderBottom:e!==$[$.length-1]?"1px solid #e5e7eb":"none",cursor:"pointer",color:Wd[e]?.text,fontWeight:h.status===e?"bold":"normal",fontSize:"0.95rem"},children:[Bd[e],h.status===e&&" ✓"]},e))})]}),Qe.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1rem"},children:[Qe.jsxs("button",{onClick:()=>(async e=>{if(confirm(`Удалить запись для ${e.name}?`))try{await Ct.updateBookingStatus(e.id,"cancelled"),gt.success("Запись удалена"),p(null),await U()}catch(jx){gt.error("Ошибка удаления")}})(h),style:{flex:1,padding:"0.75rem",backgroundColor:"#fee2e2",border:"2px solid #fca5a5",borderRadius:"0.5rem",color:"#991b1b",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.95rem"},children:[Qe.jsx(Q,{size:16}),"Удалить"]}),Qe.jsxs("button",{onClick:()=>{p(null),(e=>{const t=new Date(e.datetime),s=o.find(t=>t.instagram_id===e.client_id)||null,r=i.find(t=>t.name_ru===e.service)||null;T(s),O(r),F({phone:e.phone,date:t.toISOString().split("T")[0],time:t.toTimeString().slice(0,5),revenue:e.revenue,master:e.master||c[0]?.full_name||""}),w(!0),p(e),b(!0)})(h)},style:{flex:1,padding:"0.75rem",backgroundColor:"#dbeafe",border:"2px solid #93c5fd",borderRadius:"0.5rem",color:"#1e40af",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.95rem"},children:[Qe.jsx(Z,{size:16}),"Изменить"]})]}),Qe.jsx("button",{onClick:()=>p(null),style:{padding:"0.75rem",backgroundColor:"#2563eb",border:"none",borderRadius:"0.5rem",color:"#fff",fontWeight:"500",cursor:"pointer",marginTop:"0.5rem"},children:"Закрыть"})]})]})})]})}var $d="Switch",[Ud]=Gs($d),[qd,Hd]=Ud($d),Vd=s.forwardRef((e,t)=>{const{__scopeSwitch:r,name:a,checked:n,defaultChecked:i,required:l,disabled:o,value:d="on",onCheckedChange:c,form:m,...x}=e,[u,h]=s.useState(null),p=Rt(t,e=>h(e)),g=s.useRef(!1),f=!u||(m||!!u.closest("form")),[b,y]=Vn({prop:n,defaultProp:i??!1,onChange:c,caller:$d});return Qe.jsxs(qd,{scope:r,checked:b,disabled:o,children:[Qe.jsx(sr.button,{type:"button",role:"switch","aria-checked":b,"aria-required":l,"data-state":Jd(b),"data-disabled":o?"":void 0,disabled:o,value:d,...x,ref:p,onClick:Js(e.onClick,e=>{y(e=>!e),f&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})}),f&&Qe.jsx(Kd,{control:u,bubbles:!g.current,name:a,value:d,checked:b,required:l,disabled:o,form:m,style:{transform:"translateX(-100%)"}})]})});Vd.displayName=$d;var Yd="SwitchThumb",Xd=s.forwardRef((e,t)=>{const{__scopeSwitch:s,...r}=e,a=Hd(Yd,s);return Qe.jsx(sr.span,{"data-state":Jd(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});Xd.displayName=Yd;var Kd=s.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:a=!0,...n},i)=>{const l=s.useRef(null),o=Rt(l,i),d=Yn(r),c=vn(t);return s.useEffect(()=>{const e=l.current;if(!e)return;const t=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(t,"checked").set;if(d!==r&&s){const t=new Event("click",{bubbles:a});s.call(e,r),e.dispatchEvent(t)}},[d,r,a]),Qe.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:o,style:{...n.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function Jd(e){return e?"checked":"unchecked"}Kd.displayName="SwitchBubbleInput";var Gd=Vd,Zd=Xd;function Qd({className:e,...t}){return Qe.jsx(Gd,{"data-slot":"switch",className:Hs("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:Qe.jsx(Zd,{"data-slot":"switch-thumb",className:Hs("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var ec="rovingFocusGroup.onEntryFocus",tc={bubbles:!1,cancelable:!0},sc="RovingFocusGroup",[rc,ac,nc]=Qs(sc),[ic,lc]=Gs(sc,[nc]),[oc,dc]=ic(sc),cc=s.forwardRef((e,t)=>Qe.jsx(rc.Provider,{scope:e.__scopeRovingFocusGroup,children:Qe.jsx(rc.Slot,{scope:e.__scopeRovingFocusGroup,children:Qe.jsx(mc,{...e,ref:t})})}));cc.displayName=sc;var mc=s.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:a,loop:n=!1,dir:i,currentTabStopId:l,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:d,onEntryFocus:c,preventScrollOnEntryFocus:m=!1,...x}=e,u=s.useRef(null),h=Rt(t,u),p=tr(i),[g,f]=Vn({prop:l,defaultProp:o??null,onChange:d,caller:sc}),[b,y]=s.useState(!1),j=rr(c),v=ac(r),w=s.useRef(!1),[N,k]=s.useState(0);return s.useEffect(()=>{const e=u.current;if(e)return e.addEventListener(ec,j),()=>e.removeEventListener(ec,j)},[j]),Qe.jsx(oc,{scope:r,orientation:a,dir:p,loop:n,currentTabStopId:g,onItemFocus:s.useCallback(e=>f(e),[f]),onItemShiftTab:s.useCallback(()=>y(!0),[]),onFocusableItemAdd:s.useCallback(()=>k(e=>e+1),[]),onFocusableItemRemove:s.useCallback(()=>k(e=>e-1),[]),children:Qe.jsx(sr.div,{tabIndex:b||0===N?-1:0,"data-orientation":a,...x,ref:h,style:{outline:"none",...e.style},onMouseDown:Js(e.onMouseDown,()=>{w.current=!0}),onFocus:Js(e.onFocus,e=>{const t=!w.current;if(e.target===e.currentTarget&&t&&!b){const t=new CustomEvent(ec,tc);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){const e=v().filter(e=>e.focusable);pc([e.find(e=>e.active),e.find(e=>e.id===g),...e].filter(Boolean).map(e=>e.ref.current),m)}}w.current=!1}),onBlur:Js(e.onBlur,()=>y(!1))})})}),xc="RovingFocusGroupItem",uc=s.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:a=!0,active:n=!1,tabStopId:i,children:l,...o}=e,d=zr(),c=i||d,m=dc(xc,r),x=m.currentTabStopId===c,u=ac(r),{onFocusableItemAdd:h,onFocusableItemRemove:p,currentTabStopId:g}=m;return s.useEffect(()=>{if(a)return h(),()=>p()},[a,h,p]),Qe.jsx(rc.ItemSlot,{scope:r,id:c,focusable:a,active:n,children:Qe.jsx(sr.span,{tabIndex:x?0:-1,"data-orientation":m.orientation,...o,ref:t,onMouseDown:Js(e.onMouseDown,e=>{a?m.onItemFocus(c):e.preventDefault()}),onFocus:Js(e.onFocus,()=>m.onItemFocus(c)),onKeyDown:Js(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void m.onItemShiftTab();if(e.target!==e.currentTarget)return;const t=function(e,t,s){const r=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,s);return"vertical"===t&&["ArrowLeft","ArrowRight"].includes(r)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(r)?void 0:hc[r]}(e,m.orientation,m.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let a=u().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)a.reverse();else if("prev"===t||"next"===t){"prev"===t&&a.reverse();const n=a.indexOf(e.currentTarget);a=m.loop?(r=n+1,(s=a).map((e,t)=>s[(r+t)%s.length])):a.slice(n+1)}setTimeout(()=>pc(a))}var s,r}),children:"function"==typeof l?l({isCurrentTabStop:x,hasTabStop:null!=g}):l})})});uc.displayName=xc;var hc={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function pc(e,t=!1){const s=document.activeElement;for(const r of e){if(r===s)return;if(r.focus({preventScroll:t}),document.activeElement!==s)return}}var gc=cc,fc=uc,bc="Tabs",[yc]=Gs(bc,[lc]),jc=lc(),[vc,wc]=yc(bc),Nc=s.forwardRef((e,t)=>{const{__scopeTabs:s,value:r,onValueChange:a,defaultValue:n,orientation:i="horizontal",dir:l,activationMode:o="automatic",...d}=e,c=tr(l),[m,x]=Vn({prop:r,onChange:a,defaultProp:n??"",caller:bc});return Qe.jsx(vc,{scope:s,baseId:zr(),value:m,onValueChange:x,orientation:i,dir:c,activationMode:o,children:Qe.jsx(sr.div,{dir:c,"data-orientation":i,...d,ref:t})})});Nc.displayName=bc;var kc="TabsList",Sc=s.forwardRef((e,t)=>{const{__scopeTabs:s,loop:r=!0,...a}=e,n=wc(kc,s),i=jc(s);return Qe.jsx(gc,{asChild:!0,...i,orientation:n.orientation,dir:n.dir,loop:r,children:Qe.jsx(sr.div,{role:"tablist","aria-orientation":n.orientation,...a,ref:t})})});Sc.displayName=kc;var Cc="TabsTrigger",_c=s.forwardRef((e,t)=>{const{__scopeTabs:s,value:r,disabled:a=!1,...n}=e,i=wc(Cc,s),l=jc(s),o=Rc(i.baseId,r),d=Tc(i.baseId,r),c=r===i.value;return Qe.jsx(fc,{asChild:!0,...l,focusable:!a,active:c,children:Qe.jsx(sr.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":d,"data-state":c?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:o,...n,ref:t,onMouseDown:Js(e.onMouseDown,e=>{a||0!==e.button||!1!==e.ctrlKey?e.preventDefault():i.onValueChange(r)}),onKeyDown:Js(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&i.onValueChange(r)}),onFocus:Js(e.onFocus,()=>{const e="manual"!==i.activationMode;c||a||!e||i.onValueChange(r)})})})});_c.displayName=Cc;var zc="TabsContent",Ec=s.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,forceMount:n,children:i,...l}=e,o=wc(zc,r),d=Rc(o.baseId,a),c=Tc(o.baseId,a),m=a===o.value,x=s.useRef(m);return s.useEffect(()=>{const e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),Qe.jsx(Io,{present:n||m,children:({present:s})=>Qe.jsx(sr.div,{"data-state":m?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":d,hidden:!s,id:c,tabIndex:0,...l,ref:t,style:{...e.style,animationDuration:x.current?"0s":void 0},children:s&&i})})});function Rc(e,t){return`${e}-trigger-${t}`}function Tc(e,t){return`${e}-content-${t}`}Ec.displayName=zc;var Dc=Nc,Ic=Sc,Lc=_c,Pc=Ec;function Mc({className:e,...t}){return Qe.jsx(Dc,{"data-slot":"tabs",className:Hs("flex flex-col gap-2",e),...t})}function Ac({className:e,...t}){return Qe.jsx(Ic,{"data-slot":"tabs-list",className:Hs("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",e),...t})}function Oc({className:e,...t}){return Qe.jsx(Lc,{"data-slot":"tabs-trigger",className:Hs("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function Wc({className:e,...t}){return Qe.jsx(Pc,{"data-slot":"tabs-content",className:Hs("flex-1 outline-none",e),...t})}function Bc(){const[e,t]=s.useState({salonName:"",city:"",address:"",phone:"",email:"",instagram:"",language:"ru",working_hours:{weekdays:"",weekends:""}}),[r,a]=s.useState(!0),[n,i]=s.useState({emailNotifications:!0,smsNotifications:!1,bookingNotifications:!0,birthdayReminders:!0,birthdayDaysAdvance:7}),[l,o]=s.useState([]),[d,c]=s.useState(!1),[m,x]=s.useState(!1),[u,h]=s.useState(!1),[p,g]=s.useState(null),[f,b]=s.useState({}),[y,j]=s.useState({}),[v,w]=s.useState(!1),[N,k]=s.useState({role_key:"",role_name:"",role_description:""});s.useEffect(()=>{_(),C()},[]);const C=async()=>{try{a(!0);const e=await Ct.getSalonSettings();t({salonName:e.name||"",city:e.city||"",address:e.address||"",phone:e.phone||"",email:e.email||"",instagram:e.instagram||"",language:e.language||"ru",working_hours:{weekdays:e.hours_weekdays||"",weekends:e.hours_weekends||""}})}catch(jx){gt.error("Ошибка загрузки настроек")}finally{a(!1)}},_=async()=>{try{c(!0);const e=await Ct.getRoles();o(e.roles||[])}catch(jx){}finally{c(!1)}};return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(S,{className:"w-8 h-8 text-pink-600"}),"Настройки системы"]}),Qe.jsx("p",{className:"text-gray-600",children:"Управление параметрами CRM"})]}),Qe.jsxs(Mc,{defaultValue:"general",className:"space-y-6",children:[Qe.jsxs(Ac,{className:"grid w-full grid-cols-4 lg:w-auto",children:[Qe.jsxs(Oc,{value:"general",className:"flex items-center gap-2",children:[Qe.jsx(ne,{className:"w-4 h-4"}),Qe.jsx("span",{className:"hidden sm:inline",children:"Общие"})]}),Qe.jsxs(Oc,{value:"notifications",className:"flex items-center gap-2",children:[Qe.jsx(ie,{className:"w-4 h-4"}),Qe.jsx("span",{className:"hidden sm:inline",children:"Уведомления"})]}),Qe.jsxs(Oc,{value:"roles",className:"flex items-center gap-2",children:[Qe.jsx(le,{className:"w-4 h-4"}),Qe.jsx("span",{className:"hidden sm:inline",children:"Роли"})]}),Qe.jsxs(Oc,{value:"security",className:"flex items-center gap-2",children:[Qe.jsx(le,{className:"w-4 h-4"}),Qe.jsx("span",{className:"hidden sm:inline",children:"Безопасность"})]})]}),Qe.jsx(Wc,{value:"general",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Основные настройки"}),r?Qe.jsx("div",{className:"flex items-center justify-center py-12",children:Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"})}):Qe.jsxs("form",{onSubmit:async t=>{t.preventDefault();try{await Ct.updateSalonSettings({name:e.salonName,city:e.city,address:e.address,phone:e.phone,email:e.email,instagram:e.instagram,language:e.language,hours_weekdays:e.working_hours.weekdays,hours_weekends:e.working_hours.weekends}),gt.success("Основные настройки сохранены ✅")}catch(jx){gt.error("Ошибка сервера")}},className:"space-y-6",children:[Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"salonName",children:"Название салона *"}),Qe.jsx(oo,{id:"salonName",value:e.salonName,onChange:s=>t({...e,salonName:s.target.value}),required:!0})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"language",children:"Язык системы"}),Qe.jsxs(to,{value:e.language,onValueChange:s=>t({...e,language:s}),children:[Qe.jsx(ro,{children:Qe.jsx(so,{})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"ru",children:"🇷🇺 Русский"}),Qe.jsx(no,{value:"en",children:"🇬🇧 English"}),Qe.jsx(no,{value:"ar",children:"🇦🇪 العربية"})]})]})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"city",children:"Город"}),Qe.jsx(oo,{id:"city",value:e.city,onChange:s=>t({...e,city:s.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"phone",children:"Телефон"}),Qe.jsx(oo,{id:"phone",type:"tel",value:e.phone,onChange:s=>t({...e,phone:s.target.value})})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"address",children:"Адрес"}),Qe.jsx(oo,{id:"address",value:e.address,onChange:s=>t({...e,address:s.target.value})})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"email",children:"Email"}),Qe.jsx(oo,{id:"email",type:"email",value:e.email,onChange:s=>t({...e,email:s.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"instagram",children:"Instagram"}),Qe.jsx(oo,{id:"instagram",value:e.instagram,onChange:s=>t({...e,instagram:s.target.value}),placeholder:"@username"})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"weekdays",children:"Часы работы (Пн-Пт)"}),Qe.jsx(oo,{id:"weekdays",value:e.working_hours.weekdays,onChange:s=>t({...e,working_hours:{...e.working_hours,weekdays:s.target.value}}),placeholder:"9:00 - 21:00"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"weekends",children:"Часы работы (Сб-Вс)"}),Qe.jsx(oo,{id:"weekends",value:e.working_hours.weekends,onChange:s=>t({...e,working_hours:{...e.working_hours,weekends:s.target.value}}),placeholder:"10:30 - 21:00"})]})]}),Qe.jsx(Ys,{type:"submit",className:"bg-gradient-to-r from-pink-500 to-purple-600",children:"Сохранить изменения"})]})]})}),Qe.jsx(Wc,{value:"notifications",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Настройки уведомлений"}),Qe.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{(await fetch("/api/notifications/settings",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok?gt.success("Уведомления настроены"):gt.error("Ошибка при сохранении")}catch(jx){gt.error("Ошибка сервера")}},className:"space-y-6",children:[Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"Каналы уведомлений"}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(oe,{className:"w-6 h-6 text-blue-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Email уведомления"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Получать уведомления на почту"})]})]}),Qe.jsx(Qd,{checked:n.emailNotifications,onCheckedChange:e=>i({...n,emailNotifications:e})})]}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(de,{className:"w-6 h-6 text-green-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"SMS уведомления"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Получать SMS на телефон"})]})]}),Qe.jsx(Qd,{checked:n.smsNotifications,onCheckedChange:e=>i({...n,smsNotifications:e})})]})]}),Qe.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"Типы уведомлений"}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Уведомления о записях"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Новые записи, изменения, отмены"})]}),Qe.jsx(Qd,{checked:n.bookingNotifications,onCheckedChange:e=>i({...n,bookingNotifications:e})})]}),Qe.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Напоминания о днях рождения"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Уведомления сотрудников о ДР клиентов"})]}),Qe.jsx(Qd,{checked:n.birthdayReminders,onCheckedChange:e=>i({...n,birthdayReminders:e})})]}),n.birthdayReminders&&Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"birthdayDays",children:"Напоминать за (дней)"}),Qe.jsxs(to,{value:n.birthdayDaysAdvance.toString(),onValueChange:e=>i({...n,birthdayDaysAdvance:parseInt(e)}),children:[Qe.jsx(ro,{children:Qe.jsx(so,{})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"3",children:"3 дня"}),Qe.jsx(no,{value:"7",children:"7 дней (неделя)"}),Qe.jsx(no,{value:"14",children:"14 дней (2 недели)"})]})]})]})]})]}),Qe.jsx(Ys,{type:"submit",className:"bg-gradient-to-r from-pink-500 to-purple-600",children:"Сохранить настройки уведомлений"})]})]})}),Qe.jsx(Wc,{value:"roles",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Qe.jsxs("div",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-2",children:"Управление ролями"}),Qe.jsx("p",{className:"text-gray-600",children:"Создавайте роли и назначайте права доступа"})]}),Qe.jsxs(Ys,{onClick:()=>x(!0),className:"bg-pink-600 hover:bg-pink-700",children:[Qe.jsx(B,{className:"w-4 h-4 mr-2"}),"Создать роль"]})]}),Qe.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-blue-800 font-medium text-sm mb-2",children:"О системе ролей:"}),Qe.jsxs("ul",{className:"text-blue-700 text-sm space-y-1 list-disc list-inside",children:[Qe.jsx("li",{children:"Создавайте кастомные роли под нужды вашего бизнеса"}),Qe.jsx("li",{children:"Назначайте детальные права: просмотр, создание, редактирование, удаление"}),Qe.jsx("li",{children:"Встроенные роли (Админ, Менеджер, Сотрудник) нельзя удалить"})]})]})]})}),d?Qe.jsx("div",{className:"flex items-center justify-center py-12",children:Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"})}):Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(e=>Qe.jsxs("div",{className:"relative bg-gradient-to-br from-gray-50 to-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-shadow",children:[!e.is_custom&&Qe.jsx("div",{className:"absolute top-4 right-4 px-3 py-1 bg-yellow-100 border border-yellow-200 rounded-full text-xs font-semibold text-yellow-800",children:"Встроенная"}),Qe.jsxs("div",{className:"mb-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center mb-4",children:Qe.jsx(le,{className:"w-6 h-6 text-pink-600"})}),Qe.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:e.name}),Qe.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description})]}),Qe.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-200",children:[Qe.jsxs(Ys,{size:"sm",variant:"outline",onClick:()=>(async e=>{try{g(e),h(!0);const t=await Ct.getRolePermissions(e.key);b(t.permissions||{}),j(t.available_permissions||{})}catch(jx){gt.error(`❌ Ошибка: ${jx.message}`)}})(e),className:"flex-1",children:[Qe.jsx(Z,{className:"w-4 h-4 mr-1"}),"Права"]}),e.is_custom&&Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>(async(e,t)=>{if(confirm(`Удалить роль "${t}"?`))try{await Ct.deleteRole(e),gt.success("✅ Роль удалена"),await _()}catch(jx){gt.error(`❌ Ошибка: ${jx.message}`)}})(e.key,e.name),className:"text-red-600 hover:text-red-700",children:Qe.jsx(Q,{className:"w-4 h-4"})})]})]},e.key))})]})}),Qe.jsx(Wc,{value:"security",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Безопасность и доступ"}),Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsx("div",{className:"p-6 bg-yellow-50 border border-yellow-200 rounded-lg",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(le,{className:"w-6 h-6 text-yellow-600 flex-shrink-0 mt-1"}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-sm text-gray-900 mb-2 font-semibold",children:"Рекомендации по безопасности"}),Qe.jsxs("ul",{className:"text-sm text-gray-700 space-y-2",children:[Qe.jsx("li",{children:"• Используйте сложные пароли (минимум 8 символов)"}),Qe.jsx("li",{children:"• Регулярно меняйте пароли сотрудников"}),Qe.jsx("li",{children:"• Не передавайте учетные данные третьим лицам"}),Qe.jsx("li",{children:"• Проверяйте активные сессии пользователей"}),Qe.jsx("li",{children:"• Регулярно создавайте резервные копии данных"})]})]})]})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"Резервное копирование"}),Qe.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Скачайте резервную копию всех данных системы для безопасности"}),Qe.jsx(Ys,{variant:"outline",children:"📥 Скачать резервную копию"})]})]})]})})]}),m&&Qe.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Qe.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full shadow-2xl",children:[Qe.jsx("div",{className:"p-6 border-b border-gray-200",children:Qe.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Создать роль"})}),Qe.jsxs("div",{className:"p-6 space-y-4",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"roleKey",children:"Ключ роли (латиница) *"}),Qe.jsx(oo,{id:"roleKey",placeholder:"senior_master",value:N.role_key,onChange:e=>k({...N,role_key:e.target.value.toLowerCase().replace(/\s+/g,"_")})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"roleName",children:"Название роли *"}),Qe.jsx(oo,{id:"roleName",placeholder:"Старший мастер",value:N.role_name,onChange:e=>k({...N,role_name:e.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"roleDesc",children:"Описание"}),Qe.jsx(_d,{id:"roleDesc",placeholder:"Описание роли...",value:N.role_description,onChange:e=>k({...N,role_description:e.target.value}),rows:3})]})]}),Qe.jsxs("div",{className:"p-6 border-t border-gray-200 flex gap-3",children:[Qe.jsx(Ys,{variant:"outline",onClick:()=>x(!1),className:"flex-1",children:"Отмена"}),Qe.jsx(Ys,{onClick:async()=>{if(N.role_key&&N.role_name)try{w(!0),await Ct.createRole(N),gt.success("✅ Роль создана! Теперь настройте права доступа."),x(!1),k({role_key:"",role_name:"",role_description:""}),await _()}catch(jx){gt.error(`❌ Ошибка: ${jx.message}`)}finally{w(!1)}else gt.error("Заполните обязательные поля")},disabled:v,className:"flex-1 bg-pink-600 hover:bg-pink-700",children:v?"Создание...":"Создать"})]})]})}),u&&p&&Qe.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-auto",children:Qe.jsxs("div",{className:"bg-white rounded-xl max-w-4xl w-full shadow-2xl max-h-[90vh] overflow-auto",children:[Qe.jsxs("div",{className:"p-6 border-b border-gray-200 sticky top-0 bg-white z-10",children:[Qe.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Права роли: ",p.name]}),Qe.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Настройте детальные права доступа"})]}),Qe.jsx("div",{className:"p-6",children:Qe.jsx("div",{className:"overflow-x-auto",children:Qe.jsxs("table",{className:"w-full border-collapse",children:[Qe.jsx("thead",{children:Qe.jsxs("tr",{className:"bg-gray-50",children:[Qe.jsx("th",{className:"p-3 text-left text-sm font-semibold text-gray-600 border-b",children:"Ресурс"}),Qe.jsx("th",{className:"p-3 text-center text-sm font-semibold text-gray-600 border-b",children:"Просмотр"}),Qe.jsx("th",{className:"p-3 text-center text-sm font-semibold text-gray-600 border-b",children:"Создание"}),Qe.jsx("th",{className:"p-3 text-center text-sm font-semibold text-gray-600 border-b",children:"Редактирование"}),Qe.jsx("th",{className:"p-3 text-center text-sm font-semibold text-gray-600 border-b",children:"Удаление"})]})}),Qe.jsx("tbody",{children:Object.entries(y).map(([e,t])=>Qe.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[Qe.jsx("td",{className:"p-3 text-sm font-medium text-gray-900",children:t}),["can_view","can_create","can_edit","can_delete"].map(t=>Qe.jsx("td",{className:"p-3 text-center",children:Qe.jsx("input",{type:"checkbox",checked:f[e]?.[t]||!1,onChange:()=>((e,t)=>{b(s=>({...s,[e]:{...s[e]||{},[t]:!s[e]?.[t]}}))})(e,t),className:"w-5 h-5 cursor-pointer accent-pink-600"})},t))]},e))})]})})}),Qe.jsxs("div",{className:"p-6 border-t border-gray-200 flex gap-3 sticky bottom-0 bg-white",children:[Qe.jsx(Ys,{variant:"outline",onClick:()=>h(!1),className:"flex-1",children:"Отмена"}),Qe.jsx(Ys,{onClick:async()=>{try{w(!0),await Ct.updateRolePermissions(p.key,f),gt.success("✅ Права обновлены"),h(!1)}catch(jx){gt.error(`❌ Ошибка: ${jx.message}`)}finally{w(!1)}},disabled:v,className:"flex-1 bg-pink-600 hover:bg-pink-700",children:v?"Сохранение...":"Сохранить права"})]})]})})]})}const Fc=[{code:"ru",name:"Русский",flag:"🇷🇺",note:"основной"},{code:"en",name:"English",flag:"🇬🇧",note:"international"},{code:"ar",name:"العربية",flag:"🇸🇦",note:"местный"},{code:"hi",name:"हिन्दी",flag:"🇮🇳",note:"индийцы"},{code:"ur",name:"اردو",flag:"🇵🇰",note:"пакистанцы"},{code:"tl",name:"Filipino",flag:"🇵🇭",note:"филиппинцы"}];function $c(){const[e,t]=s.useState("general"),[r,a]=s.useState(!0),[n,i]=s.useState(!1),[l,o]=s.useState({bot_name:"",personality_traits:"",greeting_message:"",farewell_message:"",price_explanation:"",price_response_template:"",premium_justification:"",booking_redirect_message:"",fomo_messages:"",upsell_techniques:"",communication_style:"",max_message_length:4,emoji_usage:"",languages_supported:"ru,en,ar",objection_expensive:"",objection_think_about_it:"",objection_no_time:"",objection_pain:"",objection_result_doubt:"",objection_cheaper_elsewhere:"",objection_too_far:"",objection_consult_husband:"",objection_first_time:"",objection_not_happy:"",emotional_triggers:"",social_proof_phrases:"",personalization_rules:"",example_dialogues:"",emotional_responses:"",anti_patterns:"",voice_message_response:"",contextual_rules:"",safety_guidelines:"",example_good_responses:"",algorithm_actions:"",location_features:"",seasonality:"",emergency_situations:"",success_metrics:""}),[d,c]=s.useState(["ru","en","ar"]);s.useEffect(()=>{m()},[]),s.useEffect(()=>{o(e=>({...e,languages_supported:d.join(",")}))},[d]);const m=async()=>{try{a(!0);const e=await Ct.getBotSettings(),t=e.languages_supported?e.languages_supported.split(","):["ru","en","ar"];c(t),o({bot_name:e.bot_name||"M.Le Diamant Assistant",personality_traits:e.personality_traits||"",greeting_message:e.greeting_message||"",farewell_message:e.farewell_message||"",price_explanation:e.price_explanation||"",price_response_template:e.price_response_template||"",premium_justification:e.premium_justification||"",booking_redirect_message:e.booking_redirect_message||"",fomo_messages:e.fomo_messages||"",upsell_techniques:e.upsell_techniques||"",communication_style:e.communication_style||"",max_message_length:e.max_message_length||4,emoji_usage:e.emoji_usage||"",languages_supported:t.join(","),objection_expensive:e.objection_expensive||"",objection_think_about_it:e.objection_think_about_it||"",objection_no_time:e.objection_no_time||"",objection_pain:e.objection_pain||"",objection_result_doubt:e.objection_result_doubt||"",objection_cheaper_elsewhere:e.objection_cheaper_elsewhere||"",objection_too_far:e.objection_too_far||"",objection_consult_husband:e.objection_consult_husband||"",objection_first_time:e.objection_first_time||"",objection_not_happy:e.objection_not_happy||"",emotional_triggers:e.emotional_triggers||"",social_proof_phrases:e.social_proof_phrases||"",personalization_rules:e.personalization_rules||"",example_dialogues:e.example_dialogues||"",emotional_responses:e.emotional_responses||"",anti_patterns:e.anti_patterns||"",voice_message_response:e.voice_message_response||"",contextual_rules:e.contextual_rules||"",safety_guidelines:e.safety_guidelines||"",example_good_responses:e.example_good_responses||"",algorithm_actions:e.algorithm_actions||"",location_features:e.location_features||"",seasonality:e.seasonality||"",emergency_situations:e.emergency_situations||"",success_metrics:e.success_metrics||""})}catch(jx){gt.error("Ошибка загрузки настроек: "+(jx instanceof Error?jx.message:"Неизвестная ошибка"))}finally{a(!1)}},x=async()=>{try{i(!0),await Ct.updateBotSettings(l),await fetch("https://mlediamant.com/api/bot-settings/reload",{method:"POST",credentials:"include"}),gt.success("✅ Настройки сохранены и бот перезагружен!")}catch(jx){gt.error("❌ Ошибка: "+jx.message)}finally{i(!1)}},u=[{id:"general",label:"Основное",icon:Qe.jsx(ce,{size:18})},{id:"personality",label:"Личность",icon:Qe.jsx(me,{size:18})},{id:"pricing",label:"Цены",icon:Qe.jsx(T,{size:18})},{id:"objections",label:"Возражения",icon:Qe.jsx(xe,{size:18})},{id:"communication",label:"Общение",icon:Qe.jsx(j,{size:18})},{id:"advanced",label:"Продвинутое",icon:Qe.jsx(ue,{size:18})},{id:"safety",label:"Безопасность",icon:Qe.jsx(le,{size:18})},{id:"examples",label:"Примеры",icon:Qe.jsx(he,{size:18})}];return r?Qe.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[Qe.jsx("div",{className:"inline-block animate-spin w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full"}),Qe.jsx("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Загрузка..."})]}):Qe.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"#f9fafb",minHeight:"100vh"},children:[Qe.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},children:[Qe.jsxs("div",{children:[Qe.jsx("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#111827",marginBottom:"0.25rem"},children:"🤖 Настройки бота"}),Qe.jsx("p",{style:{color:"#6b7280",fontSize:"0.875rem"},children:"Полная конфигурация AI-ассистента"})]}),Qe.jsxs("button",{onClick:x,disabled:n,style:{padding:"0.75rem 1.5rem",backgroundColor:n?"#9ca3af":"#2563eb",color:"#fff",border:"none",borderRadius:"0.5rem",fontWeight:"600",cursor:n?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.5rem"},children:[Qe.jsx(se,{size:18}),n?"Сохранение...":"Сохранить"]})]}),Qe.jsx("div",{style:{backgroundColor:"#fff",borderRadius:"0.75rem",border:"1px solid #e5e7eb",marginBottom:"1.5rem",padding:"0.5rem",display:"flex",gap:"0.5rem",overflowX:"auto"},children:u.map(s=>Qe.jsxs("button",{onClick:()=>t(s.id),style:{padding:"0.625rem 1rem",backgroundColor:e===s.id?"#ede9fe":"transparent",border:e===s.id?"2px solid #a78bfa":"2px solid transparent",borderRadius:"0.5rem",color:e===s.id?"#6b21a8":"#6b7280",fontWeight:e===s.id?"600":"500",fontSize:"0.875rem",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",whiteSpace:"nowrap"},children:[s.icon,s.label]},s.id))}),Qe.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"0.75rem",border:"1px solid #e5e7eb",padding:"2rem"},children:["general"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"🏢 Основная информация"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Имя бота"}),Qe.jsx("input",{type:"text",value:l.bot_name,onChange:e=>o({...l,bot_name:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"📏 Макс. длина сообщения (предложений)"}),Qe.jsx("input",{type:"number",min:"1",max:"10",value:l.max_message_length,onChange:e=>o({...l,max_message_length:parseInt(e.target.value)||4}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.75rem"},children:"🌍 Поддерживаемые языки"}),Qe.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},children:Fc.map(e=>Qe.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem",border:d.includes(e.code)?"2px solid #a78bfa":"2px solid #e5e7eb",borderRadius:"0.5rem",backgroundColor:d.includes(e.code)?"#f3e8ff":"#fff",cursor:"pointer"},children:[Qe.jsx("input",{type:"checkbox",checked:d.includes(e.code),onChange:()=>{return t=e.code,void c(e=>e.includes(t)?1===e.length?(gt.error("Должен быть выбран хотя бы один язык"),e):e.filter(e=>e!==t):[...e,t]);var t},style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#a78bfa"}}),Qe.jsxs("div",{children:[Qe.jsxs("div",{style:{fontWeight:"600",color:"#374151"},children:[e.flag," ",e.name]}),Qe.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280"},children:e.note})]})]},e.code))})]})]}),"personality"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"✨ Личность бота"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"Черты характера"}),Qe.jsx("textarea",{value:l.personality_traits,onChange:e=>o({...l,personality_traits:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"👋 Приветствие"}),Qe.jsx("textarea",{value:l.greeting_message,onChange:e=>o({...l,greeting_message:e.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"👋 Прощание"}),Qe.jsx("textarea",{value:l.farewell_message,onChange:e=>o({...l,farewell_message:e.target.value}),rows:2,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🎨 Стиль общения"}),Qe.jsx("textarea",{value:l.communication_style,onChange:e=>o({...l,communication_style:e.target.value}),rows:4,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"😊 Эмодзи"}),Qe.jsx("input",{type:"text",value:l.emoji_usage,onChange:e=>o({...l,emoji_usage:e.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box"}})]})]}),"pricing"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"💰 Работа с ценами"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"💎 Объяснение премиум-цен"}),Qe.jsx("textarea",{value:l.price_explanation,onChange:e=>o({...l,price_explanation:e.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"📝 Шаблон ответа на цену"}),Qe.jsx("textarea",{value:l.price_response_template,onChange:e=>o({...l,price_response_template:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical",fontFamily:"monospace"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🛡️ Обоснование высоких цен"}),Qe.jsx("textarea",{value:l.premium_justification,onChange:e=>o({...l,premium_justification:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"⚡ FOMO сообщения (разделяйте |)"}),Qe.jsx("textarea",{value:l.fomo_messages,onChange:e=>o({...l,fomo_messages:e.target.value}),rows:4,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🚀 Upsell техники (разделяйте |)"}),Qe.jsx("textarea",{value:l.upsell_techniques,onChange:e=>o({...l,upsell_techniques:e.target.value}),rows:4,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"📱 Сообщение о записи"}),Qe.jsx("textarea",{value:l.booking_redirect_message,onChange:e=>o({...l,booking_redirect_message:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]})]}),"objections"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"🛡️ Работа с возражениями"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'💸 "Дорого"'}),Qe.jsx("textarea",{value:l.objection_expensive,onChange:e=>o({...l,objection_expensive:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'🤔 "Подумаю"'}),Qe.jsx("textarea",{value:l.objection_think_about_it,onChange:e=>o({...l,objection_think_about_it:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'⏰ "Нет времени"'}),Qe.jsx("textarea",{value:l.objection_no_time,onChange:e=>o({...l,objection_no_time:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'😰 "Боюсь боли"'}),Qe.jsx("textarea",{value:l.objection_pain,onChange:e=>o({...l,objection_pain:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'❓ "Не уверен в результате"'}),Qe.jsx("textarea",{value:l.objection_result_doubt,onChange:e=>o({...l,objection_result_doubt:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'🏪 "У других дешевле"'}),Qe.jsx("textarea",{value:l.objection_cheaper_elsewhere,onChange:e=>o({...l,objection_cheaper_elsewhere:e.target.value}),rows:7,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'🚗 "Слишком далеко"'}),Qe.jsx("textarea",{value:l.objection_too_far,onChange:e=>o({...l,objection_too_far:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'💑 "Посоветуюсь с мужем"'}),Qe.jsx("textarea",{value:l.objection_consult_husband,onChange:e=>o({...l,objection_consult_husband:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'🆕 "Первый раз"'}),Qe.jsx("textarea",{value:l.objection_first_time,onChange:e=>o({...l,objection_first_time:e.target.value}),rows:7,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:'😟 "А если не понравится?"'}),Qe.jsx("textarea",{value:l.objection_not_happy,onChange:e=>o({...l,objection_not_happy:e.target.value}),rows:7,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]})]}),"communication"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"💬 Общение и эмоции"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"💖 Эмоциональные триггеры"}),Qe.jsx("textarea",{value:l.emotional_triggers,onChange:e=>o({...l,emotional_triggers:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"⭐ Социальное доказательство"}),Qe.jsx("textarea",{value:l.social_proof_phrases,onChange:e=>o({...l,social_proof_phrases:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"👤 Правила персонализации"}),Qe.jsx("textarea",{value:l.personalization_rules,onChange:e=>o({...l,personalization_rules:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"😊 Эмоциональные ответы"}),Qe.jsx("textarea",{value:l.emotional_responses,onChange:e=>o({...l,emotional_responses:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🎙️ Ответ на голосовые"}),Qe.jsx("textarea",{value:l.voice_message_response,onChange:e=>o({...l,voice_message_response:e.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"❌ Антипаттерны (что НЕ делать)"}),Qe.jsx("textarea",{value:l.anti_patterns,onChange:e=>o({...l,anti_patterns:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]})]}),"advanced"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"🎓 Продвинутые настройки"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"📋 Алгоритм действий"}),Qe.jsx("textarea",{value:l.algorithm_actions,onChange:e=>o({...l,algorithm_actions:e.target.value}),rows:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"📍 Особенности локации"}),Qe.jsx("textarea",{value:l.location_features,onChange:e=>o({...l,location_features:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🌡️ Сезонность"}),Qe.jsx("textarea",{value:l.seasonality,onChange:e=>o({...l,seasonality:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🌍 Контекстные правила"}),Qe.jsx("textarea",{value:l.contextual_rules,onChange:e=>o({...l,contextual_rules:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"📊 Метрики успеха"}),Qe.jsx("textarea",{value:l.success_metrics,onChange:e=>o({...l,success_metrics:e.target.value}),rows:5,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]})]}),"safety"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"🛡️ Безопасность и этика"}),Qe.jsxs("div",{style:{backgroundColor:"#dbeafe",border:"1px solid #93c5fd",borderRadius:"0.5rem",padding:"1rem",display:"flex",gap:"0.75rem"},children:[Qe.jsx(le,{size:20,color:"#1e40af",style:{flexShrink:0,marginTop:"0.125rem"}}),Qe.jsxs("div",{children:[Qe.jsx("p",{style:{fontSize:"0.875rem",color:"#1e40af",fontWeight:"600",marginBottom:"0.25rem"},children:"Важно для безопасности:"}),Qe.jsx("p",{style:{fontSize:"0.875rem",color:"#1e40af"},children:"Эти правила защищают клиентов и репутацию салона"})]})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🔒 Правила безопасности"}),Qe.jsx("textarea",{value:l.safety_guidelines,onChange:e=>o({...l,safety_guidelines:e.target.value}),rows:10,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"🚨 Экстренные ситуации"}),Qe.jsx("textarea",{value:l.emergency_situations,onChange:e=>o({...l,emergency_situations:e.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]})]}),"examples"===e&&Qe.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[Qe.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:"700",color:"#111827"},children:"💡 Примеры и диалоги"}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"✅ Примеры хороших ответов"}),Qe.jsx("textarea",{value:l.example_good_responses,onChange:e=>o({...l,example_good_responses:e.target.value}),rows:8,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical"}})]}),Qe.jsxs("div",{children:[Qe.jsx("label",{style:{display:"block",fontWeight:"600",color:"#374151",marginBottom:"0.5rem"},children:"💬 Примеры диалогов"}),Qe.jsx("textarea",{value:l.example_dialogues,onChange:e=>o({...l,example_dialogues:e.target.value}),rows:15,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"0.5rem",fontSize:"0.95rem",boxSizing:"border-box",resize:"vertical",fontFamily:"monospace"}}),Qe.jsx("p",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.5rem"},children:"Примеры реальных диалогов для обучения бота"})]})]})]}),Qe.jsx("div",{style:{position:"fixed",bottom:"2rem",right:"2rem",zIndex:50},children:Qe.jsxs("button",{onClick:x,disabled:n,style:{padding:"1rem 2rem",backgroundColor:n?"#9ca3af":"#2563eb",color:"#fff",border:"none",borderRadius:"9999px",fontWeight:"600",cursor:n?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"0.75rem",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",fontSize:"1rem"},children:[Qe.jsx(se,{size:20}),n?"Сохранение...":"Сохранить всё"]})})]})}function Uc({user:e,onLogout:t}){const a=n(),o=i(),[d,c]=r.useState(!1),[x,u]=s.useState(0),h=[{icon:f,label:"Панель управления",path:"/manager/dashboard"},{icon:xe,label:"Чат",path:"/manager/chat",badge:x},{icon:y,label:"Клиенты",path:"/manager/clients"},{icon:v,label:"Аналитика",path:"/manager/analytics"},{icon:pe,label:"Воронка продаж",path:"/manager/funnel"},{icon:S,label:"Настройки",path:"/manager/settings"}];s.useEffect(()=>{p();const e=setInterval(p,1e4);return()=>clearInterval(e)},[]);const p=async()=>{try{const e=await Ct.getUnreadCount();u(e.count||0)}catch(jx){}};return Qe.jsxs("div",{className:"flex h-screen bg-gray-50",children:[Qe.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[Qe.jsxs("div",{className:"p-6 border-b border-gray-200",children:[Qe.jsx("h1",{className:"text-2xl text-pink-600",children:"Beauty Salon CRM"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Менеджер"})]}),Qe.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:Qe.jsx("ul",{className:"space-y-1",children:h.map(e=>{const t=e.icon,s=a.pathname===e.path;return Qe.jsx("li",{children:Qe.jsxs(m,{to:e.path,className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors relative "+(s?"bg-pink-50 text-pink-600":"text-gray-700 hover:bg-gray-50"),children:[Qe.jsx(t,{className:"w-5 h-5"}),Qe.jsx("span",{children:e.label}),e.badge&&e.badge>0&&Qe.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center animate-pulse",children:e.badge>99?"99+":e.badge})]})},e.path)})})}),Qe.jsxs("div",{className:"p-4 border-t border-gray-200",children:[Qe.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[Qe.jsx("div",{className:"w-10 h-10 bg-pink-600 rounded-full flex items-center justify-center text-white",children:e?.full_name?.charAt(0)||"M"}),Qe.jsxs("div",{className:"flex-1 min-w-0",children:[Qe.jsx("p",{className:"text-sm truncate",children:e?.full_name||"Менеджер"}),Qe.jsx("p",{className:"text-xs text-gray-500",children:"Менеджер"})]})]}),Qe.jsxs("button",{onClick:async()=>{c(!0);try{if(!(await fetch("/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Logout failed");localStorage.removeItem("session_token"),localStorage.removeItem("user"),t(),o("/login",{replace:!0}),gt.success("Вы успешно вышли из системы")}catch(jx){localStorage.removeItem("session_token"),localStorage.removeItem("user"),t(),o("/login",{replace:!0})}finally{c(!1)}},disabled:d,className:"w-full flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",children:[Qe.jsx(_,{className:"w-4 h-4"}),Qe.jsx("span",{children:d?"Выход...":"Выйти"})]})]})]}),Qe.jsx("main",{className:"flex-1 overflow-y-auto",children:Qe.jsx(l,{})})]})}function qc(){const[e,t]=s.useState(null),[r,a]=s.useState(null),[n,i]=s.useState(!0),[l,o]=s.useState(null);s.useEffect(()=>{d()},[]);const d=async()=>{try{i(!0),o(null);const[e,s]=await Promise.all([Ct.getStats(),Ct.getFunnel()]);t(e),a(s)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки данных";o(t),gt.error(`Ошибка: ${t}`)}finally{i(!1)}};return n?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка данных..."})]})}):l?Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:l}),Qe.jsx(Ys,{onClick:d,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})}):Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsx("h1",{className:"text-3xl text-gray-900 mb-2",children:"Панель менеджера"}),Qe.jsx("p",{className:"text-gray-600",children:"Управление клиентами и сообщениями"})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[Qe.jsxs(m,{to:"/manager/chat",className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[Qe.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4",children:Qe.jsx(j,{className:"w-6 h-6 text-blue-600"})}),Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-1",children:e?.total_client_messages||0}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:"Сообщений от клиентов"})]}),e&&e.total_client_messages>0&&Qe.jsxs(Do,{className:"bg-blue-100 text-blue-800",children:["+",Math.floor(.1*e.total_client_messages)]})]})]}),Qe.jsxs(m,{to:"/admin/clients",className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[Qe.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4",children:Qe.jsx(y,{className:"w-6 h-6 text-green-600"})}),Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-1",children:e?.total_clients||0}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:"Всего клиентов"})]}),e&&e.new_clients>0&&Qe.jsxs(Do,{className:"bg-green-100 text-green-800",children:["+",e.new_clients]})]})]}),Qe.jsxs(m,{to:"/manager/funnel",className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[Qe.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4",children:Qe.jsx(D,{className:"w-6 h-6 text-purple-600"})}),Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsxs("h3",{className:"text-2xl text-gray-900 mb-1",children:[e?.conversion_rate.toFixed(1),"%"]}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:"Конверсия"})]}),Qe.jsx(Do,{className:"bg-purple-100 text-purple-800",children:e&&e.conversion_rate>15?"Хорошо":"Норма"})]})]}),Qe.jsxs(m,{to:"/admin/bookings",className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[Qe.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center mb-4",children:Qe.jsx(f,{className:"w-6 h-6 text-pink-600"})}),Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-1",children:e?.total_bookings||0}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:"Всего записей"})]}),e&&e.pending_bookings>0&&Qe.jsxs(Do,{className:"bg-pink-100 text-pink-800",children:[e.pending_bookings," ожидают"]})]})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-4",children:"Быстрые действия"}),Qe.jsxs("div",{className:"space-y-3",children:[Qe.jsx(m,{to:"/manager/chat",children:Qe.jsxs(Ys,{className:"w-full justify-between bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700",children:[Qe.jsxs("span",{className:"flex items-center gap-2",children:[Qe.jsx(j,{className:"w-5 h-5"}),"Открыть чат"]}),Qe.jsx(ge,{className:"w-5 h-5"})]})}),Qe.jsx(m,{to:"/manager/messages",children:Qe.jsxs(Ys,{className:"w-full justify-between bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700",children:[Qe.jsxs("span",{className:"flex items-center gap-2",children:[Qe.jsx(xe,{className:"w-5 h-5"}),"Сообщения"]}),Qe.jsx(ge,{className:"w-5 h-5"})]})}),Qe.jsx(m,{to:"/manager/funnel",children:Qe.jsxs(Ys,{className:"w-full justify-between bg-gradient-to-r from-pink-500 to-pink-600 hover:from-pink-600 hover:to-pink-700",children:[Qe.jsxs("span",{className:"flex items-center gap-2",children:[Qe.jsx(pe,{className:"w-5 h-5"}),"Воронка продаж"]}),Qe.jsx(ge,{className:"w-5 h-5"})]})}),Qe.jsx(m,{to:"/admin/clients",children:Qe.jsxs(Ys,{className:"w-full justify-between bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700",children:[Qe.jsxs("span",{className:"flex items-center gap-2",children:[Qe.jsx(y,{className:"w-5 h-5"}),"База клиентов"]}),Qe.jsx(ge,{className:"w-5 h-5"})]})})]})]}),Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-4",children:"Ключевые метрики"}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Активных клиентов"}),Qe.jsx("p",{className:"text-2xl text-gray-900 font-medium",children:e?.customers||0})]}),Qe.jsx(D,{className:"w-6 h-6 text-blue-600"})]}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Завершённых процедур"}),Qe.jsx("p",{className:"text-2xl text-gray-900 font-medium",children:e?.completed_bookings||0})]}),Qe.jsx(D,{className:"w-6 h-6 text-green-600"})]}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-pink-50 rounded-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Общий доход"}),Qe.jsxs("p",{className:"text-2xl text-gray-900 font-medium",children:[(e?.total_revenue||0).toFixed(0)," AED"]})]}),Qe.jsx(D,{className:"w-6 h-6 text-pink-600"})]})]})]})]}),r&&Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsxs("h2",{className:"text-xl text-gray-900 mb-6 flex items-center gap-2",children:[Qe.jsx(pe,{className:"w-6 h-6 text-pink-600"}),"Воронка продаж"]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[Qe.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Посетители"}),Qe.jsx("p",{className:"text-3xl text-gray-900 mb-1",children:r.visitors}),Qe.jsx("p",{className:"text-xs text-gray-500",children:"100%"})]}),Qe.jsxs("div",{className:"bg-cyan-50 p-4 rounded-lg",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Вовлечённые"}),Qe.jsx("p",{className:"text-3xl text-gray-900 mb-1",children:r.engaged}),Qe.jsxs("p",{className:"text-xs text-gray-500",children:[(r.engaged/r.visitors*100).toFixed(1),"%"]})]}),Qe.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Начали запись"}),Qe.jsx("p",{className:"text-3xl text-gray-900 mb-1",children:r.started_booking}),Qe.jsxs("p",{className:"text-xs text-gray-500",children:[(r.started_booking/r.visitors*100).toFixed(1),"%"]})]}),Qe.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Записались"}),Qe.jsx("p",{className:"text-3xl text-gray-900 mb-1",children:r.booked}),Qe.jsxs("p",{className:"text-xs text-gray-500",children:[(r.booked/r.visitors*100).toFixed(1),"%"]})]}),Qe.jsxs("div",{className:"bg-pink-50 p-4 rounded-lg",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Завершено"}),Qe.jsx("p",{className:"text-3xl text-gray-900 mb-1",children:r.completed}),Qe.jsxs("p",{className:"text-xs text-gray-500",children:[(r.completed/r.visitors*100).toFixed(1),"%"]})]})]}),Qe.jsx(m,{to:"/manager/funnel",className:"mt-4",children:Qe.jsxs(Ys,{className:"bg-pink-600 hover:bg-pink-700",children:["Подробно о воронке",Qe.jsx(ge,{className:"w-4 h-4 ml-2"})]})})]})]})}function Hc({onSelect:e}){const[t,r]=s.useState([]),[a,n]=s.useState(!1),[i,l]=s.useState(null),[o,d]=s.useState(!1),[c,m]=s.useState({name:"",content:"",category:"general"});s.useEffect(()=>{x()},[]);const x=async()=>{try{d(!0);const e=await Ct.getMessageTemplates();r(e.templates||[])}catch(jx){gt.error("Ошибка загрузки шаблонов")}finally{d(!1)}},u=t.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return Qe.jsx("div",{className:"border-t bg-white",children:Qe.jsxs("div",{className:"p-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Qe.jsxs("h4",{className:"font-semibold flex items-center gap-2 text-gray-900",children:[Qe.jsx(O,{className:"w-4 h-4 text-pink-600"}),"Шаблоны сообщений"]}),Qe.jsx(Ys,{size:"sm",variant:"ghost",onClick:()=>{n(!a),l(null),a||m({name:"",content:"",category:"general"})},className:"h-8 w-8 p-0",children:a?Qe.jsx(g,{className:"w-4 h-4"}):Qe.jsx(B,{className:"w-4 h-4"})})]}),(a||i)&&Qe.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-br from-pink-50 to-purple-50 rounded-lg space-y-2 border border-pink-200",children:[Qe.jsx(oo,{placeholder:"Название шаблона",value:c.name,onChange:e=>m({...c,name:e.target.value}),className:"bg-white"}),Qe.jsx(_d,{placeholder:"Текст шаблона",value:c.content,onChange:e=>m({...c,content:e.target.value}),className:"bg-white min-h-[80px]",rows:3}),Qe.jsxs("select",{value:c.category,onChange:e=>m({...c,category:e.target.value}),className:"w-full px-3 py-2 border rounded bg-white text-sm",children:[Qe.jsx("option",{value:"general",children:"Общие"}),Qe.jsx("option",{value:"greetings",children:"Приветствия"}),Qe.jsx("option",{value:"booking",children:"Запись"}),Qe.jsx("option",{value:"info",children:"Информация"}),Qe.jsx("option",{value:"closing",children:"Завершение"}),Qe.jsx("option",{value:"followup",children:"Followup"})]}),Qe.jsxs("div",{className:"flex gap-2",children:[Qe.jsx(Ys,{onClick:()=>i?(async e=>{try{d(!0),await Ct.updateMessageTemplate(e,c),gt.success("Шаблон обновлен"),l(null),m({name:"",content:"",category:"general"}),x()}catch(jx){gt.error("Ошибка обновления")}finally{d(!1)}})(i):(async()=>{if(c.name.trim()&&c.content.trim())try{d(!0),await Ct.createMessageTemplate(c),gt.success("Шаблон создан"),n(!1),m({name:"",content:"",category:"general"}),x()}catch(jx){gt.error("Ошибка создания шаблона")}finally{d(!1)}else gt.error("Заполните все поля")})(),disabled:o,className:"flex-1 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 text-white",size:"sm",children:i?"Обновить":"Создать"}),i&&Qe.jsx(Ys,{onClick:()=>{l(null),m({name:"",content:"",category:"general"})},variant:"outline",size:"sm",children:"Отмена"})]})]}),Qe.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:o&&0===t.length?Qe.jsxs("div",{className:"text-center py-4 text-gray-500",children:[Qe.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-pink-600 border-t-transparent rounded-full mx-auto mb-2"}),"Загрузка..."]}):Object.keys(u).length>0?Object.entries(u).map(([t,s])=>Qe.jsxs("div",{className:"space-y-2",children:[Qe.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"general"===t?"Общие":"greetings"===t?"Приветствия":"booking"===t?"Запись":"info"===t?"Информация":"closing"===t?"Завершение":"followup"===t?"Followup":t}),s.map(t=>Qe.jsxs("div",{className:"group relative",children:[Qe.jsxs("button",{onClick:()=>e(t.content),className:"w-full text-left p-3 border rounded-lg hover:bg-gradient-to-r hover:from-pink-50 hover:to-purple-50 hover:border-pink-300 transition-all",children:[Qe.jsx("p",{className:"font-medium text-sm text-gray-900",children:t.name}),Qe.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:t.content})]}),Qe.jsxs("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[Qe.jsx("button",{onClick:e=>{e.stopPropagation(),(e=>{l(e.id),m({name:e.name,content:e.content,category:e.category}),n(!1)})(t)},className:"p-1 bg-blue-100 hover:bg-blue-200 rounded text-blue-600",title:"Редактировать",children:Qe.jsx(J,{className:"w-3 h-3"})}),Qe.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(confirm("Удалить этот шаблон?"))try{await Ct.deleteMessageTemplate(e),gt.success("Шаблон удален"),x()}catch(jx){gt.error("Ошибка удаления")}})(t.id)},className:"p-1 bg-red-100 hover:bg-red-200 rounded text-red-600",title:"Удалить",children:Qe.jsx(Q,{className:"w-3 h-3"})})]})]},t.id))]},t)):Qe.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Qe.jsx(O,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),Qe.jsx("p",{className:"text-sm",children:"Нет шаблонов"}),Qe.jsx("p",{className:"text-xs mt-1",children:"Создайте первый шаблон"})]})})]})})}const Vc=["👋 Здравствуйте!","📅 Когда вам удобно?","✅ Отлично!","🎉 Спасибо за обращение!","⏰ Свяжусь с вами позже","💎 Посмотрите наши услуги","📞 Могу я вам перезвонить?","🌟 Рады вас видеть!"];function Yc({onSelect:e}){return Qe.jsxs("div",{className:"border-t bg-gradient-to-r from-blue-50 to-purple-50 p-3",children:[Qe.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[Qe.jsx(he,{className:"w-4 h-4 text-purple-600"}),Qe.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Быстрые ответы"})]}),Qe.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-purple-300 scrollbar-track-transparent",children:Vc.map((t,s)=>Qe.jsx("button",{onClick:()=>e(t),className:"px-3 py-1.5 bg-white hover:bg-gradient-to-r hover:from-purple-100 hover:to-pink-100 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105 border border-purple-200 hover:border-purple-300 shadow-sm",children:t},s))})]})}function Xc({onSelect:e}){const[t,r]=s.useState([]),[a,n]=s.useState(!1),[i,l]=s.useState(null),[o,d]=s.useState(!1),[c,m]=s.useState({name:"",content:"",category:"general"});s.useEffect(()=>{x()},[]);const x=async()=>{try{d(!0);const e=await Ct.getMessageTemplates();r(e.templates||[])}catch(jx){gt.error("Ошибка загрузки шаблонов")}finally{d(!1)}},u=t.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{});return Qe.jsx("div",{className:"border-t bg-white",children:Qe.jsxs("div",{className:"p-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Qe.jsxs("h4",{className:"font-semibold flex items-center gap-2 text-gray-900",children:[Qe.jsx(O,{className:"w-4 h-4 text-pink-600"}),"Шаблоны сообщений"]}),Qe.jsx(Ys,{size:"sm",variant:"ghost",onClick:()=>{n(!a),l(null),a||m({name:"",content:"",category:"general"})},className:"h-8 w-8 p-0",children:a?Qe.jsx(g,{className:"w-4 h-4"}):Qe.jsx(B,{className:"w-4 h-4"})})]}),(a||i)&&Qe.jsxs("div",{className:"mb-4 p-3 bg-gradient-to-br from-pink-50 to-purple-50 rounded-lg space-y-2 border border-pink-200",children:[Qe.jsx(oo,{placeholder:"Название шаблона",value:c.name,onChange:e=>m({...c,name:e.target.value}),className:"bg-white"}),Qe.jsx(_d,{placeholder:"Текст шаблона",value:c.content,onChange:e=>m({...c,content:e.target.value}),className:"bg-white min-h-[80px]",rows:3}),Qe.jsxs("select",{value:c.category,onChange:e=>m({...c,category:e.target.value}),className:"w-full px-3 py-2 border rounded bg-white text-sm",children:[Qe.jsx("option",{value:"general",children:"Общие"}),Qe.jsx("option",{value:"greetings",children:"Приветствия"}),Qe.jsx("option",{value:"booking",children:"Запись"}),Qe.jsx("option",{value:"info",children:"Информация"}),Qe.jsx("option",{value:"closing",children:"Завершение"}),Qe.jsx("option",{value:"followup",children:"Followup"})]}),Qe.jsxs("div",{className:"flex gap-2",children:[Qe.jsx(Ys,{onClick:()=>i?(async e=>{try{d(!0),await Ct.updateMessageTemplate(e,c),gt.success("Шаблон обновлен"),l(null),m({name:"",content:"",category:"general"}),x()}catch(jx){gt.error("Ошибка обновления")}finally{d(!1)}})(i):(async()=>{if(c.name.trim()&&c.content.trim())try{d(!0),await Ct.createMessageTemplate(c),gt.success("Шаблон создан"),n(!1),m({name:"",content:"",category:"general"}),x()}catch(jx){gt.error("Ошибка создания шаблона")}finally{d(!1)}else gt.error("Заполните все поля")})(),disabled:o,className:"flex-1 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 text-white",size:"sm",children:i?"Обновить":"Создать"}),i&&Qe.jsx(Ys,{onClick:()=>{l(null),m({name:"",content:"",category:"general"})},variant:"outline",size:"sm",children:"Отмена"})]})]}),Qe.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:o&&0===t.length?Qe.jsxs("div",{className:"text-center py-4 text-gray-500",children:[Qe.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-pink-600 border-t-transparent rounded-full mx-auto mb-2"}),"Загрузка..."]}):Object.keys(u).length>0?Object.entries(u).map(([t,s])=>Qe.jsxs("div",{className:"space-y-2",children:[Qe.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"general"===t?"Общие":"greetings"===t?"Приветствия":"booking"===t?"Запись":"info"===t?"Информация":"closing"===t?"Завершение":"followup"===t?"Followup":t}),s.map(t=>Qe.jsxs("div",{className:"group relative",children:[Qe.jsxs("button",{onClick:()=>e(t.content),className:"w-full text-left p-3 border rounded-lg hover:bg-gradient-to-r hover:from-pink-50 hover:to-purple-50 hover:border-pink-300 transition-all",children:[Qe.jsx("p",{className:"font-medium text-sm text-gray-900",children:t.name}),Qe.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:t.content})]}),Qe.jsxs("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[Qe.jsx("button",{onClick:e=>{e.stopPropagation(),(e=>{l(e.id),m({name:e.name,content:e.content,category:e.category}),n(!1)})(t)},className:"p-1 bg-blue-100 hover:bg-blue-200 rounded text-blue-600",title:"Редактировать",children:Qe.jsx(J,{className:"w-3 h-3"})}),Qe.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{if(confirm("Удалить этот шаблон?"))try{await Ct.deleteMessageTemplate(e),gt.success("Шаблон удален"),x()}catch(jx){gt.error("Ошибка удаления")}})(t.id)},className:"p-1 bg-red-100 hover:bg-red-200 rounded text-red-600",title:"Удалить",children:Qe.jsx(Q,{className:"w-3 h-3"})})]})]},t.id))]},t)):Qe.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Qe.jsx(O,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),Qe.jsx("p",{className:"text-sm",children:"Нет шаблонов"}),Qe.jsx("p",{className:"text-xs mt-1",children:"Создайте первый шаблон"})]})})]})})}function Kc(){const e=n(),t=i(),[r,a]=s.useState([]),[l,o]=s.useState(null),[d,c]=s.useState(""),[m,x]=s.useState([]),[u,h]=s.useState(""),[p,f]=s.useState(!0),[b,y]=s.useState(!1),[j,v]=s.useState(!1),[w,N]=s.useState(null),[k,S]=s.useState(!1),[C,_]=s.useState(!1),[R,T]=s.useState(!1),[D,I]=s.useState(!1),[L,M]=s.useState(!1),[A,W]=s.useState(""),[B,F]=s.useState([]),[U,q]=s.useState(!1),[Y,K]=s.useState(!1),[J,G]=s.useState(""),[Z,Q]=s.useState(""),[ee,te]=s.useState(!1),{statuses:se,addStatus:re}=bo(),[ae,ne]=s.useState(window.innerWidth<800),ie=s.useRef(null),le=s.useRef(null),oe=s.useRef([]);s.useEffect(()=>{const e=()=>{ne(window.innerWidth<800)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s.useEffect(()=>{const t=new URLSearchParams(e.search).get("client_id");t&&localStorage.setItem("selectedClientId",t)},[e.search]),s.useEffect(()=>{de()},[]),s.useEffect(()=>{if(r.length>0){const e=localStorage.getItem("selectedClientId");if(e){const t=r.find(t=>t.id===e);t&&(o(t),ce(e,!0),localStorage.removeItem("selectedClientId"))}}},[r]),s.useEffect(()=>{le.current?.scrollIntoView({behavior:"smooth"})},[m]),s.useEffect(()=>{if(!l)return;const e=setInterval(()=>{ce(l.id,!1)},5e3);return()=>clearInterval(e)},[l]),s.useEffect(()=>{u.startsWith("/")?I(!0):I(!1)},[u]);const de=async()=>{try{f(!0),N(null);const e=await Ct.getClients(),t=e.clients||(Array.isArray(e)?e:[]),s=await Promise.all(t.map(async e=>{try{const t=await Ct.getClientUnreadCount(e.id);return{...e,unread_count:t?.unread_count||0}}catch{return{...e,unread_count:0}}}));a(s)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки клиентов";N(t),gt.error(`Ошибка: ${t}`)}finally{f(!1)}},ce=async(e,t=!1)=>{try{t?y(!0):v(!0);const s=await Ct.getChatMessages(e,50),r=s.messages||(Array.isArray(s)?s:[]);if(!t&&JSON.stringify(r)===JSON.stringify(m))return;x(r)}catch(jx){if(t){const t=jx instanceof Error?jx.message:"Ошибка загрузки сообщений";gt.error(`Ошибка: ${t}`)}}finally{t?y(!1):v(!1)}},me=()=>{o(null),S(!1),_(!1),T(!1),M(!1)},ue=()=>{l&&(G(l.name||""),Q(l.phone||""),K(!1))},he=async()=>{if((u.trim()||0!==B.length)&&l)try{if(B.length>0){q(!0);let e=!0;for(const t of B)try{const e=new FormData;e.append("file",t);const s=await fetch("https://mlediamant.com/api/upload",{method:"POST",credentials:"include",body:e,signal:AbortSignal.timeout(12e4)});if(!s.ok){await s.text();throw new Error(`Ошибка загрузки: ${s.status}`)}const r=await s.json();if(!r.file_url)throw new Error("Не получен URL файла");const{file_url:a}=r,n=t.type.startsWith("image/")?"image":t.type.startsWith("video/")?"video":t.type.startsWith("audio/")?"audio":"file",i=await Ct.sendFile(l.id,a,n);if(i.error)throw new Error(i.error);const o={id:Date.now()+Math.random(),message:a,sender:"manager",timestamp:(new Date).toISOString(),type:n};x(e=>[...e,o]),gt.success(`Файл "${t.name}" отправлен`)}catch(jx){e=!1;const r=jx instanceof Error?jx.message:"Ошибка";r.includes("timeout")||r.includes("aborted")?gt.error(`⏱️ Время загрузки истекло для "${t.name}"`):r.includes("403")?gt.error(`🔒 Доступ запрещен для "${t.name}"`):r.includes("Instagram cannot access")?gt.error("🚫 Instagram не может получить доступ к файлу с localhost."):gt.error(`❌ Не удалось отправить "${t.name}": ${r}`)}e&&F([]),q(!1)}if(u.trim()){await Ct.sendMessage(l.id,u);const e={id:Date.now(),message:u,sender:"manager",timestamp:(new Date).toISOString(),type:"text"};x(t=>[...t,e]),h(""),gt.success("Сообщение отправлено")}setTimeout(()=>{l&&ce(l.id,!1)},1e3)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка отправки";gt.error(`Ошибка: ${t}`)}finally{q(!1)}},pe=r.filter(e=>e.display_name.toLowerCase().includes(d.toLowerCase())||e.phone.includes(d)),ge=u.trim().length>0||B.length>0;return p?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка чатов..."})]})}):w?Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:w}),Qe.jsx(Ys,{onClick:de,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})}):Qe.jsx("div",{className:"h-[calc(100vh-2rem)] p-2 sm:p-4",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 h-full flex overflow-hidden",children:[Qe.jsxs("div",{className:`\n           w-full sm:w-96 border-r border-gray-200 flex flex-col\n          ${l&&ae?"hidden":"flex"}\n        `,children:[Qe.jsxs("div",{className:"p-4 border-b border-gray-200",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Qe.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[Qe.jsx(xe,{className:"w-5 h-5 text-pink-600"}),"Чаты (",r.length,")"]}),j&&Qe.jsx(z,{className:"w-4 h-4 text-pink-600 animate-spin"})]}),Qe.jsxs("div",{className:"relative",children:[Qe.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),Qe.jsx(oo,{type:"text",placeholder:"Поиск...",value:d,onChange:e=>c(e.target.value),className:"pl-10"})]})]}),Qe.jsx("div",{className:"flex-1 overflow-y-auto",children:pe.length>0?pe.map(e=>Qe.jsx("div",{onClick:()=>(e=>{o(e),ce(e.id,!0),S(!1),_(!1),T(!1),K(!1),G(e.name||""),Q(e.phone||"")})(e),className:"p-4 cursor-pointer border-b border-gray-100 hover:bg-gray-50 transition-colors "+(l?.id===e.id?"bg-pink-50 border-l-4 border-l-pink-600":""),children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsxs("div",{className:"relative",children:[e.profile_pic&&""!==e.profile_pic.trim()?Qe.jsx("img",{src:e.profile_pic,alt:e.display_name,className:"w-12 h-12 rounded-full object-cover border-2 border-white shadow-sm",crossOrigin:"anonymous",onError:e=>{e.currentTarget.style.display="none";const t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null,Qe.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-medium text-sm "+(e.profile_pic&&""!==e.profile_pic.trim()?"hidden":""),style:{display:e.profile_pic&&""!==e.profile_pic.trim()?"none":"flex"},children:e.display_name.charAt(0).toUpperCase()})]}),Qe.jsxs("div",{className:"flex-1 min-w-0",children:[Qe.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.display_name}),Qe.jsx("p",{className:"text-xs text-gray-600 truncate",children:e.phone||"Нет телефона"}),Qe.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.total_messages," сообщений"]})]})]})},e.id)):Qe.jsxs("div",{className:"p-4 text-center text-gray-500",children:[Qe.jsx(xe,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),Qe.jsx("p",{className:"text-sm",children:"Клиентов не найдено"})]})})]}),l?Qe.jsxs("div",{className:`\n            flex-1 flex flex-col\n            ${ae?"w-full":""}\n          `,children:[Qe.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200 bg-gradient-to-r from-pink-50 to-purple-50",children:Qe.jsxs("div",{className:"flex items-center justify-between gap-2",children:[ae&&Qe.jsx("button",{onClick:me,className:"flex items-center justify-center w-8 h-8 rounded-lg hover:bg-white/50 transition-colors flex-shrink-0","aria-label":"Back to chat list",children:Qe.jsx(H,{className:"w-5 h-5 text-gray-700"})}),Qe.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[l.profile_pic&&""!==l.profile_pic.trim()?Qe.jsx("img",{src:l.profile_pic,alt:l.display_name,className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full object-cover border-2 border-white shadow-md flex-shrink-0",crossOrigin:"anonymous",onError:e=>{e.currentTarget.style.display="none";const t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null,Qe.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-medium text-sm shadow-md flex-shrink-0 "+(l.profile_pic&&""!==l.profile_pic.trim()?"hidden":""),children:l.display_name.charAt(0).toUpperCase()}),Qe.jsxs("div",{className:"min-w-0 flex-1",children:[Qe.jsx("p",{className:"text-xs sm:text-sm font-semibold text-gray-900 truncate",children:l.display_name}),Qe.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-xs text-gray-600",children:[l.phone&&Qe.jsxs("span",{className:"hidden sm:flex items-center gap-1",children:[Qe.jsx(X,{className:"w-3 h-3"}),l.phone]}),l.username&&Qe.jsxs("a",{href:`https://instagram.com/${l.username}`,target:"_blank",rel:"noopener noreferrer",className:"text-pink-600 hover:underline flex items-center gap-1 truncate",children:[Qe.jsx(fe,{className:"w-3 h-3 flex-shrink-0"}),Qe.jsxs("span",{className:"hidden sm:inline",children:["@",l.username]}),Qe.jsxs("span",{className:"sm:hidden",children:["@",l.username.substring(0,10)]})]})]})]})]}),Qe.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>M(!L),title:"Поиск по сообщениям",className:"h-8 w-8 sm:h-9 sm:w-9 p-0 "+(L?"bg-yellow-100 border-yellow-300":""),children:Qe.jsx($,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>{_(!C),T(!1),S(!1)},title:"Информация о клиенте",className:"h-8 w-8 sm:h-9 sm:w-9 p-0 hidden sm:flex "+(C?"bg-blue-100 border-blue-300":""),children:Qe.jsx(be,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>{T(!R),_(!1),S(!1)},title:"Шаблоны сообщений",className:"h-8 w-8 sm:h-9 sm:w-9 p-0 hidden md:flex "+(R?"bg-pink-100 border-pink-300":""),children:Qe.jsx(O,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),!ae&&Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:me,title:"Закрыть чат",className:"h-8 w-8 sm:h-9 sm:w-9 p-0",children:Qe.jsx(g,{className:"w-4 h-4"})})]})]})}),L&&Qe.jsx(Xc,{messages:m,onJumpToMessage:e=>{oe.current[e]?.scrollIntoView({behavior:"smooth",block:"center"})},onClose:()=>M(!1)}),Qe.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gradient-to-b from-gray-50 to-white",children:[b?Qe.jsx("div",{className:"flex items-center justify-center h-full",children:Qe.jsx(z,{className:"w-6 h-6 text-pink-600 animate-spin"})}):m.length>0?m.map((e,t)=>Qe.jsx("div",{ref:e=>oe.current[t]=e,className:`flex ${"bot"===e.sender||"manager"===e.sender?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:Qe.jsx("div",{className:"mobile-chat-message rounded-2xl shadow-md overflow-hidden max-w-md "+("bot"===e.sender||"manager"===e.sender?"bg-gradient-to-br from-pink-500 to-purple-600 text-white":"bg-white text-gray-900 border border-gray-200"),children:"image"===e.type?Qe.jsxs("div",{className:"relative group "+("bot"===e.sender||"manager"===e.sender?"max-w-[160px]":"max-w-[220px]"),children:[Qe.jsx("img",{src:(()=>{if(e.message.startsWith("http")){if(e.message.includes("zrok.io")){return`https://mlediamant.com${new URL(e.message).pathname}`}return e.message}return`https://mlediamant.com${e.message}`})(),alt:"Изображение",loading:"lazy",style:{width:"100%",height:"auto",maxHeight:"180px",objectFit:"cover"},className:"rounded-2xl cursor-pointer hover:scale-105 transition-transform",onClick:()=>window.open(e.message,"_blank"),onError:e=>{e.currentTarget.style.display="none";const t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}),Qe.jsxs("div",{style:{display:"none"},className:"px-4 py-3 text-sm flex flex-col items-center justify-center min-h-[100px] "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-gray-500"),children:[Qe.jsx("svg",{className:"w-12 h-12 mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Qe.jsx("p",{children:"📷 Изображение недоступно"})]}),Qe.jsx("div",{className:"px-4 py-2 "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-gray-600"),children:Qe.jsx("p",{className:"text-xs",children:new Date(e.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})})]}):"video"===e.type?Qe.jsxs("div",{className:"relative",children:[Qe.jsx("video",{src:e.message,controls:!0,className:"w-[400px] h-auto rounded-t-2xl",onError:e=>{e.currentTarget.style.display="none";const t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}),Qe.jsx("div",{className:"px-4 py-2 "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-gray-600"),children:Qe.jsx("p",{className:"text-xs",children:new Date(e.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})})]}):"audio"===e.type?Qe.jsxs("div",{className:"px-4 py-3 min-w-[250px]",children:[Qe.jsx("audio",{src:e.message,controls:!0,className:"w-full"}),Qe.jsx("div",{className:"mt-2 "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-gray-600"),children:Qe.jsx("p",{className:"text-xs",children:new Date(e.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})})]}):"file"===e.type?Qe.jsxs("div",{className:"px-4 py-3 min-w-[200px]",children:[Qe.jsxs("a",{href:e.message,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 hover:underline group "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-blue-600"),children:[Qe.jsx(O,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}),Qe.jsx("span",{children:"Открыть файл"})]}),Qe.jsx("div",{className:"mt-2 "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-gray-600"),children:Qe.jsx("p",{className:"text-xs",children:new Date(e.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})})]}):Qe.jsxs("div",{className:"px-4 py-3 max-w-md",children:[Qe.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:e.message}),Qe.jsx("div",{className:"flex items-center justify-between mt-2",children:Qe.jsx("p",{className:"text-xs "+("bot"===e.sender||"manager"===e.sender?"text-pink-100":"text-gray-500"),children:new Date(e.timestamp).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})})]})})},e.id)):Qe.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:Qe.jsxs("div",{className:"text-center",children:[Qe.jsx(xe,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),Qe.jsx("p",{children:"Нет сообщений"})]})}),Qe.jsx("div",{ref:le})]}),C&&l&&Qe.jsxs("div",{className:"border-t border-gray-200 bg-white p-6 max-h-[500px] overflow-y-auto",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Qe.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[Qe.jsx(V,{className:"w-5 h-5 text-pink-600"}),"Информация о клиенте"]}),Qe.jsx("button",{onClick:()=>{_(!1),K(!1),ue()},className:"h-8 w-8 p-0 hover:bg-gray-100 rounded-lg flex items-center justify-center transition",children:Qe.jsx(g,{className:"w-4 h-4"})})]}),Qe.jsxs("div",{className:"flex items-center gap-4 mb-6 p-4 bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl",children:[l.profile_pic?Qe.jsx("img",{src:l.profile_pic,alt:l.display_name,className:"w-16 h-16 rounded-full object-cover border-4 border-white shadow-lg",onError:e=>{e.currentTarget.style.display="none"}}):Qe.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-2xl shadow-lg",children:l.display_name.charAt(0).toUpperCase()}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-xl font-bold text-gray-900",children:l.display_name}),Qe.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",l.id.substring(0,12),"..."]})]})]}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[Qe.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[Qe.jsx("span",{className:"text-lg",children:"👤"})," Имя клиента"]}),Y?Qe.jsx("input",{type:"text",value:J,onChange:e=>G(e.target.value),placeholder:"Введите имя...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent"}):Qe.jsx("p",{className:"text-gray-900 font-medium",children:l.name||Qe.jsx("span",{className:"text-gray-400 italic",children:"Не указано"})})]}),Qe.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[Qe.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[Qe.jsx(X,{className:"w-4 h-4"}),"Телефон"]}),Y?Qe.jsx("input",{type:"text",value:Z,onChange:e=>Q(e.target.value),placeholder:"+971 XX XXX XXXX",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-pink-500"}):Qe.jsx("p",{className:"text-gray-900 font-medium",children:l.phone||Qe.jsx("span",{className:"text-gray-400 italic",children:"Не указан"})})]}),Qe.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gradient-to-r from-purple-50 to-pink-50",children:[Qe.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[Qe.jsx(fe,{className:"w-4 h-4 text-pink-600"}),"Instagram"]}),l.username?Qe.jsxs("a",{href:`https://instagram.com/${l.username}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-pink-600 hover:text-pink-700 font-semibold text-base transition-colors group",children:[Qe.jsxs("span",{children:["@",l.username]}),Qe.jsx("svg",{className:"w-4 h-4 group-hover:translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}):Qe.jsx("p",{className:"text-gray-400 italic",children:"Не указан"})]}),Qe.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Qe.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-blue-50",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Сообщений"}),Qe.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l.total_messages})]}),Qe.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-green-50",children:[Qe.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Статус"}),Y?Qe.jsx(po,{value:l.status,onChange:async e=>{try{await Ct.updateClientStatus(l.id,e),o({...l,status:e}),a(r.map(t=>t.id===l.id?{...t,status:e}:t)),gt.success("Статус обновлён")}catch(jx){gt.error("Ошибка обновления статуса")}},options:se,allowAdd:!0,onAddStatus:re}):Qe.jsx("span",{className:`inline-block px-3 py-1 font-semibold rounded-full text-sm ${se[l.status]?.color||"bg-green-600 text-white"}`,children:se[l.status]?.label||l.status})]})]}),Qe.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[Qe.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2",children:[Qe.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Последний контакт"]}),Qe.jsx("p",{className:"text-gray-900",children:new Date(l.last_contact).toLocaleString("ru-RU",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),Qe.jsxs("div",{className:"mt-6 space-y-3",children:[Y?Qe.jsxs("div",{className:"flex gap-2",children:[Qe.jsx("button",{onClick:async()=>{if(l)try{te(!0),await Ct.updateClient(l.id,{name:J.trim()||null,phone:Z.trim()||null}),a(r.map(e=>e.id===l.id?{...e,name:J.trim()||"",phone:Z.trim()||"",display_name:J.trim()||e.username||e.id.substring(0,15)+"..."}:e)),o({...l,name:J.trim()||"",phone:Z.trim()||"",display_name:J.trim()||l.username||l.id.substring(0,15)+"..."}),K(!1),gt.success("Информация обновлена")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка сохранения";gt.error(`Ошибка: ${t}`)}finally{te(!1)}},disabled:ee,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:ee?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 animate-spin"}),"Сохранение..."]}):Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(P,{className:"w-4 h-4"}),"Сохранить"]})}),Qe.jsx("button",{onClick:ue,disabled:ee,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",children:Qe.jsx(g,{className:"w-4 h-4"})})]}):Qe.jsxs("button",{onClick:()=>K(!0),className:"client-info-edit-button w-full text-white font-semibold py-2 px-4 rounded-lg shadow-md transition flex items-center justify-center gap-2",children:[Qe.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Редактировать"]}),Qe.jsxs("button",{onClick:()=>{const e=JSON.parse(localStorage.getItem("user")||"{}").role;t(`${"admin"===e?"/admin":"/manager"}/clients/${l.id}`)},className:"w-full border border-gray-300 hover:bg-gray-50 font-semibold py-2 px-4 rounded-lg shadow-sm transition flex items-center justify-center gap-2",children:[Qe.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Полный профиль"]})]})]}),R&&Qe.jsxs("div",{className:"border-t border-gray-200 bg-white p-6",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Qe.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[Qe.jsx(O,{className:"w-5 h-5 text-pink-600"}),"Шаблоны сообщений"]}),Qe.jsx("button",{onClick:()=>T(!1),className:"h-8 w-8 p-0 hover:bg-gray-100 rounded-lg flex items-center justify-center transition",children:Qe.jsx(g,{className:"w-4 h-4"})})]}),Qe.jsx(Hc,{onSelect:e=>{h(e),T(!1),gt.success("Шаблон вставлен")}})]}),k&&Qe.jsx("div",{className:"border-t border-gray-200 bg-gradient-to-br from-yellow-50 to-amber-50",children:Qe.jsxs("div",{className:"p-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-lg flex items-center justify-center",children:Qe.jsx(ye,{className:"w-4 h-4 text-white"})}),Qe.jsx("h4",{className:"text-sm text-gray-900 font-semibold",children:"Заметки о клиенте"})]}),Qe.jsx(Ys,{size:"sm",variant:"ghost",onClick:()=>S(!1),className:"h-8 w-8 p-0 hover:bg-white/50",children:Qe.jsx(g,{className:"w-4 h-4"})})]}),Qe.jsx(_d,{value:A,onChange:e=>W(e.target.value),placeholder:"Введите заметки о клиенте...",className:"min-h-[100px] mb-3 bg-white shadow-sm"}),Qe.jsxs(Ys,{size:"sm",onClick:()=>{gt.success("Заметки сохранены"),S(!1)},className:"w-full bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white shadow-md",children:[Qe.jsx(P,{className:"w-4 h-4 mr-2"}),"Сохранить заметки"]})]})}),D&&l&&Qe.jsx("div",{className:"border-t border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50 p-3",children:Qe.jsx(Yc,{onSelect:e=>{h(e),I(!1)}})}),B.length>0&&Qe.jsxs("div",{className:"border-t border-gray-200 p-3 bg-gradient-to-r from-blue-50 to-purple-50",children:[Qe.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Qe.jsxs("p",{className:"text-xs font-semibold text-gray-700 flex items-center gap-2",children:[Qe.jsx(je,{className:"w-3 h-3"}),"Прикрепленные файлы (",B.length,")"]}),Qe.jsx("button",{onClick:()=>{F([]),gt.info("Файлы очищены")},className:"text-xs text-red-600 hover:text-red-700 font-medium",children:"Очистить все"})]}),Qe.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:B.map((e,t)=>Qe.jsxs("div",{className:"relative flex-shrink-0 group",children:[Qe.jsx("div",{className:"w-20 h-20 bg-white rounded-lg border-2 border-gray-200 overflow-hidden flex items-center justify-center",children:e.type.startsWith("image/")?Qe.jsx("img",{src:URL.createObjectURL(e),alt:e.name,className:"w-full h-full object-cover"}):e.type.startsWith("video/")?Qe.jsxs("div",{className:"flex flex-col items-center justify-center",children:[Qe.jsx("svg",{className:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Qe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),Qe.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Видео"})]}):Qe.jsxs("div",{className:"flex flex-col items-center justify-center",children:[Qe.jsx(O,{className:"w-8 h-8 text-gray-400"}),Qe.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Файл"})]})}),Qe.jsx("p",{className:"text-xs text-gray-600 mt-1 w-20 truncate text-center",title:e.name,children:e.name}),Qe.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[(e.size/1024).toFixed(0),"KB"]}),Qe.jsx("button",{onClick:()=>(e=>{F(B.filter((t,s)=>s!==e)),gt.info("Файл удален")})(t),className:"absolute -top-2 -right-2 w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center shadow-md transition opacity-0 group-hover:opacity-100",title:"Удалить",children:Qe.jsx(g,{className:"w-3 h-3"})})]},t))})]}),Qe.jsx("div",{className:"p-3 sm:p-4 border-t border-gray-200 bg-white",children:Qe.jsxs("div",{className:"flex items-end gap-2",children:[Qe.jsx("div",{className:"flex-1",children:Qe.jsx(_d,{value:u,onChange:e=>h(e.target.value),placeholder:"Введите сообщение или / для быстрых ответов...",className:"resize-none text-sm sm:text-base",rows:2,disabled:U,onKeyDown:e=>{if("Enter"!==e.key||e.shiftKey)"/"!==e.key||D||""!==u.trim()||(I(!0),T(!1),S(!1));else{e.preventDefault();(u.trim().length>0||B.length>0)&&!U&&he()}}})}),Qe.jsxs("div",{className:"flex flex-col gap-2",children:[Qe.jsx("input",{type:"file",ref:ie,className:"hidden",accept:"image/*,video/*,audio/*,application/pdf,.doc,.docx,.xls,.xlsx",multiple:!0,onChange:e=>{if(e.target.files&&e.target.files.length>0){const t=Array.from(e.target.files);F([...B,...t]),gt.success(`${t.length} ${1===t.length?"файл добавлен":"файла добавлено"}`)}}}),Qe.jsxs("div",{className:"relative h-9",children:[Qe.jsx(Ys,{size:"sm",variant:"outline",onClick:()=>{const e=document.getElementById("chat-input-menu");e&&e.classList.toggle("hidden")},title:"Меню",className:"h-9 w-9 p-0",children:Qe.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:Qe.jsx("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),Qe.jsxs("div",{id:"chat-input-menu",className:"hidden fixed bottom-auto w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",style:{transform:"translateY(-100%)",marginTop:"-0.5rem"},onClick:e=>{const t=document.getElementById("chat-input-menu"),s=e.currentTarget;if(t)if(t.classList.contains("hidden")){const e=s.getBoundingClientRect();t.style.top=`${e.top}px`,t.style.right=window.innerWidth-e.right+"px",t.classList.remove("hidden")}else t.classList.add("hidden")},children:[Qe.jsxs("button",{onClick:()=>{_(!C),T(!1),S(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[Qe.jsx(be,{className:"w-4 h-4"}),"Информация"]}),Qe.jsxs("button",{onClick:()=>{T(!R),_(!1),S(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[Qe.jsx(O,{className:"w-4 h-4"}),"Шаблоны"]}),Qe.jsxs("button",{onClick:()=>{S(!k),_(!1),T(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[Qe.jsx(ye,{className:"w-4 h-4"}),"Заметки"]}),Qe.jsxs("button",{onClick:()=>ie.current?.click(),disabled:U,className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[Qe.jsx(je,{className:"w-4 h-4"}),"Прикрепить файл"]})]})]}),Qe.jsx(Ys,{onClick:he,className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 h-9 w-9 p-0",disabled:!ge||U,title:U?"Загрузка файла...":"Отправить",children:U?Qe.jsx(z,{className:"w-4 h-4 animate-spin"}):Qe.jsx(ve,{className:"w-4 h-4"})})]})]})})]}):Qe.jsx("div",{className:`\n            flex-1 flex items-center justify-center text-gray-500 px-8\n            ${ae?"hidden":"flex"}\n          `,children:Qe.jsxs("div",{className:"text-center",children:[Qe.jsx(xe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),Qe.jsx("p",{className:"text-lg font-medium",children:"Выберите клиента для начала чата"}),Qe.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Выберите диалог из списка слева"})]})})]})})}const Jc=["Посетители","Вовлечённые","Начали запись","Записались","Посетили"],Gc=["bg-blue-500","bg-cyan-500","bg-green-500","bg-amber-500","bg-pink-500"],Zc=["Первичные посетители сайта/соцсетей","Проявили интерес (лайк, комментарий, просмотр)","Открыли форму записи","Завершили бронирование","Пришли на процедуру"];function Qc(){const[e,t]=s.useState(null),[r,a]=s.useState("month"),[n,i]=s.useState(!0),[l,o]=s.useState(null);s.useEffect(()=>{d()},[r]);const d=async()=>{try{i(!0),o(null);const e=await Ct.getFunnel();t(e)}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка загрузки данных";o(t),gt.error(`Ошибка: ${t}`)}finally{i(!1)}};if(n)return Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка данных воронки..."})]})});if(l||!e)return Qe.jsx("div",{className:"p-8",children:Qe.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(E,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:l}),Qe.jsx(Ys,{onClick:d,className:"mt-4 bg-red-600 hover:bg-red-700",children:"Попробовать еще раз"})]})]})})});const c=[e.visitors,e.engaged,e.started_booking,e.booked,e.completed],m=Math.max(...c),x=[{label:"Посетитель → Вовлечённый",value:e.conversion_rates.visitor_to_engaged},{label:"Вовлечённый → Начал запись",value:e.conversion_rates.engaged_to_booking},{label:"Начал запись → Записался",value:e.conversion_rates.booking_to_booked},{label:"Записался → Посетил",value:e.conversion_rates.booked_to_completed}],u=[0,e.visitors-e.engaged,e.engaged-e.started_booking,e.started_booking-e.booked,e.booked-e.completed],h=e.completed/e.visitors*100,p=[];return e.conversion_rates.visitor_to_engaged<60&&p.push({title:"Увеличить вовлечённость",description:`Потеря ${u[1]} потенциальных клиентов на этапе вовлечения`,suggestion:"Улучшите контент в соцсетях, добавьте отзывы и примеры работ",priority:"high"}),e.conversion_rates.engaged_to_booking<50&&p.push({title:"Оптимизировать форму записи",description:`${(100-e.conversion_rates.engaged_to_booking).toFixed(1)}% посетителей уходят не завершив запись`,suggestion:"Упростите форму записи, добавьте автозаполнение",priority:"high"}),e.conversion_rates.booked_to_completed<90&&p.push({title:"Снизить no-show",description:`${u[4]} клиентов (${(u[4]/e.booked*100).toFixed(1)}%) не пришли на запись`,suggestion:"Добавьте напоминания за 24 часа и за 2 часа до визита",priority:"medium"}),Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(pe,{className:"w-8 h-8 text-pink-600"}),"Воронка продаж"]}),Qe.jsx("p",{className:"text-gray-600",children:"Анализ этапов взаимодействия с клиентами"})]}),Qe.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 mb-6",children:Qe.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[Qe.jsxs(to,{value:r,onValueChange:a,children:[Qe.jsx(ro,{className:"w-full md:w-[200px]",children:Qe.jsx(so,{placeholder:"Период"})}),Qe.jsxs(ao,{children:[Qe.jsx(no,{value:"week",children:"Неделя"}),Qe.jsx(no,{value:"2weeks",children:"2 недели"}),Qe.jsx(no,{value:"month",children:"Месяц"}),Qe.jsx(no,{value:"3months",children:"3 месяца"})]})]}),Qe.jsxs(Ys,{variant:"outline",className:"md:ml-auto",onClick:d,children:[Qe.jsx(F,{className:"w-4 h-4 mr-2"}),"Обновить"]}),Qe.jsxs(Ys,{className:"bg-pink-600 hover:bg-pink-700",children:[Qe.jsx(A,{className:"w-4 h-4 mr-2"}),"Экспорт"]})]})}),Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:x.map((e,t)=>{const s=e.value>=60,r=e.value>=80;return Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-600 text-sm mb-2",children:e.label}),Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("h3",{className:"text-3xl text-gray-900",children:[e.value.toFixed(1),"%"]}),r&&Qe.jsx(D,{className:"w-6 h-6 text-green-600"}),s&&!r&&Qe.jsx(D,{className:"w-6 h-6 text-blue-600"}),!s&&Qe.jsx(we,{className:"w-6 h-6 text-yellow-600"})]})]},t)})}),Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 mb-8",children:[Qe.jsxs("h2",{className:"text-2xl text-gray-900 mb-6 flex items-center gap-2",children:[Qe.jsx(pe,{className:"w-6 h-6 text-pink-600"}),"Воронка продаж"]}),Qe.jsx("div",{className:"space-y-4",children:Jc.map((t,s)=>{const r=c[s],a=r/m*100,n=r/e.visitors*100;return Qe.jsxs("div",{className:"relative",children:[Qe.jsx("div",{className:"flex items-center gap-4",children:Qe.jsx("div",{className:"flex-1",children:Qe.jsx("div",{className:`${Gc[s]} text-white p-6 rounded-lg transition-all hover:shadow-lg cursor-pointer`,style:{width:`${a}%`,minWidth:"200px"},children:Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg mb-1",children:t}),Qe.jsx("p",{className:"text-sm opacity-90",children:Zc[s]})]}),Qe.jsxs("div",{className:"text-right",children:[Qe.jsx("p",{className:"text-2xl",children:r}),Qe.jsxs("p",{className:"text-sm opacity-90",children:[n.toFixed(1),"%"]})]})]})})})}),u[s]>0&&Qe.jsxs("div",{className:"mt-2 ml-4 flex items-center gap-2 text-red-600 text-sm",children:[Qe.jsx(we,{className:"w-4 h-4"}),Qe.jsxs("span",{children:["Потери: ",u[s]," клиентов"]})]})]},s)})})]}),Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6",children:"Ключевые метрики"}),Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(I,{className:"w-8 h-8 text-green-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Общая конверсия"}),Qe.jsxs("p",{className:"text-2xl text-gray-900",children:[h.toFixed(1),"%"]})]})]}),h>15?Qe.jsx(D,{className:"w-6 h-6 text-green-600"}):Qe.jsx(we,{className:"w-6 h-6 text-yellow-600"})]}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-lg",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(Ne,{className:"w-8 h-8 text-red-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Общие потери"}),Qe.jsx("p",{className:"text-2xl text-gray-900",children:e.visitors-e.completed})]})]}),Qe.jsx(we,{className:"w-6 h-6 text-red-600"})]}),Qe.jsx("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg",children:Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(I,{className:"w-8 h-8 text-blue-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-600",children:"Успешных визитов"}),Qe.jsx("p",{className:"text-2xl text-gray-900",children:e.completed})]})]})})]})]}),Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6",children:"Рекомендации"}),Qe.jsx("div",{className:"space-y-4",children:p.length>0?p.map((e,t)=>Qe.jsx("div",{className:"p-4 rounded-lg border-l-4 "+("high"===e.priority?"border-red-500 bg-red-50":"border-yellow-500 bg-yellow-50"),children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(Ne,{className:"w-5 h-5 flex-shrink-0 "+("high"===e.priority?"text-red-600":"text-yellow-600")}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("h3",{className:"text-sm text-gray-900 mb-1",children:e.title}),Qe.jsx("p",{className:"text-xs text-gray-600 mb-2",children:e.description}),Qe.jsx("p",{className:"text-xs text-gray-700 italic",children:e.suggestion})]})]})},t)):Qe.jsx("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(I,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-sm text-green-900 font-medium",children:"Все хорошо!"}),Qe.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Ваша воронка показывает хорошие результаты. Продолжайте в том же духе!"})]})]})})})]})]}),Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[Qe.jsx("div",{className:"p-6 border-b border-gray-200",children:Qe.jsx("h2",{className:"text-xl text-gray-900",children:"Детализация по этапам"})}),Qe.jsx("div",{className:"overflow-x-auto",children:Qe.jsxs("table",{className:"w-full",children:[Qe.jsx("thead",{className:"bg-gray-50",children:Qe.jsxs("tr",{children:[Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Этап"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Количество"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"От всего"}),Qe.jsx("th",{className:"px-6 py-4 text-left text-sm text-gray-600",children:"Потери"})]})}),Qe.jsx("tbody",{className:"divide-y divide-gray-200",children:Jc.map((t,s)=>Qe.jsxs("tr",{className:"hover:bg-gray-50",children:[Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:t}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:c[s]}),Qe.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[(c[s]/e.visitors*100).toFixed(1),"%"]}),Qe.jsx("td",{className:"px-6 py-4 text-sm text-red-600",children:u[s]})]},s))})]})})]})]})}function em(){const[e,t]=s.useState({emailNotifications:!0,smsNotifications:!1,bookingNotifications:!0,chatNotifications:!0,dailyReport:!0,reportTime:"09:00"}),[r,a]=s.useState({}),[n,i]=s.useState(!0);return useEffect(()=>{api.getSalonSettings().then(e=>{a(e),i(!1)})},[]),Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(S,{className:"w-8 h-8 text-pink-600"}),"Мои настройки"]}),Qe.jsx("p",{className:"text-gray-600",children:"Персональные настройки менеджера"})]}),Qe.jsxs(Mc,{defaultValue:"notifications",className:"space-y-6",children:[Qe.jsxs(Ac,{className:"grid w-full grid-cols-2 lg:w-auto",children:[Qe.jsxs(Oc,{value:"notifications",className:"flex items-center gap-2",children:[Qe.jsx(ie,{className:"w-4 h-4"}),Qe.jsx("span",{className:"hidden sm:inline",children:"Уведомления"})]}),Qe.jsxs(Oc,{value:"security",className:"flex items-center gap-2",children:[Qe.jsx(le,{className:"w-4 h-4"}),Qe.jsx("span",{className:"hidden sm:inline",children:"Безопасность"})]})]}),Qe.jsx(Wc,{value:"notifications",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Уведомления"}),Qe.jsxs("form",{onSubmit:async t=>{t.preventDefault();try{(await fetch("/api/settings/notifications",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?gt.success("Настройки уведомлений сохранены ✅"):gt.error("Ошибка при сохранении")}catch(jx){gt.error("Ошибка сервера")}},className:"space-y-6",children:[Qe.jsxs("div",{className:"space-y-4",children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"Каналы уведомлений"}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(oe,{className:"w-6 h-6 text-blue-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Email уведомления"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Получать на почту"})]})]}),Qe.jsx(Qd,{checked:e.emailNotifications,onCheckedChange:s=>t({...e,emailNotifications:s})})]}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{className:"flex items-center gap-3",children:[Qe.jsx(de,{className:"w-6 h-6 text-green-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"SMS уведомления"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Получать на телефон"})]})]}),Qe.jsx(Qd,{checked:e.smsNotifications,onCheckedChange:s=>t({...e,smsNotifications:s})})]})]}),Qe.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"События"}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Новые записи клиентов"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Уведомления о бронированиях"})]}),Qe.jsx(Qd,{checked:e.bookingNotifications,onCheckedChange:s=>t({...e,bookingNotifications:s})})]}),Qe.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Сообщения в чате"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Новые сообщения от клиентов"})]}),Qe.jsx(Qd,{checked:e.chatNotifications,onCheckedChange:s=>t({...e,chatNotifications:s})})]}),Qe.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg space-y-4",children:[Qe.jsxs("div",{className:"flex items-center justify-between",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-sm text-gray-900",children:"Ежедневный отчет"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Статистика за день"})]}),Qe.jsx(Qd,{checked:e.dailyReport,onCheckedChange:s=>t({...e,dailyReport:s})})]}),e.dailyReport&&Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"reportTime",children:"Время отправки отчета"}),Qe.jsx(Input,{id:"reportTime",type:"time",value:e.reportTime,onChange:s=>t({...e,reportTime:s.target.value})})]})]})]}),Qe.jsx(Ys,{type:"submit",className:"bg-gradient-to-r from-pink-500 to-purple-600",children:"Сохранить настройки"})]})]})}),Qe.jsx(Wc,{value:"security",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-6",children:"Безопасность"}),Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsx("div",{className:"p-6 bg-blue-50 border border-blue-200 rounded-lg",children:Qe.jsxs("div",{className:"flex items-start gap-3",children:[Qe.jsx(le,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-1"}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-sm text-gray-900 mb-2 font-semibold",children:"Советы по безопасности"}),Qe.jsxs("ul",{className:"text-sm text-gray-700 space-y-2",children:[Qe.jsx("li",{children:"• Используйте надежный пароль"}),Qe.jsx("li",{children:"• Не делитесь учетными данными"}),Qe.jsx("li",{children:"• Выходите из системы на чужих компьютерах"})]})]})]})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"Сменить пароль"}),Qe.jsx(Ys,{variant:"outline",children:"🔐 Изменить пароль"})]})]})]})})]})]})}function tm({user:e,onLogout:t}){const s=n(),a=i(),[o,d]=r.useState(!1),c=[{icon:f,label:"Мои записи",path:"/employee/dashboard"},{icon:R,label:"Календарь",path:"/employee/calendar"},{icon:V,label:"Мой профиль",path:"/employee/profile"},{icon:S,label:"Настройки",path:"/employee/settings"}];return Qe.jsxs("div",{className:"flex h-screen bg-gray-50",children:[Qe.jsxs("aside",{className:"w-64 bg-white border-r border-gray-200 flex flex-col",children:[Qe.jsxs("div",{className:"p-6 border-b border-gray-200",children:[Qe.jsx("h1",{className:"text-2xl text-pink-600",children:"Beauty Salon"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Личный кабинет"})]}),Qe.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:Qe.jsx("ul",{className:"space-y-1",children:c.map(e=>{const t=e.icon,r=s.pathname===e.path;return Qe.jsx("li",{children:Qe.jsxs(m,{to:e.path,className:"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors "+(r?"bg-pink-50 text-pink-600":"text-gray-700 hover:bg-gray-50"),children:[Qe.jsx(t,{className:"w-5 h-5"}),Qe.jsx("span",{children:e.label})]})},e.path)})})}),Qe.jsxs("div",{className:"p-4 border-t border-gray-200",children:[Qe.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[Qe.jsx("div",{className:"w-10 h-10 bg-pink-600 rounded-full flex items-center justify-center text-white",children:e?.full_name?.charAt(0)||"E"}),Qe.jsxs("div",{className:"flex-1 min-w-0",children:[Qe.jsx("p",{className:"text-sm truncate",children:e?.full_name||"Сотрудник"}),Qe.jsx("p",{className:"text-xs text-gray-500",children:"Мастер"})]})]}),Qe.jsxs("button",{onClick:async()=>{d(!0);try{if(!(await fetch("/logout",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Logout failed");localStorage.removeItem("session_token"),localStorage.removeItem("user"),t(),a("/login",{replace:!0}),gt.success("Вы успешно вышли из системы")}catch(jx){localStorage.removeItem("session_token"),localStorage.removeItem("user"),t(),a("/login",{replace:!0})}finally{d(!1)}},disabled:o,className:"w-full flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",children:[Qe.jsx(_,{className:"w-4 h-4"}),Qe.jsx("span",{children:o?"Выход...":"Выйти"})]})]})]}),Qe.jsx("main",{className:"flex-1 overflow-y-auto",children:Qe.jsx(l,{})})]})}function sm({className:e,...t}){return Qe.jsx("div",{"data-slot":"skeleton",className:Hs("bg-accent animate-pulse rounded-md",e),...t})}function rm(){const[e,t]=s.useState([]),[r,a]=s.useState(!0),[n,i]=s.useState(null);if(s.useEffect(()=>{(async()=>{try{const e=await fetch("/api/bookings",{credentials:"include"});if(!e.ok)throw new Error("Failed to fetch bookings");const s=await e.json(),r=(new Date).toISOString().split("T")[0];t(s.bookings.filter(e=>e.datetime.startsWith(r)))}catch(jx){i(jx instanceof Error?jx.message:"Unknown error")}finally{a(!1)}})()},[]),r)return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsx(sm,{className:"h-10 w-32 mb-2"}),Qe.jsx(sm,{className:"h-6 w-48"})]}),Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[1,2,3].map(e=>Qe.jsx(sm,{className:"h-20"},e))})]});if(n)return Qe.jsx("div",{className:"p-8",children:Qe.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[Qe.jsx(E,{className:"w-5 h-5 text-red-600"}),Qe.jsxs("span",{className:"text-red-800",children:["Ошибка загрузки: ",n]})]})});const l=e.filter(e=>"confirmed"===e.status).length,o=e.filter(e=>"pending"===e.status).length;return Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsx("h1",{className:"text-3xl text-gray-900 mb-2",children:"Мои записи"}),Qe.jsxs("p",{className:"text-gray-600",children:["Сегодня, ",(new Date).toLocaleDateString("ru-RU")]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Записей сегодня"}),Qe.jsx("h3",{className:"text-3xl text-gray-900",children:e.length})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Подтверждено"}),Qe.jsx("h3",{className:"text-3xl text-green-600",children:l})]}),Qe.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"В ожидании"}),Qe.jsx("h3",{className:"text-3xl text-yellow-600",children:o})]})]}),Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6",children:"Расписание на сегодня"}),0===e.length?Qe.jsx("p",{className:"text-gray-500",children:"Нет записей на сегодня"}):Qe.jsx("div",{className:"space-y-4",children:e.map(e=>Qe.jsx("div",{className:"border border-gray-200 rounded-lg p-6",children:Qe.jsxs("div",{className:"flex items-start justify-between",children:[Qe.jsxs("div",{className:"flex items-start gap-4",children:[Qe.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center",children:Qe.jsx(K,{className:"w-6 h-6 text-pink-600"})}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-lg text-gray-900 mb-1",children:e.datetime.split(" ")[1]}),Qe.jsxs("p",{className:"text-gray-900",children:["Запись #",e.id]}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:e.service}),Qe.jsx("p",{className:"text-gray-600 text-sm",children:e.phone})]})]}),Qe.jsx(Do,{className:"confirmed"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:"confirmed"===e.status?"Подтверждена":"Ожидание"})]})},e.id))})]})]})}function am(){const e=JSON.parse(localStorage.getItem("user")||"{}"),t=e.id,[r,a]=s.useState(null),[n,i]=s.useState(!0),[l,o]=s.useState(!1),[d,c]=s.useState({username:"",full_name:"",email:"",phone:""}),[m,x]=s.useState({old_password:"",new_password:"",confirm_password:""});s.useEffect(()=>{u()},[]);const u=async()=>{try{i(!0);const e=await Ct.getUserProfile(t);a(e),c({username:e.username||"",full_name:e.full_name||"",email:e.email||"",phone:""})}catch(jx){gt.error("Ошибка загрузки профиля")}finally{i(!1)}},h={admin:{label:"Администратор",color:"bg-purple-100 text-purple-800"},manager:{label:"Менеджер",color:"bg-blue-100 text-blue-800"},employee:{label:"Сотрудник",color:"bg-green-100 text-green-800"}};return n?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsxs("div",{className:"flex flex-col items-center gap-4",children:[Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"}),Qe.jsx("p",{className:"text-gray-600",children:"Загрузка профиля..."})]})}):r?Qe.jsx("div",{className:"p-8",children:Qe.jsxs("div",{className:"max-w-5xl mx-auto",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(V,{className:"w-8 h-8 text-pink-600"}),"Мой профиль"]}),Qe.jsx("p",{className:"text-gray-600",children:"Управление личными данными и настройками безопасности"})]}),Qe.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:Qe.jsxs("div",{className:"flex items-start gap-6",children:[Qe.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white text-3xl font-bold flex-shrink-0",children:r.full_name.charAt(0).toUpperCase()}),Qe.jsxs("div",{className:"flex-1",children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 font-bold mb-2",children:r.full_name}),Qe.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[Qe.jsx(Do,{className:h[r.role]?.color||"bg-gray-100 text-gray-800",children:h[r.role]?.label||r.role}),Qe.jsxs("span",{className:"text-sm text-gray-600",children:["@",r.username]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-600",children:[r.email&&Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx(oe,{className:"w-4 h-4 text-gray-500"}),r.email]}),r.created_at&&Qe.jsxs("div",{className:"flex items-center gap-2",children:[Qe.jsx(R,{className:"w-4 h-4 text-gray-500"}),"В системе с ",new Date(r.created_at).toLocaleDateString("ru-RU")]})]})]})]})}),Qe.jsxs(Mc,{defaultValue:"profile",className:"space-y-6",children:[Qe.jsxs(Ac,{className:"grid w-full grid-cols-2",children:[Qe.jsxs(Oc,{value:"profile",children:[Qe.jsx(V,{className:"w-4 h-4 mr-2"}),"Редактировать профиль"]}),Qe.jsxs(Oc,{value:"password",children:[Qe.jsx(ke,{className:"w-4 h-4 mr-2"}),"Сменить пароль"]})]}),Qe.jsx(Wc,{value:"profile",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6 font-semibold",children:"Личная информация"}),Qe.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),!d.username||d.username.length<3)gt.error("Логин должен быть минимум 3 символа");else if(!d.full_name||d.full_name.length<2)gt.error("Имя должно быть минимум 2 символа");else try{o(!0),await Ct.updateUserProfile(t,{username:d.username,full_name:d.full_name,email:d.email});const s={...e,username:d.username,full_name:d.full_name,email:d.email};localStorage.setItem("user",JSON.stringify(s)),await u(),gt.success("✅ Профиль успешно обновлён")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка обновления";gt.error(`❌ ${t}`)}finally{o(!1)}},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"username",children:"Логин *"}),Qe.jsx(oo,{id:"username",required:!0,disabled:l,value:d.username,onChange:e=>c({...d,username:e.target.value}),placeholder:"username",minLength:3}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Минимум 3 символа"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"full_name",children:"Полное имя *"}),Qe.jsx(oo,{id:"full_name",required:!0,disabled:l,value:d.full_name,onChange:e=>c({...d,full_name:e.target.value}),placeholder:"Анна Петрова",minLength:2})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"email",children:"Email"}),Qe.jsxs("div",{className:"relative",children:[Qe.jsx(oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{id:"email",type:"email",disabled:l,value:d.email,onChange:e=>c({...d,email:e.target.value}),placeholder:"anna@example.com",className:"pl-10"})]}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Для восстановления пароля"})]}),Qe.jsx(Ys,{type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700",children:l?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Сохранение..."]}):Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(se,{className:"w-4 h-4 mr-2"}),"Сохранить изменения"]})})]})]})}),Qe.jsx(Wc,{value:"password",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6 font-semibold",children:"Изменить пароль"}),Qe.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:Qe.jsxs("p",{className:"text-sm text-blue-800",children:[Qe.jsx("strong",{children:"💡 Совет:"})," Используйте сложный пароль длиной минимум 6 символов. Комбинируйте буквы, цифры и специальные символы для максимальной безопасности."]})}),Qe.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m.old_password)if(!m.new_password||m.new_password.length<6)gt.error("Новый пароль должен быть минимум 6 символов");else if(m.new_password===m.confirm_password)try{o(!0),await Ct.changePassword(t,{old_password:m.old_password,new_password:m.new_password}),gt.success("✅ Пароль успешно изменён"),x({old_password:"",new_password:"",confirm_password:""})}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка изменения пароля";gt.error(`❌ ${t}`)}finally{o(!1)}else gt.error("Пароли не совпадают");else gt.error("Введите текущий пароль")},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"old_password",children:"Текущий пароль *"}),Qe.jsx(oo,{id:"old_password",type:"password",required:!0,disabled:l,value:m.old_password,onChange:e=>x({...m,old_password:e.target.value}),placeholder:"••••••"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Введите ваш текущий пароль для подтверждения"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"new_password",children:"Новый пароль *"}),Qe.jsx(oo,{id:"new_password",type:"password",required:!0,disabled:l,value:m.new_password,onChange:e=>x({...m,new_password:e.target.value}),placeholder:"••••••",minLength:6}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Минимум 6 символов"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"confirm_password",children:"Подтвердите новый пароль *"}),Qe.jsx(oo,{id:"confirm_password",type:"password",required:!0,disabled:l,value:m.confirm_password,onChange:e=>x({...m,confirm_password:e.target.value}),placeholder:"••••••",minLength:6})]}),Qe.jsx(Ys,{type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700",children:l?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Изменение..."]}):Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(ke,{className:"w-4 h-4 mr-2"}),"Изменить пароль"]})})]})]})})]})]})}):Qe.jsx("div",{className:"p-8",children:Qe.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[Qe.jsx(E,{className:"w-5 h-5 text-red-600"}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-red-800 font-medium",children:"Ошибка загрузки профиля"}),Qe.jsx("p",{className:"text-red-700 text-sm mt-1",children:"Попробуйте перезагрузить страницу"})]})]})})}function nm(){const e=n(),[t,s]=r.useState(!1),[a,i]=r.useState({});r.useEffect(()=>{So().then(i).catch(e=>{})},[]);const o=[{label:"Главная",path:"/"},{label:"Прайс-лист",path:"/price-list"},{label:"О нас",path:"/about"},{label:"Контакты",path:"/contacts"},{label:"FAQ",path:"/faq"}];return Qe.jsxs("div",{className:"min-h-screen flex flex-col",children:[Qe.jsxs("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-50",children:[Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"flex justify-between items-center h-20",children:[Qe.jsxs(m,{to:"/",className:"flex items-center gap-3",children:[Qe.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center",children:Qe.jsx("span",{className:"text-white text-xl",children:"✨"})}),Qe.jsxs("div",{children:[Qe.jsx("h1",{className:"text-xl text-gray-900",children:a.name}),Qe.jsx("p",{className:"text-xs text-gray-500",children:a.tagline})]})]}),Qe.jsx("nav",{className:"hidden md:flex items-center gap-8",children:o.map(t=>Qe.jsx(m,{to:t.path,className:"transition-colors "+(e.pathname===t.path?"text-pink-600":"text-gray-700 hover:text-pink-600"),children:t.label},t.path))}),Qe.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[Qe.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[Qe.jsx(X,{className:"w-4 h-4"}),Qe.jsx("span",{className:"text-sm",children:a.phone})]}),Qe.jsx(m,{to:"/cabinet",className:"px-6 py-2.5 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-full hover:shadow-lg transition-shadow",children:"Войти"})]}),Qe.jsx("button",{className:"md:hidden p-2",onClick:()=>s(!t),children:t?Qe.jsx(g,{className:"w-6 h-6"}):Qe.jsx(Se,{className:"w-6 h-6"})})]})}),t&&Qe.jsx("div",{className:"md:hidden border-t border-gray-200 bg-white",children:Qe.jsxs("nav",{className:"px-4 py-4 space-y-2",children:[o.map(t=>Qe.jsx(m,{to:t.path,className:"block px-4 py-3 rounded-lg "+(e.pathname===t.path?"bg-pink-50 text-pink-600":"text-gray-700 hover:bg-gray-50"),onClick:()=>s(!1),children:t.label},t.path)),Qe.jsx(m,{to:"/cabinet",className:"block px-4 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white text-center rounded-lg",onClick:()=>s(!1),children:"Личный кабинет"})]})})]}),Qe.jsx("main",{className:"flex-1",children:Qe.jsx(l,{})}),Qe.jsx("footer",{className:"bg-gray-900 text-white",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg mb-4",children:a.name}),Qe.jsx("p",{className:"text-gray-400 text-sm",children:a.description||"Премиальные услуги красоты в самом сердце города. Профессиональные мастера и индивидуальный подход."})]}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg mb-4",children:"Быстрые ссылки"}),Qe.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[Qe.jsx("li",{children:Qe.jsx(m,{to:"/price-list",className:"hover:text-white",children:"Прайс-лист"})}),Qe.jsx("li",{children:Qe.jsx(m,{to:"/about",className:"hover:text-white",children:"О нас"})}),Qe.jsx("li",{children:Qe.jsx(m,{to:"/cooperation",className:"hover:text-white",children:"Сотрудничество"})}),Qe.jsx("li",{children:Qe.jsx(m,{to:"/faq",className:"hover:text-white",children:"FAQ"})})]})]}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg mb-4",children:"Контакты"}),Qe.jsxs("ul",{className:"space-y-3 text-sm text-gray-400",children:[Qe.jsxs("li",{className:"flex items-center gap-2",children:[Qe.jsx(X,{className:"w-4 h-4"}),Qe.jsx("span",{children:a.phone})]}),Qe.jsxs("li",{className:"flex items-center gap-2",children:[Qe.jsx(oe,{className:"w-4 h-4"}),Qe.jsx("span",{children:a.email})]}),Qe.jsxs("li",{className:"flex items-center gap-2",children:[Qe.jsx(fe,{className:"w-4 h-4"}),Qe.jsx("span",{children:a.instagram})]})]})]}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg mb-4",children:"Часы работы"}),Qe.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[Qe.jsxs("li",{children:["Пн-Пт: ",a.hours_weekdays]}),Qe.jsxs("li",{children:["Сб-Вс: ",a.hours_weekends]})]})]})]}),Qe.jsxs("div",{className:"border-t border-gray-800 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-400",children:[Qe.jsxs("p",{children:["© 2025 ",a.name,". Все права защищены."]}),Qe.jsxs("div",{className:"flex gap-6",children:[Qe.jsx(m,{to:"/privacy-policy",className:"hover:text-white",children:"Политика конфиденциальности"}),Qe.jsx(m,{to:"/terms",className:"hover:text-white",children:"Условия использования"})]})]})]})})]})}function im(e){const[t,r]=s.useState(!1),{src:a,alt:n,style:i,className:l,...o}=e;return t?Qe.jsx("div",{className:`inline-block bg-gray-100 text-center align-middle ${l??""}`,style:i,children:Qe.jsx("div",{className:"flex items-center justify-center w-full h-full",children:Qe.jsx("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg==",alt:"Error loading image",...o,"data-original-url":a})})}):Qe.jsx("img",{src:a,alt:n,className:l,style:i,...o,onError:()=>{r(!0)}})}const lm=[{name:"Анна Иванова",rating:5,text:"Невероятный сервис! Мастера профессионалы своего дела. Результатом перманентного макияжа очень довольна!",avatar:"А"},{name:"Мария Петрова",rating:5,text:"Лучший салон в городе! Всегда чисто, уютно и внимательный персонал. Хожу сюда уже 2 года.",avatar:"М"},{name:"Елена Сидорова",rating:5,text:"Прекрасный массаж лица! Ощущение релакса и свежести после процедуры. Однозначно рекомендую!",avatar:"Е"}];function om(){const e=i(),[t,r]=s.useState([]),[a,n]=s.useState(lm),[l,o]=s.useState(0),[d,c]=s.useState(!0),[m,x]=s.useState({name:"",phone:"",service:"",date:"",time:""});s.useEffect(()=>{(async()=>{try{const e=(await Co()).services.map(e=>e.name).slice(0,8);r(e)}catch(jx){r(["Перманентный макияж бровей","Маникюр","Педикюр","Массаж лица","Наращивание ресниц","Стрижка и укладка","Окрашивание волос","Чистка лица"])}finally{c(!1)}})()},[]);return Qe.jsxs("div",{children:[Qe.jsxs("section",{className:"relative h-[600px] bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 overflow-hidden",children:[Qe.jsx("div",{className:"absolute inset-0 opacity-20",children:Qe.jsx(im,{src:"https://images.unsplash.com/photo-1695527081827-fdbc4e77be9b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxiZWF1dHklMjBzYWxvbiUyMHNwYSUyMGludGVyaW9yfGVufDF8fHx8MTc2MDg1MDUzNXww&ixlib=rb-4.1.0&q=80&w=1080",alt:"Beauty Salon",className:"w-full h-full object-cover"})}),Qe.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center",children:Qe.jsxs("div",{className:"max-w-2xl",children:[Qe.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[Qe.jsx(me,{className:"w-6 h-6 text-pink-600"}),Qe.jsx("span",{className:"text-pink-600",children:"Премиум услуги красоты"})]}),Qe.jsx("h1",{className:"text-5xl text-gray-900 mb-6",children:"Откройте для себя новый уровень красоты"}),Qe.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Профессиональные мастера, индивидуальный подход и высококачественные материалы. Ваша красота - наша страсть."}),Qe.jsxs("div",{className:"flex gap-4",children:[Qe.jsx(Ys,{size:"lg",className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:shadow-lg",onClick:()=>document.getElementById("booking-form")?.scrollIntoView({behavior:"smooth"}),children:"Записаться сейчас"}),Qe.jsx(Ys,{size:"lg",variant:"outline",onClick:()=>e("/price-list"),children:"Наши услуги"})]})]})})]}),Qe.jsx("section",{className:"py-20 bg-white",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-16",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Почему выбирают нас"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Мы предлагаем лучший сервис в индустрии красоты"})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[Qe.jsxs("div",{className:"text-center p-8 bg-gradient-to-br from-pink-50 to-purple-50 rounded-2xl",children:[Qe.jsx("div",{className:"w-16 h-16 bg-pink-600 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(Ce,{className:"w-8 h-8 text-white"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Опытные мастера"}),Qe.jsx("p",{className:"text-gray-600",children:"Наши специалисты имеют международные сертификаты и многолетний опыт работы"})]}),Qe.jsxs("div",{className:"text-center p-8 bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl",children:[Qe.jsx("div",{className:"w-16 h-16 bg-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(me,{className:"w-8 h-8 text-white"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Премиум материалы"}),Qe.jsx("p",{className:"text-gray-600",children:"Используем только качественные и безопасные материалы от ведущих брендов"})]}),Qe.jsxs("div",{className:"text-center p-8 bg-gradient-to-br from-pink-50 to-purple-50 rounded-2xl",children:[Qe.jsx("div",{className:"w-16 h-16 bg-pink-600 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(K,{className:"w-8 h-8 text-white"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Удобное расписание"}),Qe.jsx("p",{className:"text-gray-600",children:"Работаем 7 дней в неделю с удобными временными слотами для записи"})]})]})]})}),Qe.jsx("section",{className:"py-20 bg-gray-50",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-16",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Наши работы"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Результаты, которыми мы гордимся"})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Qe.jsxs("div",{className:"relative h-80 rounded-2xl overflow-hidden group",children:[Qe.jsx(im,{src:"https://images.unsplash.com/photo-1600637070413-0798fafbb6c7?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxtYWtldXAlMjBhcnRpc3QlMjBjb3NtZXRpY3N8ZW58MXx8fHwxNzYwODUwNTM2fDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Makeup",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),Qe.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-6",children:Qe.jsx("p",{className:"text-white text-lg",children:"Перманентный макияж"})})]}),Qe.jsxs("div",{className:"relative h-80 rounded-2xl overflow-hidden group",children:[Qe.jsx(im,{src:"https://images.unsplash.com/photo-1616394584738-fc6e612e71b9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3b21hbiUyMHNwYSUyMHRyZWF0bWVudHxlbnwxfHx8fDE3NjA3NzczOTJ8MA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Spa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),Qe.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-6",children:Qe.jsx("p",{className:"text-white text-lg",children:"Уход за лицом"})})]}),Qe.jsxs("div",{className:"relative h-80 rounded-2xl overflow-hidden group",children:[Qe.jsx(im,{src:"https://images.unsplash.com/photo-1695527081827-fdbc4e77be9b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxiZWF1dHklMjBzYWxvbiUyMHNwYSUyMGludGVyaW9yfGVufDF8fHx8MTc2MDg1MDUzNXww&ixlib=rb-4.1.0&q=80&w=1080",alt:"Salon Interior",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),Qe.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end p-6",children:Qe.jsx("p",{className:"text-white text-lg",children:"Наш салон"})})]})]})]})}),Qe.jsx("section",{className:"py-20 bg-white",children:Qe.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-16",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Отзывы наших клиентов"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Что говорят о нас"})]}),a.length>0?Qe.jsxs("div",{className:"relative bg-gradient-to-br from-pink-50 to-purple-50 rounded-2xl p-12",children:[Qe.jsx("button",{onClick:()=>{o(e=>(e-1+a.length)%a.length)},className:"absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-50 transition-colors",children:Qe.jsx(re,{className:"w-6 h-6"})}),Qe.jsx("button",{onClick:()=>{o(e=>(e+1)%a.length)},className:"absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 bg-white rounded-full shadow-lg flex items-center justify-center hover:bg-gray-50 transition-colors",children:Qe.jsx(ae,{className:"w-6 h-6"})}),Qe.jsxs("div",{className:"text-center",children:[Qe.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white text-3xl mx-auto mb-6",children:a[l].avatar}),Qe.jsx("div",{className:"flex justify-center gap-1 mb-4",children:[...Array(a[l].rating)].map((e,t)=>Qe.jsx(Ce,{className:"w-5 h-5 fill-yellow-400 text-yellow-400"},t))}),Qe.jsxs("p",{className:"text-xl text-gray-700 mb-6 italic",children:['"',a[l].text,'"']}),Qe.jsx("p",{className:"text-lg text-gray-900",children:a[l].name})]})]}):null]})}),Qe.jsx("section",{id:"booking-form",className:"py-20 bg-gray-50",children:Qe.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-12",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Записаться на процедуру"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Заполните форму и мы свяжемся с вами для подтверждения"})]}),d?Qe.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:Qe.jsx("p",{className:"text-gray-600",children:"Загрузка услуг..."})}):Qe.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:Qe.jsxs("form",{onSubmit:t=>{t.preventDefault(),m.name&&m.phone&&m.service&&m.date&&m.time?e("/success",{state:m}):gt.error("Пожалуйста, заполните все поля")},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"name",children:"Ваше имя *"}),Qe.jsx(oo,{id:"name",required:!0,value:m.name,onChange:e=>x({...m,name:e.target.value}),placeholder:"Анна Иванова"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"phone",children:"Телефон *"}),Qe.jsx(oo,{id:"phone",type:"tel",required:!0,value:m.phone,onChange:e=>x({...m,phone:e.target.value}),placeholder:"+971 50 123 4567"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"service",children:"Услуга *"}),Qe.jsxs(to,{required:!0,value:m.service,onValueChange:e=>x({...m,service:e}),children:[Qe.jsx(ro,{children:Qe.jsx(so,{placeholder:"Выберите услугу"})}),Qe.jsx(ao,{children:t.map(e=>Qe.jsx(no,{value:e,children:e},e))})]})]}),Qe.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"date",children:"Дата *"}),Qe.jsx(oo,{id:"date",type:"date",required:!0,value:m.date,onChange:e=>x({...m,date:e.target.value})})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"time",children:"Время *"}),Qe.jsx(oo,{id:"time",type:"time",required:!0,value:m.time,onChange:e=>x({...m,time:e.target.value})})]})]}),Qe.jsxs(Ys,{type:"submit",className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:shadow-lg",size:"lg",children:[Qe.jsx(R,{className:"w-5 h-5 mr-2"}),"Записаться"]})]})})]})})]})}function dm(){const e=i(),[t,r]=s.useState([]),[a,n]=s.useState(!0),[l,o]=s.useState(null);s.useEffect(()=>{(async()=>{try{const e=await Co();r(e.services)}catch(jx){o("Ошибка загрузки услуг")}finally{n(!1)}})()},[]);const d=t.reduce((e,t)=>{const s=t.category||"other";return e[s]||(e[s]=[]),e[s].push(t),e},{}),c={"permanent-makeup":"💄","facial-care":"✨",nails:"💅",lashes:"👁️",hair:"✂️",massage:"💖",other:"🌟"};return a?Qe.jsx("div",{className:"py-20",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center",children:Qe.jsx("p",{className:"text-gray-600",children:"Загрузка услуг..."})})}):l||0===t.length?Qe.jsx("div",{className:"py-20",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4",children:Qe.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[Qe.jsx(E,{className:"w-5 h-5 text-red-600"}),Qe.jsx("span",{className:"text-red-800",children:l||"Услуги не найдены"})]})})}):Qe.jsxs("div",{children:[Qe.jsx("section",{className:"bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 py-20",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("h1",{className:"text-5xl text-gray-900 mb-4",children:"Наши услуги и цены"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Премиальные услуги красоты по доступным ценам"})]})}),Qe.jsx("section",{className:"bg-white border-b border-gray-200 py-8",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("p",{className:"text-lg text-gray-700 mb-4",children:"Готовы преобразиться?"}),Qe.jsx(Ys,{size:"lg",className:"bg-gradient-to-r from-pink-500 to-purple-600",onClick:()=>e("/"),children:"Записаться на процедуру"})]})}),Qe.jsx("section",{className:"py-16",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsx("div",{className:"space-y-16",children:Object.entries(d).map(([e,t])=>Qe.jsxs("div",{children:[Qe.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[Qe.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-pink-500 to-purple-600 rounded-xl flex items-center justify-center text-3xl",children:c[e]||"🌟"}),Qe.jsx("h2",{className:"text-3xl text-gray-900",children:"permanent-makeup"===e?"Перманентный макияж":"facial-care"===e?"Уход за лицом":"nails"===e?"Ногтевой сервис":"lashes"===e?"Ресницы и брови":"hair"===e?"Парикмахерские услуги":"massage"===e?"Массаж":"Другие услуги"})]}),Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(e=>Qe.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:[Qe.jsxs("div",{className:"flex justify-between items-start mb-3",children:[Qe.jsx("h3",{className:"text-xl text-gray-900",children:e.name}),Qe.jsxs("p",{className:"text-2xl text-pink-600 ml-4",children:[e.price," AED"]})]}),Qe.jsx("p",{className:"text-gray-600",children:e.description})]},e.id))})]},e))})})}),Qe.jsx("section",{className:"bg-gradient-to-br from-pink-50 to-purple-50 py-16",children:Qe.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("h2",{className:"text-3xl text-gray-900 mb-4",children:"Готовы записаться?"}),Qe.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Выберите удобное время и насладитесь нашими премиальными услугами"}),Qe.jsx(Ys,{size:"lg",className:"bg-gradient-to-r from-pink-500 to-purple-600",onClick:()=>e("/"),children:"Записаться сейчас"})]})})]})}function cm(){const e=i(),t=n().state||{};return Qe.jsx("div",{className:"py-20",children:Qe.jsx("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-12 text-center",children:[Qe.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(I,{className:"w-12 h-12 text-green-600"})}),Qe.jsx("h1",{className:"text-4xl text-gray-900 mb-4",children:"Запись подтверждена!"}),t.name&&Qe.jsxs("p",{className:"text-xl text-gray-600 mb-6",children:["Спасибо, ",t.name,"!"]}),t.service&&Qe.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-br from-pink-50 to-purple-50 rounded-xl",children:[Qe.jsxs("p",{className:"text-lg text-gray-700 mb-2",children:["Ваша запись на ",Qe.jsx("span",{className:"text-pink-600",children:t.service})," успешно создана."]}),t.date&&t.time&&Qe.jsxs("p",{className:"text-gray-600",children:[new Date(t.date).toLocaleDateString("ru-RU")," в ",t.time]})]}),Qe.jsx("p",{className:"text-gray-600 mb-8",children:"Мы свяжемся с вами в ближайшее время для подтверждения деталей записи."}),Qe.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[Qe.jsx(Ys,{onClick:()=>e("/"),className:"bg-gradient-to-r from-pink-500 to-purple-600",children:"Вернуться на главную"}),Qe.jsx(Ys,{onClick:()=>e("/price-list"),variant:"outline",children:"Посмотреть услуги"})]})]})})})}function mm(){const[e,t]=r.useState({});return r.useEffect(()=>{So().then(t).catch(e=>{})},[]),Qe.jsx("div",{className:"py-20",children:Qe.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-12",children:[Qe.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[Qe.jsx("div",{className:"w-16 h-16 bg-pink-100 rounded-xl flex items-center justify-center",children:Qe.jsx(O,{className:"w-8 h-8 text-pink-600"})}),Qe.jsx("h1",{className:"text-4xl text-gray-900",children:"Условия использования"})]}),Qe.jsxs("div",{className:"prose prose-pink max-w-none space-y-6 text-gray-700",children:[Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"1. Общие положения"}),Qe.jsx("p",{children:"Настоящие Условия использования регулируют использование услуг Luxury Beauty Salon. Используя наши услуги, вы соглашаетесь с данными условиями."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"2. Бронирование и отмена"}),Qe.jsx("p",{children:"Для записи на процедуры необходимо предоставить корректную контактную информацию. Мы оставляем за собой право подтвердить или отклонить бронирование."}),Qe.jsxs("p",{className:"mt-3",children:[Qe.jsx("strong",{children:"Отмена записи:"})," Клиент может отменить запись не позднее чем за 24 часа до назначенного времени. При отмене менее чем за 24 часа может взиматься штраф в размере 50% от стоимости услуги."]})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"3. Оплата услуг"}),Qe.jsx("p",{children:"Оплата производится наличными или картой после оказания услуги. Цены на услуги указаны в прайс-листе и могут быть изменены без предварительного уведомления."}),Qe.jsx("p",{className:"mt-3",children:"В случае опоздания клиента более чем на 15 минут, салон оставляет за собой право отменить запись или сократить время процедуры."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"4. Медицинские противопоказания"}),Qe.jsx("p",{children:"Клиент обязан сообщить мастеру о наличии любых медицинских противопоказаний, аллергий или особенностей здоровья перед проведением процедуры."}),Qe.jsx("p",{className:"mt-3",children:"Салон не несет ответственности за последствия процедур, если клиент скрыл информацию о медицинских противопоказаниях."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"5. Гарантии и ответственность"}),Qe.jsx("p",{children:"Мы гарантируем качество используемых материалов и профессионализм наших мастеров. Результат процедур может варьироваться в зависимости от индивидуальных особенностей клиента."}),Qe.jsx("p",{className:"mt-3",children:"В случае неудовлетворенности результатом, клиент должен обратиться в салон в течение 7 дней для обсуждения возможных вариантов решения."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"6. Конфиденциальность"}),Qe.jsxs("p",{children:["Мы уважаем вашу конфиденциальность и обязуемся защищать ваши персональные данные в соответствии с нашей ",Qe.jsx("a",{href:"/privacy-policy",className:"text-pink-600 hover:underline",children:"Политикой конфиденциальности"}),"."]})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"7. Изменения условий"}),Qe.jsx("p",{children:"Мы оставляем за собой право изменять данные Условия использования в любое время. Изменения вступают в силу с момента публикации на сайте."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"8. Контакты"}),Qe.jsx("p",{children:"По всем вопросам, связанным с данными Условиями, вы можете связаться с нами:"}),Qe.jsxs("ul",{className:"list-disc pl-6 mt-3 space-y-2",children:[Qe.jsxs("li",{children:["Телефон: ",e.phone]}),Qe.jsxs("li",{children:["Email: ",e.email]}),Qe.jsxs("li",{children:["Адрес: ",e.address]})]})]})]}),Qe.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200 text-center text-gray-500 text-sm",children:Qe.jsxs("p",{children:["Дата последнего обновления: ",(new Date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})]})})]})})})}function xm(){const[e,t]=r.useState({});return r.useEffect(()=>{So().then(t).catch(e=>{})},[]),Qe.jsx("div",{className:"py-20",children:Qe.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-12",children:[Qe.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[Qe.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-xl flex items-center justify-center",children:Qe.jsx(le,{className:"w-8 h-8 text-purple-600"})}),Qe.jsx("h1",{className:"text-4xl text-gray-900",children:"Политика конфиденциальности"})]}),Qe.jsxs("div",{className:"prose prose-purple max-w-none space-y-6 text-gray-700",children:[Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"1. Введение"}),Qe.jsx("p",{children:"Luxury Beauty Salon серьезно относится к защите вашей конфиденциальности. Данная Политика конфиденциальности описывает, какую информацию мы собираем, как мы ее используем и защищаем."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"2. Собираемая информация"}),Qe.jsx("p",{children:"Мы можем собирать следующую информацию:"}),Qe.jsxs("ul",{className:"list-disc pl-6 mt-3 space-y-2",children:[Qe.jsx("li",{children:"Имя и контактную информацию (телефон, email)"}),Qe.jsx("li",{children:"История посещений и оказанных услуг"}),Qe.jsx("li",{children:"Предпочтения в услугах и процедурах"}),Qe.jsx("li",{children:"Информацию о медицинских противопоказаниях (с вашего согласия)"}),Qe.jsx("li",{children:"Фотографии результатов работы (только с вашего письменного согласия)"})]})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"3. Использование информации"}),Qe.jsx("p",{children:"Мы используем собранную информацию для:"}),Qe.jsxs("ul",{className:"list-disc pl-6 mt-3 space-y-2",children:[Qe.jsx("li",{children:"Организации и подтверждения ваших записей"}),Qe.jsx("li",{children:"Предоставления качественных услуг с учетом ваших особенностей"}),Qe.jsx("li",{children:"Отправки напоминаний о записях"}),Qe.jsx("li",{children:"Информирования о новых услугах и специальных предложениях (с вашего согласия)"}),Qe.jsx("li",{children:"Улучшения качества наших услуг"})]})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"4. Защита данных"}),Qe.jsx("p",{children:"Мы принимаем все необходимые меры для защиты ваших персональных данных от несанкционированного доступа, изменения, раскрытия или уничтожения."}),Qe.jsx("p",{className:"mt-3",children:"Доступ к вашим данным имеют только уполномоченные сотрудники, которые обязаны соблюдать конфиденциальность."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"5. Передача данных третьим лицам"}),Qe.jsx("p",{children:"Мы не продаем, не обмениваем и не передаем вашу личную информацию третьим лицам без вашего явного согласия, за исключением случаев, предусмотренных законодательством."}),Qe.jsx("p",{className:"mt-3",children:"Мы можем передавать обезличенную статистическую информацию нашим партнерам для улучшения качества услуг."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"6. Cookies и технологии отслеживания"}),Qe.jsx("p",{children:"Наш веб-сайт может использовать файлы cookie для улучшения пользовательского опыта. Вы можете отключить cookies в настройках вашего браузера."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"7. Ваши права"}),Qe.jsx("p",{children:"Вы имеете право:"}),Qe.jsxs("ul",{className:"list-disc pl-6 mt-3 space-y-2",children:[Qe.jsx("li",{children:"Запросить доступ к вашим персональным данным"}),Qe.jsx("li",{children:"Запросить исправление неточных данных"}),Qe.jsx("li",{children:"Запросить удаление ваших данных"}),Qe.jsx("li",{children:"Отозвать согласие на обработку данных в любое время"}),Qe.jsx("li",{children:"Отказаться от получения рекламных рассылок"})]})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"8. Хранение данных"}),Qe.jsx("p",{children:"Мы храним ваши персональные данные только в течение времени, необходимого для целей, указанных в данной Политике, или в соответствии с требованиями законодательства."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"9. Изменения в Политике"}),Qe.jsx("p",{children:"Мы оставляем за собой право обновлять данную Политику конфиденциальности. Обновления будут опубликованы на этой странице с указанием даты последнего изменения."})]}),Qe.jsxs("section",{children:[Qe.jsx("h2",{className:"text-2xl text-gray-900 mb-4",children:"10. Контакты"}),Qe.jsx("p",{children:"По вопросам, касающимся данной Политики конфиденциальности, вы можете связаться с нами:"}),Qe.jsxs("ul",{className:"list-disc pl-6 mt-3 space-y-2",children:[Qe.jsxs("li",{children:["Телефон: ",e.phone]}),Qe.jsxs("li",{children:["Email: ",e.email]}),Qe.jsxs("li",{children:["Адрес: ",e.address]})]})]})]}),Qe.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200 text-center text-gray-500 text-sm",children:Qe.jsxs("p",{children:["Дата последнего обновления: ",(new Date).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})]})})]})})})}function um(){const e=i(),[t,r]=s.useState([]),[a,n]=s.useState(!0),[l,o]=s.useState({});return s.useEffect(()=>{(async()=>{try{const e=await So();o(e);const t=await _o();if(t.employees&&t.employees.length>0){const e=t.employees.map(e=>({id:e.id,name:e.full_name,role:e.position||"Мастер",experience:e.experience||"",avatar:e.photo||e.full_name.charAt(0).toUpperCase()}));r(e)}else r([])}catch(jx){r([])}finally{n(!1)}})()},[]),Qe.jsxs("div",{children:[Qe.jsx("section",{className:"bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 py-20",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[Qe.jsx("h1",{className:"text-5xl text-gray-900 mb-6",children:"О нас"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Мы создаем красоту и уверенность уже более 10 лет. Наша миссия - помочь каждой женщине почувствовать себя прекрасной и особенной."})]})})}),Qe.jsx("section",{className:"py-20 bg-white",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[Qe.jsxs("div",{children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-6",children:"Наша история"}),Qe.jsxs("div",{className:"space-y-4 text-gray-600 text-lg",children:[Qe.jsxs("p",{children:[l.name||"Наш салон"," - ваш надежный партнер в мире красоты"]}),Qe.jsx("p",{children:"За годы работы мы стали одним из ведущих салонов красоты в Дубае, обслужив более 10,000 довольных клиенток. Наша репутация построена на доверии, профессионализме и любви к своему делу."}),Qe.jsx("p",{children:"Мы постоянно развиваемся, следим за последними трендами в индустрии красоты и используем только проверенные, качественные материалы и оборудование."})]})]}),Qe.jsx("div",{className:"relative h-[500px] rounded-2xl overflow-hidden shadow-2xl",children:Qe.jsx(im,{src:"https://images.unsplash.com/photo-1695527081827-fdbc4e77be9b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxiZWF1dHklMjBzYWxvbiUyMHNwYSUyMGludGVyaW9yfGVufDF8fHx8MTc2MDg1MDUzNXww&ixlib=rb-4.1.0&q=80&w=1080",alt:"Salon Interior",className:"w-full h-full object-cover"})})]})})}),Qe.jsx("section",{className:"py-20 bg-gray-50",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-16",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Наши ценности"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Принципы, которыми мы руководствуемся"})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[Qe.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center",children:[Qe.jsx("div",{className:"w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(_e,{className:"w-8 h-8 text-pink-600"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Любовь к делу"}),Qe.jsx("p",{className:"text-gray-600",children:"Мы любим то, что делаем, и это отражается в каждой процедуре"})]}),Qe.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center",children:[Qe.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(ze,{className:"w-8 h-8 text-purple-600"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Профессионализм"}),Qe.jsx("p",{className:"text-gray-600",children:"Наши мастера регулярно повышают квалификацию"})]}),Qe.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center",children:[Qe.jsx("div",{className:"w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(y,{className:"w-8 h-8 text-cyan-600"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Клиентоориентированность"}),Qe.jsx("p",{className:"text-gray-600",children:"Ваш комфорт и удовлетворенность - наш приоритет"})]}),Qe.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm text-center",children:[Qe.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(me,{className:"w-8 h-8 text-amber-600"})}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-3",children:"Качество"}),Qe.jsx("p",{className:"text-gray-600",children:"Используем только премиальные материалы и оборудование"})]})]})]})}),Qe.jsx("section",{className:"py-20 bg-white",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-16",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Наша команда"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Познакомьтесь с нашими талантливыми мастерами"})]}),a?Qe.jsx("div",{className:"text-center py-12",children:Qe.jsx("p",{className:"text-gray-600",children:"Загрузка команды..."})}):t.length>0?Qe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map(e=>Qe.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-purple-50 rounded-2xl p-8 text-center",children:[Qe.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center text-white text-3xl mx-auto mb-6",children:e.avatar}),Qe.jsx("h3",{className:"text-xl text-gray-900 mb-2",children:e.name}),Qe.jsx("p",{className:"text-pink-600 mb-2",children:e.role}),Qe.jsx("p",{className:"text-sm text-gray-600",children:e.experience})]},e.id))}):Qe.jsxs("div",{className:"text-center py-12 bg-gradient-to-br from-pink-50 to-purple-50 rounded-2xl",children:[Qe.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(y,{className:"w-10 h-10 text-white"})}),Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Наша команда профессионалов"}),Qe.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"В нашем салоне работают опытные мастера с международными сертификатами. Каждый специалист имеет богатый опыт и регулярно повышает свою квалификацию, чтобы предоставлять вам услуги высочайшего качества."})]})]})}),Qe.jsx("section",{className:"py-20 bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-5xl text-pink-600 mb-2",children:"10+"}),Qe.jsx("p",{className:"text-gray-700",children:"Лет опыта"})]}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-5xl text-purple-600 mb-2",children:"10K+"}),Qe.jsx("p",{className:"text-gray-700",children:"Довольных клиентов"})]}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-5xl text-pink-600 mb-2",children:"15+"}),Qe.jsx("p",{className:"text-gray-700",children:"Видов услуг"})]}),Qe.jsxs("div",{children:[Qe.jsx("p",{className:"text-5xl text-purple-600 mb-2",children:"50+"}),Qe.jsx("p",{className:"text-gray-700",children:"Наград и сертификатов"})]})]})})}),Qe.jsx("section",{className:"py-20 bg-white",children:Qe.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-6",children:"Готовы преобразиться?"}),Qe.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Запишитесь на процедуру прямо сейчас и ощутите разницу"}),Qe.jsx(Ys,{size:"lg",className:"bg-gradient-to-r from-pink-500 to-purple-600",onClick:()=>e("/"),children:"Записаться на процедуру"})]})})]})}function hm(){const[e,t]=s.useState({name:"",email:"",message:""}),[r,a]=s.useState(!1),[n,i]=s.useState({});s.useEffect(()=>{So().then(e=>i(e)).catch(e=>{})},[]);return Qe.jsxs("div",{children:[Qe.jsx("section",{className:"bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 py-20",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("h1",{className:"text-5xl text-gray-900 mb-4",children:"Контакты"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Свяжитесь с нами удобным для вас способом"})]})}),Qe.jsx("section",{className:"py-20",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[Qe.jsxs("div",{children:[Qe.jsx("h2",{className:"text-3xl text-gray-900 mb-8",children:"Как с нами связаться"}),Qe.jsxs("div",{className:"space-y-6",children:[Qe.jsxs("div",{className:"flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(Ee,{className:"w-6 h-6 text-pink-600"})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-1",children:"Адрес"}),Qe.jsx("p",{className:"text-gray-600",children:n.address})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(X,{className:"w-6 h-6 text-purple-600"})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-1",children:"Телефон"}),Qe.jsx("p",{className:"text-gray-600",children:n.phone}),Qe.jsx("p",{className:"text-gray-600",children:"+971 4 123 4567"})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("div",{className:"w-12 h-12 bg-cyan-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(oe,{className:"w-6 h-6 text-cyan-600"})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-1",children:"Email"}),Qe.jsx("p",{className:"text-gray-600",children:n.email}),Qe.jsx("p",{className:"text-gray-600",children:"booking@luxurybeauty.ae"})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(fe,{className:"w-6 h-6 text-pink-600"})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-1",children:"Instagram"}),Qe.jsx("a",{href:"https://instagram.com/luxurybeauty_dubai",target:"_blank",rel:"noopener noreferrer",className:"text-pink-600 hover:underline",children:n.instagram})]})]}),Qe.jsxs("div",{className:"flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-200",children:[Qe.jsx("div",{className:"w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0",children:Qe.jsx(K,{className:"w-6 h-6 text-amber-600"})}),Qe.jsxs("div",{children:[Qe.jsx("h3",{className:"text-lg text-gray-900 mb-2",children:"Часы работы"}),Qe.jsxs("div",{className:"space-y-1 text-gray-600",children:[Qe.jsxs("p",{children:["Пн-Пт: ",n.working_hours?.weekdays]}),Qe.jsxs("p",{children:["Сб-Вс: ",n.working_hours?.weekends||"10:00 - 20:00"]})]})]})]})]})]}),Qe.jsxs("div",{children:[Qe.jsx("h2",{className:"text-3xl text-gray-900 mb-8",children:"Напишите нам"}),Qe.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:Qe.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),e.name&&e.email&&e.message){a(!0);try{(await fetch("/api/send-message",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,email:e.email,message:e.message})})).ok?(gt.success("Ваше сообщение отправлено! Мы свяжемся с вами в ближайшее время."),t({name:"",email:"",message:""})):gt.error("Ошибка отправки сообщения")}catch(jx){gt.error("Ошибка отправки. Попробуйте позже.")}finally{a(!1)}}else gt.error("Пожалуйста, заполните все поля")},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"name",children:"Ваше имя *"}),Qe.jsx(oo,{id:"name",required:!0,disabled:r,value:e.name,onChange:s=>t({...e,name:s.target.value}),placeholder:"Анна Иванова"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"email",children:"Email *"}),Qe.jsx(oo,{id:"email",type:"email",required:!0,disabled:r,value:e.email,onChange:s=>t({...e,email:s.target.value}),placeholder:"anna@example.com"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"message",children:"Сообщение *"}),Qe.jsx(_d,{id:"message",required:!0,disabled:r,value:e.message,onChange:s=>t({...e,message:s.target.value}),placeholder:"Расскажите нам, чем мы можем вам помочь...",className:"min-h-[150px]"})]}),Qe.jsxs(Ys,{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600",size:"lg",children:[Qe.jsx(ve,{className:"w-4 h-4 mr-2"}),r?"Отправка...":"Отправить сообщение"]})]})})]})]})})}),Qe.jsx("section",{className:"pb-20",children:Qe.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsx("div",{className:"bg-gray-200 rounded-2xl overflow-hidden h-[450px]",children:Qe.jsx("iframe",{src:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3613.073739144155!2d55.139160315018805!3d25.077796983952966!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3e5f6b2e2c0e0e0d%3A0x0!2sDubai%20Marina!5e0!3m2!1sen!2sae!4v1634567890123!5m2!1sen!2sae",width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",title:"Salon Location"})})})})]})}function pm(){const[e,t]=s.useState({});s.useEffect(()=>{So().then(t).catch(e=>{})},[]);const[r,a]=s.useState({name:"",company:"",email:"",phone:"",proposal:""});return Qe.jsxs("div",{children:[Qe.jsx("section",{className:"bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 py-20",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:Qe.jsx(Re,{className:"w-10 h-10 text-pink-600"})}),Qe.jsx("h1",{className:"text-5xl text-gray-900 mb-4",children:"Сотрудничество"}),Qe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Мы открыты для взаимовыгодного партнерства и новых возможностей"})]})}),Qe.jsx("section",{className:"py-20 bg-white",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-16",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Виды сотрудничества"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Мы рассматриваем различные формы партнерства"})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[Qe.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-purple-50 p-8 rounded-2xl",children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Поставщики"}),Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Мы заинтересованы в сотрудничестве с поставщиками качественных материалов и оборудования для салонов красоты."}),Qe.jsxs("ul",{className:"space-y-2 text-gray-600",children:[Qe.jsx("li",{children:"• Косметические сред��тва"}),Qe.jsx("li",{children:"• Оборудование"}),Qe.jsx("li",{children:"• Расходные материалы"})]})]}),Qe.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-8 rounded-2xl",children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Инфлюенсеры"}),Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Предлагаем взаимовыгодное сотрудничество блогерам и инфлюенсерам в сфере красоты и здорового образа жизни."}),Qe.jsxs("ul",{className:"space-y-2 text-gray-600",children:[Qe.jsx("li",{children:"• Бартерное сотрудничество"}),Qe.jsx("li",{children:"• Промо-коды для подписчиков"}),Qe.jsx("li",{children:"• Совместные проекты"})]})]}),Qe.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-purple-50 p-8 rounded-2xl",children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Мастера"}),Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Приглашаем к сотрудничеству опытных мастеров различных специализаций для работы в нашем салоне."}),Qe.jsxs("ul",{className:"space-y-2 text-gray-600",children:[Qe.jsx("li",{children:"• Аренда кабинета"}),Qe.jsx("li",{children:"• Процент от выручки"}),Qe.jsx("li",{children:"• Фиксированная ставка"})]})]}),Qe.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-8 rounded-2xl",children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Обучение"}),Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Сотрудничаем с образовательными центрами и приглашаем преподавателей для проведения мастер-классов."}),Qe.jsxs("ul",{className:"space-y-2 text-gray-600",children:[Qe.jsx("li",{children:"• Мастер-классы"}),Qe.jsx("li",{children:"• Курсы повышения квалификации"}),Qe.jsx("li",{children:"• Сертификация"})]})]}),Qe.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-purple-50 p-8 rounded-2xl",children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Маркетинг"}),Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Рассматриваем предложения от маркетинговых агентс��в и специалистов по продвижению."}),Qe.jsxs("ul",{className:"space-y-2 text-gray-600",children:[Qe.jsx("li",{children:"• SMM продвижение"}),Qe.jsx("li",{children:"• Контент-маркетинг"}),Qe.jsx("li",{children:"• Performance маркетинг"})]})]}),Qe.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-8 rounded-2xl",children:[Qe.jsx("h3",{className:"text-2xl text-gray-900 mb-4",children:"Другие предложения"}),Qe.jsx("p",{className:"text-gray-600 mb-4",children:"Мы всегда открыты для интересных идей и нестандартных форм сотрудничества."}),Qe.jsxs("ul",{className:"space-y-2 text-gray-600",children:[Qe.jsx("li",{children:"• Совместные акции"}),Qe.jsx("li",{children:"• Кросс-промо"}),Qe.jsx("li",{children:"• Инновационные проекты"})]})]})]})]})}),Qe.jsx("section",{className:"py-20 bg-gray-50",children:Qe.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-12",children:[Qe.jsx("h2",{className:"text-4xl text-gray-900 mb-4",children:"Форма предложения"}),Qe.jsx("p",{className:"text-xl text-gray-600",children:"Опишите ваше предложение, и мы свяжемся с вами"})]}),Qe.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:Qe.jsxs("form",{onSubmit:e=>{e.preventDefault(),gt.success("Спасибо за ваше предложение! Мы рассмотрим его и свяжемся с вами."),a({name:"",company:"",email:"",phone:"",proposal:""})},className:"space-y-6",children:[Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"name",children:"Ваше имя *"}),Qe.jsx(oo,{id:"name",required:!0,value:r.name,onChange:e=>a({...r,name:e.target.value}),placeholder:"Иван Иванов"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"company",children:"Компания"}),Qe.jsx(oo,{id:"company",value:r.company,onChange:e=>a({...r,company:e.target.value}),placeholder:"Название компании"})]})]}),Qe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"email",children:"Email *"}),Qe.jsx(oo,{id:"email",type:"email",required:!0,value:r.email,onChange:e=>a({...r,email:e.target.value}),placeholder:"ivan@example.com"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"phone",children:"Телефон"}),Qe.jsx(oo,{id:"phone",type:"tel",value:r.phone,onChange:e=>a({...r,phone:e.target.value}),placeholder:"+971 52 696 1100"})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"proposal",children:"Ваше предложение *"}),Qe.jsx(_d,{id:"proposal",required:!0,value:r.proposal,onChange:e=>a({...r,proposal:e.target.value}),placeholder:"Расскажите подробнее о вашем предложении...",className:"min-h-[180px]"})]}),Qe.jsxs(Ys,{type:"submit",className:"w-full bg-gradient-to-r from-pink-500 to-purple-600",size:"lg",children:[Qe.jsx(ve,{className:"w-4 h-4 mr-2"}),"Отправить предложение"]})]})}),Qe.jsx("div",{className:"mt-8 text-center text-gray-600",children:Qe.jsxs("p",{children:["Или свяжитесь с нами напрямую: ",Qe.jsx("br",{}),e.email&&Qe.jsx("a",{href:`mailto:${e.email}`,className:"text-pink-600 hover:underline",children:e.email})]})})]})})]})}var gm="Collapsible",[fm,bm]=Gs(gm),[ym,jm]=fm(gm),vm=s.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:a,defaultOpen:n,disabled:i,onOpenChange:l,...o}=e,[d,c]=Vn({prop:a,defaultProp:n??!1,onChange:l,caller:gm});return Qe.jsx(ym,{scope:r,disabled:i,contentId:zr(),open:d,onOpenToggle:s.useCallback(()=>c(e=>!e),[c]),children:Qe.jsx(sr.div,{"data-state":_m(d),"data-disabled":i?"":void 0,...o,ref:t})})});vm.displayName=gm;var wm="CollapsibleTrigger",Nm=s.forwardRef((e,t)=>{const{__scopeCollapsible:s,...r}=e,a=jm(wm,s);return Qe.jsx(sr.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":_m(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:Js(e.onClick,a.onOpenToggle)})});Nm.displayName=wm;var km="CollapsibleContent",Sm=s.forwardRef((e,t)=>{const{forceMount:s,...r}=e,a=jm(km,e.__scopeCollapsible);return Qe.jsx(Io,{present:s||a.open,children:({present:e})=>Qe.jsx(Cm,{...r,ref:t,present:e})})});Sm.displayName=km;var Cm=s.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:a,children:n,...i}=e,l=jm(km,r),[o,d]=s.useState(a),c=s.useRef(null),m=Rt(t,c),x=s.useRef(0),u=x.current,h=s.useRef(0),p=h.current,g=l.open||o,f=s.useRef(g),b=s.useRef(void 0);return s.useEffect(()=>{const e=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(e)},[]),Sr(()=>{const e=c.current;if(e){b.current=b.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";const t=e.getBoundingClientRect();x.current=t.height,h.current=t.width,f.current||(e.style.transitionDuration=b.current.transitionDuration,e.style.animationName=b.current.animationName),d(a)}},[l.open,a]),Qe.jsx(sr.div,{"data-state":_m(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!g,...i,ref:m,style:{"--radix-collapsible-content-height":u?`${u}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...e.style},children:g&&n})});function _m(e){return e?"open":"closed"}var zm=vm,Em=Nm,Rm=Sm,Tm="Accordion",Dm=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Im,Lm,Pm]=Qs(Tm),[Mm]=Gs(Tm,[Pm,bm]),Am=bm(),Om=r.forwardRef((e,t)=>{const{type:s,...r}=e,a=r,n=r;return Qe.jsx(Im.Provider,{scope:e.__scopeAccordion,children:"multiple"===s?Qe.jsx(qm,{...n,ref:t}):Qe.jsx(Um,{...a,ref:t})})});Om.displayName=Tm;var[Wm,Bm]=Mm(Tm),[Fm,$m]=Mm(Tm,{collapsible:!1}),Um=r.forwardRef((e,t)=>{const{value:s,defaultValue:a,onValueChange:n=()=>{},collapsible:i=!1,...l}=e,[o,d]=Vn({prop:s,defaultProp:a??"",onChange:n,caller:Tm});return Qe.jsx(Wm,{scope:e.__scopeAccordion,value:r.useMemo(()=>o?[o]:[],[o]),onItemOpen:d,onItemClose:r.useCallback(()=>i&&d(""),[i,d]),children:Qe.jsx(Fm,{scope:e.__scopeAccordion,collapsible:i,children:Qe.jsx(Ym,{...l,ref:t})})})}),qm=r.forwardRef((e,t)=>{const{value:s,defaultValue:a,onValueChange:n=()=>{},...i}=e,[l,o]=Vn({prop:s,defaultProp:a??[],onChange:n,caller:Tm}),d=r.useCallback(e=>o((t=[])=>[...t,e]),[o]),c=r.useCallback(e=>o((t=[])=>t.filter(t=>t!==e)),[o]);return Qe.jsx(Wm,{scope:e.__scopeAccordion,value:l,onItemOpen:d,onItemClose:c,children:Qe.jsx(Fm,{scope:e.__scopeAccordion,collapsible:!0,children:Qe.jsx(Ym,{...i,ref:t})})})}),[Hm,Vm]=Mm(Tm),Ym=r.forwardRef((e,t)=>{const{__scopeAccordion:s,disabled:a,dir:n,orientation:i="vertical",...l}=e,o=Rt(r.useRef(null),t),d=Lm(s),c="ltr"===tr(n),m=Js(e.onKeyDown,e=>{if(!Dm.includes(e.key))return;const t=e.target,s=d().filter(e=>!e.ref.current?.disabled),r=s.findIndex(e=>e.ref.current===t),a=s.length;if(-1===r)return;e.preventDefault();let n=r;const l=a-1,o=()=>{n=r+1,n>l&&(n=0)},m=()=>{n=r-1,n<0&&(n=l)};switch(e.key){case"Home":n=0;break;case"End":n=l;break;case"ArrowRight":"horizontal"===i&&(c?o():m());break;case"ArrowDown":"vertical"===i&&o();break;case"ArrowLeft":"horizontal"===i&&(c?m():o());break;case"ArrowUp":"vertical"===i&&m()}const x=n%a;s[x].ref.current?.focus()});return Qe.jsx(Hm,{scope:s,disabled:a,direction:n,orientation:i,children:Qe.jsx(Im.Slot,{scope:s,children:Qe.jsx(sr.div,{...l,"data-orientation":i,ref:o,onKeyDown:a?void 0:m})})})}),Xm="AccordionItem",[Km,Jm]=Mm(Xm),Gm=r.forwardRef((e,t)=>{const{__scopeAccordion:s,value:r,...a}=e,n=Vm(Xm,s),i=Bm(Xm,s),l=Am(s),o=zr(),d=r&&i.value.includes(r)||!1,c=n.disabled||e.disabled;return Qe.jsx(Km,{scope:s,open:d,disabled:c,triggerId:o,children:Qe.jsx(zm,{"data-orientation":n.orientation,"data-state":ax(d),...l,...a,ref:t,disabled:c,open:d,onOpenChange:e=>{e?i.onItemOpen(r):i.onItemClose(r)}})})});Gm.displayName=Xm;var Zm="AccordionHeader",Qm=r.forwardRef((e,t)=>{const{__scopeAccordion:s,...r}=e,a=Vm(Tm,s),n=Jm(Zm,s);return Qe.jsx(sr.h3,{"data-orientation":a.orientation,"data-state":ax(n.open),"data-disabled":n.disabled?"":void 0,...r,ref:t})});Qm.displayName=Zm;var ex="AccordionTrigger",tx=r.forwardRef((e,t)=>{const{__scopeAccordion:s,...r}=e,a=Vm(Tm,s),n=Jm(ex,s),i=$m(ex,s),l=Am(s);return Qe.jsx(Im.ItemSlot,{scope:s,children:Qe.jsx(Em,{"aria-disabled":n.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:n.triggerId,...l,...r,ref:t})})});tx.displayName=ex;var sx="AccordionContent",rx=r.forwardRef((e,t)=>{const{__scopeAccordion:s,...r}=e,a=Vm(Tm,s),n=Jm(sx,s),i=Am(s);return Qe.jsx(Rm,{role:"region","aria-labelledby":n.triggerId,"data-orientation":a.orientation,...i,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function ax(e){return e?"open":"closed"}rx.displayName=sx;var nx=Om,ix=Gm,lx=Qm,ox=tx,dx=rx;function cx({...e}){return Qe.jsx(nx,{"data-slot":"accordion",...e})}function mx({className:e,...t}){return Qe.jsx(ix,{"data-slot":"accordion-item",className:Hs("border-b last:border-b-0",e),...t})}function xx({className:e,children:t,...s}){return Qe.jsx(lx,{className:"flex",children:Qe.jsxs(ox,{"data-slot":"accordion-trigger",className:Hs("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",e),...s,children:[t,Qe.jsx(L,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function ux({className:e,children:t,...s}){return Qe.jsx(dx,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...s,children:Qe.jsx("div",{className:Hs("pt-0 pb-4",e),children:t})})}function hx(){const e=i(),[t,s]=r.useState({});r.useEffect(()=>{So().then(s).catch(e=>{})},[]);const a=[{question:"Как записаться на процедуру?",answer:`Вы можете записаться на процедуру через форму на нашем сайте${t.phone?`, позвонив по телефону ${t.phone}`:""}${t.instagram?`, или написав нам в Instagram ${t.instagram}`:""}. Мы свяжемся с вами для подтверждения записи.`},{question:"Какие способы оплаты вы принимаете?",answer:"Мы принимаем оплату наличными и картами (Visa, MasterCard, American Express). Оплата производится после оказания услуги."},{question:"Могу ли я отменить или перенести запись?",answer:"Да, вы можете отменить или перенести запись не позднее чем за 24 часа до назначенного времени. При отмене менее чем за 24 часа может взиматься штраф в размере 50% от стоимости услуги."},{question:"Какие материалы вы используете?",answer:"Мы используем только сертифицированные премиальные материалы от ведущих мировых брендов. Все пигменты гипоаллергенны и безопасны для здоровья."},{question:"Есть ли у ваших мастеров сертификаты?",answer:"Да, все наши мастера имеют международные сертификаты и регулярно проходят курсы повышения квалификации."},{question:"Нужна ли подготовка перед процедурой?",answer:"Да, для некоторых процедур требуется подготовка. Детальные рекомендации мы предоставляем при записи."},{question:"Есть ли противопоказания к процедурам?",answer:"Да, у каждой процедуры есть свои противопоказания. Основные: беременность, лактация, острые воспалительные процессы, заболевания крови, онкология. Перед процедурой обязательна консультация с мастером."},{question:"Предоставляете ли вы гарантию на услуги?",answer:"Да, мы гарантируем качество всех наших услуг. Если вы не удовлетворены результатом, свяжитесь с нами в течение 7 дней, и мы найдем решение."},{question:"Есть ли у вас программа лояльности?",answer:"Да, у нас есть накопительная программа лояльности. После каждого посещения вы получаете бонусы, которые можно использовать для оплаты следующих визитов."},...t.working_hours?[{question:"Работаете ли вы в выходные?",answer:`Да, мы работаем 7 дней в неделю. ${t.working_hours.weekdays?`В будние дни ${t.working_hours.weekdays}`:""}${t.working_hours.weekends?`, в выходные ${t.working_hours.weekends}`:""}.`}]:[],{question:"Можно ли подарить сертификат на услуги?",answer:"Да, мы предлагаем подарочные сертификаты на любую сумму или на конкретные услуги. Свяжитесь с нами для оформления сертификата."},...t.address?[{question:"Где находится ваш салон?",answer:`Мы находимся по адресу: ${t.address}. Подробную информацию о том, как добраться, вы можете найти на странице Контакты.`}]:[]];return Qe.jsxs("div",{children:[Qe.jsx("section",{className:"bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 py-20",children:Qe.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg",children:Qe.jsx(Te,{className:"w-10 h-10 text-pink-600"})}),Qe.jsx("h1",{className:"text-5xl text-gray-900 mb-4",children:"Часто задаваемые вопросы"}),Qe.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Ответы на популярные вопросы о наших услугах"})]})}),Qe.jsx("section",{className:"py-20",children:Qe.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:Qe.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:Qe.jsx(cx,{type:"single",collapsible:!0,className:"space-y-4",children:a.map((e,t)=>Qe.jsxs(mx,{value:`item-${t}`,className:"border border-gray-200 rounded-lg px-6",children:[Qe.jsx(xx,{className:"text-left hover:no-underline",children:Qe.jsx("span",{className:"text-lg text-gray-900",children:e.question})}),Qe.jsx(ux,{className:"text-gray-600 pt-2 pb-4",children:e.answer})]},t))})})})}),Qe.jsx("section",{className:"py-20 bg-gradient-to-br from-pink-50 to-purple-50",children:Qe.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[Qe.jsx("h2",{className:"text-3xl text-gray-900 mb-4",children:"Не нашли ответ на свой вопрос?"}),Qe.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Свяжитесь с нами, и мы с радостью ответим на все ваши вопросы"}),Qe.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[Qe.jsx(Ys,{size:"lg",className:"bg-gradient-to-r from-pink-500 to-purple-600",onClick:()=>e("/contacts"),children:"Связаться с нами"}),Qe.jsx(Ys,{size:"lg",variant:"outline",onClick:()=>e("/"),children:"Записаться на процедуру"})]})]})})]})}function px(){const e=i(),{id:t}=c(),r=parseInt(t||"0"),[a,n]=s.useState(!0),[l,o]=s.useState(!1),[d,m]=s.useState({username:"",full_name:"",email:""}),[x,u]=s.useState({new_password:"",confirm_password:""});s.useEffect(()=>{h()},[r]);const h=async()=>{try{n(!0);const e=await Ct.getUserProfile(r);m({username:e.username,full_name:e.full_name,email:e.email||""})}catch(jx){gt.error("Ошибка загрузки профиля")}finally{n(!1)}};return a?Qe.jsx("div",{className:"p-8 flex items-center justify-center h-screen",children:Qe.jsx(z,{className:"w-8 h-8 text-pink-600 animate-spin"})}):Qe.jsxs("div",{className:"p-8",children:[Qe.jsxs(Ys,{variant:"ghost",className:"mb-6",onClick:()=>e("/admin/users"),disabled:l,children:[Qe.jsx(H,{className:"w-4 h-4 mr-2"}),"Назад к пользователям"]}),Qe.jsxs("div",{className:"max-w-2xl mx-auto",children:[Qe.jsxs("div",{className:"mb-8",children:[Qe.jsxs("h1",{className:"text-3xl text-gray-900 mb-2 flex items-center gap-3",children:[Qe.jsx(De,{className:"w-8 h-8 text-pink-600"}),"Редактировать пользователя"]}),Qe.jsx("p",{className:"text-gray-600",children:d.full_name})]}),Qe.jsxs(Mc,{defaultValue:"profile",className:"space-y-6",children:[Qe.jsxs(Ac,{className:"grid w-full grid-cols-2",children:[Qe.jsxs(Oc,{value:"profile",children:[Qe.jsx(V,{className:"w-4 h-4 mr-2"}),"Профиль"]}),Qe.jsxs(Oc,{value:"password",children:[Qe.jsx(ke,{className:"w-4 h-4 mr-2"}),"Пароль"]})]}),Qe.jsx(Wc,{value:"profile",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6 font-semibold",children:"Основная информация"}),Qe.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!d.username||d.username.length<3)gt.error("Логин должен быть минимум 3 символа");else if(!d.full_name||d.full_name.length<2)gt.error("Имя должно быть минимум 2 символа");else try{o(!0),await Ct.updateUserProfile(r,d),gt.success("✅ Профиль обновлён")}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка обновления";gt.error(`❌ ${t}`)}finally{o(!1)}},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"username",children:"Логин *"}),Qe.jsx(oo,{id:"username",required:!0,disabled:l,value:d.username,onChange:e=>m({...d,username:e.target.value}),placeholder:"username",minLength:3}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Минимум 3 символа"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"full_name",children:"Полное имя *"}),Qe.jsx(oo,{id:"full_name",required:!0,disabled:l,value:d.full_name,onChange:e=>m({...d,full_name:e.target.value}),placeholder:"Анна Петрова",minLength:2})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"email",children:"Email"}),Qe.jsx(oo,{id:"email",type:"email",disabled:l,value:d.email,onChange:e=>m({...d,email:e.target.value}),placeholder:"anna@example.com"}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Для восстановления пароля"})]}),Qe.jsx(Ys,{type:"submit",disabled:l,className:"w-full bg-pink-600 hover:bg-pink-700",children:l?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Сохранение..."]}):"Сохранить изменения"})]})]})}),Qe.jsx(Wc,{value:"password",children:Qe.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[Qe.jsx("h2",{className:"text-xl text-gray-900 mb-6 font-semibold",children:"Изменить пароль"}),Qe.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:Qe.jsxs("p",{className:"text-sm text-yellow-800",children:[Qe.jsx("strong",{children:"⚠️ Важно:"})," Администратор может изменить пароль без знания текущего. После изменения пользователь должен войти с новым паролем."]})}),Qe.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!x.new_password||x.new_password.length<6)gt.error("Пароль должен быть минимум 6 символов");else if(x.new_password===x.confirm_password)try{o(!0),await Ct.changePassword(r,{new_password:x.new_password}),gt.success("✅ Пароль изменён"),u({new_password:"",confirm_password:""})}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка изменения пароля";gt.error(`❌ ${t}`)}finally{o(!1)}else gt.error("Пароли не совпадают")},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"new_password",children:"Новый пароль *"}),Qe.jsx(oo,{id:"new_password",type:"password",required:!0,disabled:l,value:x.new_password,onChange:e=>u({...x,new_password:e.target.value}),placeholder:"••••••",minLength:6}),Qe.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Минимум 6 символов"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"confirm_password",children:"Подтвердите пароль *"}),Qe.jsx(oo,{id:"confirm_password",type:"password",required:!0,disabled:l,value:x.confirm_password,onChange:e=>u({...x,confirm_password:e.target.value}),placeholder:"••••••",minLength:6})]}),Qe.jsx(Ys,{type:"submit",disabled:l,className:"w-full bg-pink-600 hover:bg-pink-700",children:l?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Изменение..."]}):Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(ke,{className:"w-4 h-4 mr-2"}),"Изменить пароль"]})})]})]})})]})]})]})}function gx(){const e=i(),[t,r]=s.useState({username:"",password:""}),[a,n]=s.useState(!1);return Qe.jsx("div",{className:"py-20 bg-gray-50 min-h-screen",children:Qe.jsxs("div",{className:"max-w-md mx-auto px-4 sm:px-6 lg:px-8",children:[Qe.jsxs("div",{className:"text-center mb-8",children:[Qe.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(V,{className:"w-10 h-10 text-white"})}),Qe.jsx("h1",{className:"text-4xl text-gray-900 mb-2",children:"Личный кабинет"}),Qe.jsx("p",{className:"text-gray-600",children:"Войдите в систему управления салоном"})]}),Qe.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:[Qe.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),t.username&&t.password){n(!0);try{const e=new FormData;e.append("username",t.username),e.append("password",t.password);const s=await fetch("/api/login",{method:"POST",credentials:"include",body:e});if(s.ok){const e=await s.json();localStorage.setItem("session_token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),gt.success("Вы успешно вошли в систему! 🎉"),setTimeout(()=>{"admin"===e.user.role?window.location.href="/admin":"manager"===e.user.role?window.location.href="/manager":"employee"===e.user.role&&(window.location.href="/employee")},500)}else gt.error("Неверные учетные данные")}catch(jx){gt.error("Ошибка при входе")}finally{n(!1)}}else gt.error("Пожалуйста, заполните все поля")},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"username",children:"Имя пользователя или email"}),Qe.jsx(oo,{id:"username",type:"text",required:!0,disabled:a,value:t.username,onChange:e=>r({...t,username:e.target.value}),placeholder:"admin"}),Qe.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Введите ваше имя пользователя"})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"password",children:"Пароль"}),Qe.jsx(oo,{id:"password",type:"password",required:!0,disabled:a,value:t.password,onChange:e=>r({...t,password:e.target.value}),placeholder:"••••••"}),Qe.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Вводится при регистрации"})]}),Qe.jsxs(Ys,{type:"submit",disabled:a,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600",size:"lg",children:[Qe.jsx(Ie,{className:"w-4 h-4 mr-2"}),a?"Вход...":"Войти в систему"]})]}),Qe.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg flex gap-3",children:[Qe.jsx(E,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),Qe.jsxs("div",{className:"text-sm text-blue-800",children:[Qe.jsx("p",{className:"font-semibold mb-1",children:"Учетные данные для входа:"}),Qe.jsxs("p",{children:["Username: ",Qe.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"admin"})]}),Qe.jsxs("p",{children:["Password: ",Qe.jsx("code",{className:"bg-white px-2 py-1 rounded",children:"admin123"})]})]})]}),Qe.jsx("div",{className:"mt-6 text-center",children:Qe.jsx(Ys,{onClick:()=>e("/"),variant:"outline",className:"w-full",children:"← Вернуться на главную"})})]}),Qe.jsxs("div",{className:"mt-8 grid grid-cols-3 gap-4 text-center",children:[Qe.jsxs("div",{children:[Qe.jsx("div",{className:"text-2xl text-pink-600 mb-1",children:"👨‍💼"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Администратор"})]}),Qe.jsxs("div",{children:[Qe.jsx("div",{className:"text-2xl text-purple-600 mb-1",children:"📊"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Менеджер"})]}),Qe.jsxs("div",{children:[Qe.jsx("div",{className:"text-2xl text-blue-600 mb-1",children:"💅"}),Qe.jsx("p",{className:"text-xs text-gray-600",children:"Сотрудник"})]})]})]})})}function fx({onLogin:e}){const t=i(),[r,a]=s.useState({username:"",password:""}),[n,l]=s.useState(!1),[o,d]=s.useState("");return Qe.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-100 via-purple-100 to-pink-50 flex items-center justify-center p-4",children:Qe.jsxs("div",{className:"max-w-md w-full",children:[Qe.jsxs("div",{className:"text-center mb-8",children:[Qe.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-pink-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:Qe.jsx(Ie,{className:"w-10 h-10 text-white"})}),Qe.jsx("h1",{className:"text-4xl text-gray-900 mb-2",children:"💎 M.Le Diamant"}),Qe.jsx("p",{className:"text-gray-600",children:"CRM система управления"})]}),Qe.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[o&&Qe.jsx("div",{className:"mb-6 p-3 bg-red-50 border border-red-200 rounded-lg",children:Qe.jsx("p",{className:"text-red-800 text-sm",children:o})}),Qe.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),r.username&&r.password)try{l(!0),d("");const s=await Ct.login(r.username,r.password);s.success&&s.token?(localStorage.setItem("session_token",s.token),localStorage.setItem("user",JSON.stringify(s.user)),e({...s.user,token:s.token}),gt.success(`Добро пожаловать, ${s.user.full_name||s.user.username}!`),t("/admin/dashboard")):(d("Ошибка авторизации"),gt.error("Ошибка авторизации"))}catch(jx){const t=jx instanceof Error?jx.message:"Ошибка входа";t.includes("Unauthorized")||t.includes("401")?d("Неверное имя пользователя или пароль"):d(t),gt.error(t)}finally{l(!1)}else d("Заполните оба поля")},className:"space-y-6",children:[Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"username",children:"Имя пользователя"}),Qe.jsxs("div",{className:"relative",children:[Qe.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{id:"username",required:!0,disabled:n,value:r.username,onChange:e=>a({...r,username:e.target.value}),placeholder:"Введите логин",className:"pl-10"})]})]}),Qe.jsxs("div",{children:[Qe.jsx(Cd,{htmlFor:"password",children:"Пароль"}),Qe.jsxs("div",{className:"relative",children:[Qe.jsx(Ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),Qe.jsx(oo,{id:"password",type:"password",required:!0,disabled:n,value:r.password,onChange:e=>a({...r,password:e.target.value}),placeholder:"Введите пароль",className:"pl-10"})]})]}),Qe.jsx(Ys,{type:"submit",disabled:n||!r.username||!r.password,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 flex items-center justify-center gap-2",size:"lg",children:n?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(z,{className:"w-4 h-4 animate-spin"}),"Вход..."]}):"Войти"})]}),Qe.jsx("div",{className:"mt-6 text-center",children:Qe.jsx(Ys,{variant:"link",className:"text-pink-600",onClick:()=>t("/forgot-password"),children:"Забыли пароль?"})})]}),Qe.jsx("div",{className:"mt-6 text-center",children:Qe.jsx(Ys,{variant:"outline",onClick:()=>t("/"),children:"Вернуться на главную"})})]})})}const bx=({element:e,isAuthenticated:t,requiredRole:s,currentRole:r})=>t?s&&r!==s?"admin"===r?Qe.jsx(p,{to:"/admin/dashboard",replace:!0}):"manager"===r?Qe.jsx(p,{to:"/manager/dashboard",replace:!0}):"employee"===r?Qe.jsx(p,{to:"/employee/dashboard",replace:!0}):Qe.jsx(p,{to:"/",replace:!0}):Qe.jsx(Qe.Fragment,{children:e}):Qe.jsx(p,{to:"/login",replace:!0});function yx(){const[e,t]=s.useState(null),[r,a]=s.useState(!0);s.useEffect(()=>{(()=>{try{const e=localStorage.getItem("session_token"),s=localStorage.getItem("user");if(e&&s){const e=JSON.parse(s);t({id:e.id,username:e.username,full_name:e.full_name,role:e.role})}}catch(jx){localStorage.removeItem("session_token"),localStorage.removeItem("user")}finally{a(!1)}})()},[]);const n=()=>{localStorage.removeItem("session_token"),localStorage.removeItem("user"),t(null)};return r?Qe.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:Qe.jsxs("div",{className:"text-center",children:[Qe.jsx("div",{className:"inline-block animate-spin",children:Qe.jsx("div",{className:"w-8 h-8 border-4 border-pink-600 border-t-transparent rounded-full"})}),Qe.jsx("p",{className:"mt-4 text-gray-600",children:"Загрузка..."})]})}):Qe.jsx(x,{children:Qe.jsxs("div",{className:"min-h-screen bg-gray-50",children:[Qe.jsxs(u,{children:[Qe.jsx(h,{path:"/login",element:e?"admin"===e.role?Qe.jsx(p,{to:"/admin/dashboard",replace:!0}):"manager"===e.role?Qe.jsx(p,{to:"/manager/dashboard",replace:!0}):"employee"===e.role?Qe.jsx(p,{to:"/employee/dashboard",replace:!0}):Qe.jsx(p,{to:"/",replace:!0}):Qe.jsx(fx,{onLogin:e=>{const s={id:e.id,username:e.username,full_name:e.full_name,role:e.role};t(s)}})}),Qe.jsxs(h,{path:"/admin/*",element:Qe.jsx(bx,{isAuthenticated:!!e,requiredRole:"admin",currentRole:e?.role,element:Qe.jsx(_t,{user:e,onLogout:n})}),children:[Qe.jsx(h,{path:"dashboard",element:Qe.jsx(Xs,{})}),Qe.jsx(h,{path:"bookings",element:Qe.jsx(jo,{})}),Qe.jsx(h,{path:"bookings/:id",element:Qe.jsx(zo,{})}),Qe.jsx(h,{path:"analytics",element:Qe.jsx(Ro,{})}),Qe.jsx(h,{path:"funnel",element:Qe.jsx(Qc,{})}),Qe.jsx(h,{path:"services",element:Qe.jsx(Rd,{})}),Qe.jsx(h,{path:"clients",element:Qe.jsx(Td,{})}),Qe.jsx(h,{path:"clients/:id",element:Qe.jsx(Dd,{})}),Qe.jsx(h,{path:"chat",element:Qe.jsx(Kc,{})}),Qe.jsx(h,{path:"users",element:Qe.jsx(Pd,{})}),Qe.jsx(h,{path:"users/create",element:Qe.jsx(Id,{})}),Qe.jsx(h,{path:"calendar",element:Qe.jsx(Fd,{})}),Qe.jsx(h,{path:"settings",element:Qe.jsx(Bc,{})}),Qe.jsx(h,{path:"bot-settings",element:Qe.jsx($c,{})}),Qe.jsx(h,{path:"",element:Qe.jsx(p,{to:"dashboard",replace:!0})}),Qe.jsx(h,{path:"users/:id/edit",element:Qe.jsx(px,{})})]}),Qe.jsxs(h,{path:"/manager/*",element:Qe.jsx(bx,{isAuthenticated:!!e,requiredRole:"manager",currentRole:e?.role,element:Qe.jsx(Uc,{user:e,onLogout:n})}),children:[Qe.jsx(h,{path:"dashboard",element:Qe.jsx(qc,{})}),Qe.jsx(h,{path:"chat",element:Qe.jsx(Kc,{})}),Qe.jsx(h,{path:"analytics",element:Qe.jsx(Ro,{})}),Qe.jsx(h,{path:"funnel",element:Qe.jsx(Qc,{})}),Qe.jsx(h,{path:"clients",element:Qe.jsx(Td,{})}),Qe.jsx(h,{path:"settings",element:Qe.jsx(em,{})}),Qe.jsx(h,{path:"bot-settings",element:Qe.jsx($c,{})}),Qe.jsx(h,{path:"",element:Qe.jsx(p,{to:"dashboard",replace:!0})})]}),Qe.jsxs(h,{path:"/employee/*",element:Qe.jsx(bx,{isAuthenticated:!!e,requiredRole:"employee",currentRole:e?.role,element:Qe.jsx(tm,{user:e,onLogout:n})}),children:[Qe.jsx(h,{path:"dashboard",element:Qe.jsx(rm,{})}),Qe.jsx(h,{path:"profile",element:Qe.jsx(am,{})}),Qe.jsx(h,{path:"calendar",element:Qe.jsx(Fd,{})}),Qe.jsx(h,{path:"",element:Qe.jsx(p,{to:"dashboard",replace:!0})})]}),Qe.jsxs(h,{path:"/",element:Qe.jsx(nm,{}),children:[Qe.jsx(h,{index:!0,element:Qe.jsx(om,{})}),Qe.jsx(h,{path:"price-list",element:Qe.jsx(dm,{})}),Qe.jsx(h,{path:"success",element:Qe.jsx(cm,{})}),Qe.jsx(h,{path:"terms",element:Qe.jsx(mm,{})}),Qe.jsx(h,{path:"privacy-policy",element:Qe.jsx(xm,{})}),Qe.jsx(h,{path:"about",element:Qe.jsx(um,{})}),Qe.jsx(h,{path:"contacts",element:Qe.jsx(hm,{})}),Qe.jsx(h,{path:"cooperation",element:Qe.jsx(pm,{})}),Qe.jsx(h,{path:"faq",element:Qe.jsx(hx,{})}),Qe.jsx(h,{path:"cabinet",element:e?"admin"===e.role?Qe.jsx(p,{to:"/admin/dashboard",replace:!0}):"manager"===e.role?Qe.jsx(p,{to:"/manager/dashboard",replace:!0}):"employee"===e.role?Qe.jsx(p,{to:"/employee/dashboard",replace:!0}):Qe.jsx(p,{to:"/",replace:!0}):Qe.jsx(gx,{})})]}),Qe.jsx(h,{path:"*",element:Qe.jsx(p,{to:"/",replace:!0})})]}),Qe.jsx(St,{})]})})}tt.createRoot(document.getElementById("root")).render(Qe.jsx(yx,{}));
