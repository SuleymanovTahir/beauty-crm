"""
–ú–∏–≥—Ä–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–ª–µ–π –≤ bot_settings
"""
import sqlite3
from core.config import DATABASE_NAME

def add_missing_bot_fields():
    """–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–æ–ª—è –≤ bot_settings"""
    conn = sqlite3.connect(DATABASE_NAME)
    c = conn.cursor()

    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏
        c.execute("PRAGMA table_info(bot_settings)")
        existing_columns = [row[1] for row in c.fetchall()]
        print(f"üìã –°—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–ª–æ–Ω–æ–∫: {len(existing_columns)}")

        # –ü–æ–ª—è –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
        fields_to_add = {
            'manager_consultation_prompt': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': """–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º —Å–∞–ª–æ–Ω–∞ –∫—Ä–∞—Å–æ—Ç—ã M.Le Diamant –≤ Dubai.
–ú–µ–Ω–µ–¥–∂–µ—Ä –æ–±—Ä–∞—Ç–∏–ª—Å—è –∫ —Ç–µ–±–µ –∑–∞ —Å–æ–≤–µ—Ç–æ–º. –¢—ã –ø–æ–º–æ–≥–∞–µ—à—å –ú–ï–ù–ï–î–ñ–ï–†–£, –∞ –Ω–µ –æ–±—â–∞–µ—à—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –Ω–∞–ø—Ä—è–º—É—é.

‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
1. –û–±—Ä–∞—â–∞–π—Å—è –∫ –º–µ–Ω–µ–¥–∂–µ—Ä—É –Ω–∞ "—Ç—ã"
2. –ù–ï –ø–∏—à–∏ —Ç–µ–∫—Å—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
3. –î–∞–π –°–û–í–ï–¢ –º–µ–Ω–µ–¥–∂–µ—Ä—É —á—Ç–æ –¥–µ–ª–∞—Ç—å

–°–¢–†–£–ö–¢–£–†–ê –û–¢–í–ï–¢–ê (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê):
1Ô∏è‚É£ **–ö—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏** (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
2Ô∏è‚É£ **–¢–≤–æ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** (—á—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É)
3Ô∏è‚É£ **–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç** (–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è/—Å—Ç—Ä–∞—Ç–µ–≥–∏—è)

–ü–†–ò–ú–ï–†: "–í–∏–∂—É —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –º–æ–ª—á–∏—Ç –ø–æ—Å–ª–µ —Ç–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞. –Ø –±—ã –Ω–∞–ø–∏—Å–∞–ª: '[–≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç]'. –≠—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ..."

‚ùå –ù–ï –ù–ê–ß–ò–ù–ê–ô –° –§–†–ê–ó –æ–±—Ä–∞—â–µ–Ω–Ω—ã—Ö –∫ –∫–ª–∏–µ–Ω—Ç—É
‚úÖ –ù–ê–ß–ò–ù–ê–ô –°: "–Ø –≤–∏–∂—É —á—Ç–æ...", "–Ø –±—ã –Ω–∞ —Ç–≤–æ–µ–º –º–µ—Å—Ç–µ...", "–†–µ–∫–æ–º–µ–Ω–¥—É—é..."
"""
            },
            'booking_time_logic': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': """**–£–ú–ù–ê–Ø –õ–û–ì–ò–ö–ê –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø –í–†–ï–ú–ï–ù–ò –ó–ê–ü–ò–°–ò**

üéØ **–¶–ï–õ–¨**: –í—ã–∑–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å ‚Üí –ü–æ–¥—Ç–æ–ª–∫–Ω—É—Ç—å –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∞—Ç–µ ‚Üí –ü–æ–ª—É—á–∏—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ

üìã **–ê–õ–ì–û–†–ò–¢–ú**:

1Ô∏è‚É£ **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –í–ü–ï–†–í–´–ï —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ –∑–∞–ø–∏—Å–∏:**
   - –ù–ï –ü–†–ï–î–õ–ê–ì–ê–ô –≤—Ä–µ–º—è —Å—Ä–∞–∑—É
   - –°–Ω–∞—á–∞–ª–∞ —É–∑–Ω–∞–π –ü–†–ï–î–ü–û–ß–¢–ï–ù–ò–Ø: "–ù–∞ –∫–∞–∫–æ–π –¥–µ–Ω—å –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ? –£—Ç—Ä–æ/–¥–µ–Ω—å/–≤–µ—á–µ—Ä —É–¥–æ–±–Ω–µ–µ?"
   - –ó–∞–ø–æ–º–Ω–∏ –µ–≥–æ –æ—Ç–≤–µ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞

2Ô∏è‚É£ **–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π (–∏–ª–∏ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è):**
   - –ü—Ä–µ–¥–ª–æ–∂–∏ 2-3 –ö–û–ù–ö–†–ï–¢–ù–´–• –≤–∞—Ä–∏–∞–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
     "–ï—Å—Ç—å –æ–∫–Ω–æ [–î–ï–ù–¨] –≤ [–í–†–ï–ú–Ø] –∏–ª–∏ [–î–ï–ù–¨2] –≤ [–í–†–ï–ú–Ø2]"
   - –ü—Ä–∏–º–µ—Ä: "–ï—Å—Ç—å –∑–∞–≤—Ç—Ä–∞ –≤ 14:00, –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞ –≤ 17:00 –∏–ª–∏ –≤ —Å—É–±–±–æ—Ç—É —É—Ç—Ä–æ–º"
   - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤–∫–ª—é—á–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ë–õ–ò–ñ–ê–ô–®–ò–ô —Å–ª–æ—Ç (—á—É–≤—Å—Ç–≤–æ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏)

3Ô∏è‚É£ **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç —á—Ç–æ –∑–∞–Ω—è—Ç / –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç:**
   - –°–ø—Ä–æ—Å–∏: "–ö–∞–∫–∏–µ –¥–Ω–∏ –≤–∞–º —É–¥–æ–±–Ω–µ–µ?"
   - –ò–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –î–†–£–ì–ò–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã: "–¢–æ–≥–¥–∞ —Å–º–æ—Ç—Ä—é –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é..."

4Ô∏è‚É£ **–ï—Å–ª–∏ –≤—Å–µ –ü–û–õ–ù–û–°–¢–¨–Æ –∑–∞–Ω—è—Ç–æ –Ω–∞ –Ω–µ–¥–µ–ª—é:**
   - "–ë–ª–∏–∂–∞–π—à–µ–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –æ–∫–Ω–æ [–î–ê–¢–ê] –≤ [–í–†–ï–ú–Ø]. –ò–ª–∏ –º–æ–∂–µ–º –≤ –ª–∏—Å—Ç –æ–∂–∏–¥–∞–Ω–∏—è ‚Äî –µ—Å–ª–∏ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è —Ä–∞–Ω—å—à–µ, —Å—Ä–∞–∑—É –Ω–∞–ø–∏—à—É!"

5Ô∏è‚É£ **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≤—ã–±—Ä–∞–ª –≤—Ä–µ–º—è:**
   - –°–†–ê–ó–£ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ —Å–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö (–∏–º—è + WhatsApp)
   - "–û—Ç–ª–∏—á–Ω–æ! –î–ª—è –∑–∞–ø–∏—Å–∏ –Ω—É–∂–Ω–æ –∏–º—è –∏ WhatsApp ‚Äî —ç—Ç–æ –∑–∞–π–º–µ—Ç —Å–µ–∫—É–Ω–¥—É üòä"

‚ö†Ô∏è **–ó–ê–ü–†–ï–©–ï–ù–û**:
- –ì–æ–≤–æ—Ä–∏—Ç—å "–ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ" ‚Äî —Ç—ã –°–ê–ú–ê –ø—Ä–µ–¥–ª–∞–≥–∞–µ—à—å –≤—Ä–µ–º—è
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –±–æ–ª—å—à–µ 3 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å—Ä–∞–∑—É (–ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç –≤—ã–±–æ—Ä)
- –°–ø—Ä–∞—à–∏–≤–∞—Ç—å "–∫–æ–≥–¥–∞ –≤–∞–º —É–¥–æ–±–Ω–æ" –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å–ª–∏—à–∫–æ–º –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ)

‚úÖ **–†–ê–ó–†–ï–®–ï–ù–û**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—Ä–∞–∑—ã –¥–µ—Ñ–∏—Ü–∏—Ç–∞: "–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–∫–Ω–æ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ", "–û—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ –≤—Ä–µ–º—è"
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–£ –µ—Å–ª–∏ –∑–∞–Ω—è—Ç–æ: "14:00 –∑–∞–Ω—è—Ç–æ, –Ω–æ –µ—Å—Ç—å 15:30"
- –ù–∞–ø–æ–º–∏–Ω–∞—Ç—å –æ –≤—ã–≥–æ–¥–µ: "–ó–∞–ø–∏—Å—å –∑–∞—Ä–∞–Ω–µ–µ = –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ª–æ—Ç"
"""
            },
            'booking_data_collection': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': """**–ê–õ–ì–û–†–ò–¢–ú –°–ë–û–†–ê –î–ê–ù–ù–´–• –î–õ–Ø –ó–ê–ü–ò–°–ò**

üéØ **–¶–ï–õ–¨**: –ü–æ–ª—É—á–∏—Ç—å –ò–ú–Ø –∏ WHATSAPP –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

üìã **–ö–û–ì–î–ê –°–û–ë–ò–†–ê–¢–¨**:
- –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç —Å–æ–≥–ª–∞—Å–∏–ª—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—Ä–µ–º—è
- –ù–ï —Å–æ–±–∏—Ä–∞–π –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –µ—â–µ –¥—É–º–∞–µ—Ç

üìù **–ö–ê–ö –°–û–ë–ò–†–ê–¢–¨**:

1Ô∏è‚É£ **–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (–ò–ú–Ø + WHATSAPP —Å—Ä–∞–∑—É):**
   "–û—Ç–ª–∏—á–Ω–æ! –î–ª—è –∑–∞–ø–∏—Å–∏ –Ω—É–∂–Ω–æ:
   - –í–∞—à–µ –∏–º—è
   - –ù–æ–º–µ—Ä WhatsApp (–¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)

   –ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ üòä"

2Ô∏è‚É£ **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –¥–∞–ª –¢–û–õ–¨–ö–û –ò–ú–Ø:**
   "–°–ø–∞—Å–∏–±–æ, [–ò–ú–Ø]! –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ WhatsApp ‚Äî —á—Ç–æ–±—ã –ø—Ä–∏—Å–ª–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ"

3Ô∏è‚É£ **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –¥–∞–ª –¢–û–õ–¨–ö–û WHATSAPP:**
   "–û—Ç–ª–∏—á–Ω–æ! –ê –∫–∞–∫ –≤–∞—Å –∑–∞–ø–∏—Å–∞—Ç—å (–≤–∞—à–µ –∏–º—è)?"

4Ô∏è‚É£ **–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è–µ—Ç—Å—è:**
   - "–≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–∏—Å–∏ ‚Äî –∏–Ω–∞—á–µ –º–∞—Å—Ç–µ—Ä –Ω–µ –±—É–¥–µ—Ç –∑–Ω–∞—Ç—å –∫—Ç–æ –ø—Ä–∏–¥–µ—Ç"
   - "WhatsApp –Ω—É–∂–µ–Ω –¥–ª—è –∞–≤—Ç–æ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–∑–∞ –¥–µ–Ω—å –ø—Ä–∏—à–ª–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ)"

5Ô∏è‚É£ **–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –û–ë–û–ò–• –¥–∞–Ω–Ω—ã—Ö:**
   "–°—É–ø–µ—Ä! –ó–∞–ø–∏—Å–∞–ª–∞ –≤–∞—Å:
   üìÖ [–î–ê–¢–ê –ò –í–†–ï–ú–Ø]
   üíÖ [–£–°–õ–£–ì–ê]
   üë§ [–ò–ú–Ø]
   üì± [WHATSAPP]

   –ü—Ä–∏—à–ª—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ WhatsApp. –ñ–¥—É –≤–∞—Å! üòä"

‚ö†Ô∏è **–ó–ê–ü–†–ï–©–ï–ù–û**:
- –°–ø—Ä–∞—à–∏–≤–∞—Ç—å email, –∞–¥—Ä–µ—Å –∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ (–¢–û–õ–¨–ö–û –∏–º—è –∏ WhatsApp)
- –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –±–µ–∑ –Ω–∏—Ö
- –ì–æ–≤–æ—Ä–∏—Ç—å "–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ" ‚Äî –¥–∞–Ω–Ω—ã–µ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´

‚úÖ **–†–ê–ó–†–ï–®–ï–ù–û**:
- –û–±—ä—è—Å–Ω—è—Ç—å –ó–ê–ß–ï–ú –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ (–ø–æ–≤—ã—à–∞–µ—Ç –¥–æ–≤–µ—Ä–∏–µ)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏ –¥–ª—è –º—è–≥–∫–æ—Å—Ç–∏ —Ç–æ–Ω–∞
- –ë–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –∑–∞ –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø
"""
            },
            'booking_availability_instructions': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': """**–ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ü–û–ö–ê–ó–£ –î–û–°–¢–£–ü–ù–´–• –ú–ê–°–¢–ï–†–û–í**

üéØ **–û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê**: –ü–æ–∫–∞–∑—ã–≤–∞–π –º–∞—Å—Ç–µ—Ä–æ–≤ –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞ —É—Å–ª—É–≥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞

üìã **–ê–õ–ì–û–†–ò–¢–ú –î–ï–ô–°–¢–í–ò–ô**:

1Ô∏è‚É£ **–ï–°–õ–ò –£–°–õ–£–ì–ê –ù–ï –û–ü–†–ï–î–ï–õ–ï–ù–ê (–∫–ª–∏–µ–Ω—Ç —Å–ø—Ä–æ—Å–∏–ª "–∫–∞–∫–∏–µ —É—Å–ª—É–≥–∏?", "—Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç?"):**
   - –ù–ï –ü–û–ö–ê–ó–´–í–ê–ô –º–∞—Å—Ç–µ—Ä–æ–≤
   - –°–Ω–∞—á–∞–ª–∞ –ø–æ–º–æ–≥–∏ –≤—ã–±—Ä–∞—Ç—å –£–°–õ–£–ì–£
   - –ü—Ä–∏–º–µ—Ä: "–£ –Ω–∞—Å –µ—Å—Ç—å [–°–ü–ò–°–û–ö –£–°–õ–£–ì]. –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?"

2Ô∏è‚É£ **–ï–°–õ–ò –£–°–õ–£–ì–ê –û–ü–†–ï–î–ï–õ–ï–ù–ê (–∫–ª–∏–µ–Ω—Ç –≤—ã–±—Ä–∞–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É):**

   üîç **–ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É:**
   ```
   check_masters_availability(service_id=123, date="2025-01-15")
   ```

   üìä **–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã:**
   ```json
   {
     "available_masters": [
       {"id": 1, "name": "–ú–∞—Ä–∏—è", "slots": ["10:00", "14:00", "16:30"]},
       {"id": 2, "name": "–ê–Ω–Ω–∞", "slots": ["11:00", "15:00"]}
     ],
     "date": "2025-01-15"
   }
   ```

   üí¨ **–ö–∞–∫ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É:**

   ‚úÖ **–ï—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Å—Ç–µ—Ä–æ–≤:**
   "–ù–∞ [–î–ê–¢–ê] —ç—Ç—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –¥–µ–ª–∞—é—Ç:

   üë±‚Äç‚ôÄÔ∏è –ú–∞—Ä–∏—è ‚Äî —Å–≤–æ–±–æ–¥–Ω–∞ –≤ 10:00, 14:00, 16:30
   üë©‚Äçü¶∞ –ê–Ω–Ω–∞ ‚Äî —Å–≤–æ–±–æ–¥–Ω–∞ –≤ 11:00, 15:00

   –ö –∫–æ–º—É –∑–∞–ø–∏—à–µ–º?"

   ‚úÖ **–ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –º–∞—Å—Ç–µ—Ä:**
   "–ù–∞ [–î–ê–¢–ê] –ø—Ä–æ—Ü–µ–¥—É—Ä—É –¥–µ–ª–∞–µ—Ç –º–∞—Å—Ç–µ—Ä –ú–∞—Ä–∏—è.
   –°–≤–æ–±–æ–¥–Ω—ã–µ –æ–∫–Ω–∞: 10:00, 14:00, 16:30
   –ö–∞–∫–æ–µ –≤—Ä–µ–º—è —É–¥–æ–±–Ω–æ?"

   ‚úÖ **–ï—Å–ª–∏ –≤—Å–µ –∑–∞–Ω—è—Ç–æ:**
   "–ù–∞ [–î–ê–¢–ê] –≤—Å–µ –∑–∞–Ω—è—Ç–æ üòî
   –ë–ª–∏–∂–∞–π—à–µ–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ ‚Äî [–°–õ–ï–î–£–Æ–©–ê–Ø –î–ê–¢–ê] –≤ [–í–†–ï–ú–Ø].
   –ü–æ–¥—Ö–æ–¥–∏—Ç?"

3Ô∏è‚É£ **–ï–°–õ–ò –ö–õ–ò–ï–ù–¢ –í–´–ë–†–ê–õ –í–†–ï–ú–Ø –ë–ï–ó –ú–ê–°–¢–ï–†–ê:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—Ä–æ–Ω–∏—Ä—É–π —É –ª—é–±–æ–≥–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
   - –°–æ–æ–±—â–∏: "–ó–∞–ø–∏—Å–∞–ª–∞ –∫ –º–∞—Å—Ç–µ—Ä—É –ú–∞—Ä–∏—è –Ω–∞ 14:00!"

4Ô∏è‚É£ **–ï–°–õ–ò –ö–õ–ò–ï–ù–¢ –°–ü–†–û–°–ò–õ –ü–†–û –ö–û–ù–ö–†–ï–¢–ù–û–ì–û –ú–ê–°–¢–ï–†–ê:**
   ```
   check_masters_availability(service_id=123, master_id=1, date="2025-01-15")
   ```
   - –ü–æ–∫–∞–∂–∏ –¢–û–õ–¨–ö–û —Å–ª–æ—Ç—ã —ç—Ç–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞

‚ö†Ô∏è **–ó–ê–ü–†–ï–©–ï–ù–û**:
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä–æ–≤ –î–û –≤—ã–±–æ—Ä–∞ —É—Å–ª—É–≥–∏
- –ì–æ–≤–æ—Ä–∏—Ç—å "–≤—Å–µ –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–Ω—è—Ç—ã" –±–µ–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (–í–°–ï–ì–î–ê –≤—ã–∑—ã–≤–∞–π check_masters_availability)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–∞—Å—Ç–µ—Ä–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –¥–µ–ª–∞—é—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é —É—Å–ª—É–≥—É

‚úÖ **–†–ê–ó–†–ï–®–ï–ù–û**:
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –±–ª–∏–∂–∞–π—à—É—é —Å–≤–æ–±–æ–¥–Ω—É—é –¥–∞—Ç—É –µ—Å–ª–∏ –≤—Å—ë –∑–∞–Ω—è—Ç–æ
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª—Å—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ–¥–∑–∏ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (üë±‚Äç‚ôÄÔ∏èüë©‚Äçü¶∞üíÖ)

üîÑ **–ü–û–°–õ–ï –í–´–ë–û–†–ê –í–†–ï–ú–ï–ù–ò**:
–°—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ —Å–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö (–∏–º—è + WhatsApp) —Å–æ–≥–ª–∞—Å–Ω–æ "booking_data_collection"
"""
            },
            'ad_campaign_detection': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': '–ï—Å–ª–∏ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç "–æ—Ç–∫—É–¥–∞ –Ω–æ–º–µ—Ä?" –∏–ª–∏ "–∫–∞–∫ –Ω–∞—à–ª–∏ –º–µ–Ω—è?" ‚Üí –æ—Ç–≤–µ—á–∞–π: "–¢–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞ –≤ Instagram üéØ –í—ã –ø–æ–ø–∞–ª–∏ –≤ –Ω–∞—à—É —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é!"'
            },
            'pre_booking_data_collection': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': '–î–ª—è –∑–∞–ø–∏—Å–∏ –Ω—É–∂–Ω–æ –∏–º—è –∏ WhatsApp ‚Äî —ç—Ç–æ –∑–∞–π–º–µ—Ç —Å–µ–∫—É–Ω–¥—É! üòä'
            },
            'context_memory': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': ''
            },
            'avoid_repetition': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': ''
            },
            'conversation_flow_rules': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': ''
            },
            'personality_adaptations': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': ''
            },
            'smart_objection_detection': {
                'type': 'TEXT DEFAULT \'\'',
                'default_value': ''
            }
        }

        added_count = 0
        for field_name, field_info in fields_to_add.items():
            if field_name not in existing_columns:
                print(f"‚ûï –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ {field_name}...")

                # –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É
                c.execute(f"""
                    ALTER TABLE bot_settings
                    ADD COLUMN {field_name} {field_info['type']}
                """)

                # –ï—Å–ª–∏ –µ—Å—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∑–∞–ø–æ–ª–Ω—è–µ–º
                if field_info.get('default_value'):
                    c.execute(f"""
                        UPDATE bot_settings
                        SET {field_name} = ?
                        WHERE id = 1 AND ({field_name} IS NULL OR {field_name} = '')
                    """, (field_info['default_value'],))

                conn.commit()
                added_count += 1
                print(f"   ‚úÖ –ü–æ–ª–µ {field_name} –¥–æ–±–∞–≤–ª–µ–Ω–æ!")
            else:
                print(f"   ‚ÑπÔ∏è  –ü–æ–ª–µ {field_name} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")

        if added_count > 0:
            print(f"\n‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {added_count} –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π!")
        else:
            print("\n‚ÑπÔ∏è  –í—Å–µ –ø–æ–ª—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç")

    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏: {e}")
        import traceback
        traceback.print_exc()
        conn.rollback()
    finally:
        conn.close()

if __name__ == "__main__":
    print("=" * 70)
    print("üîß –ú–ò–ì–†–ê–¶–ò–Ø: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–ª–µ–π –≤ bot_settings")
    print("=" * 70)
    add_missing_bot_fields()
    print("=" * 70)
