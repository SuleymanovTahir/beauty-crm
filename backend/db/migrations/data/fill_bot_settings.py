"""
–ú–∏–≥—Ä–∞—Ü–∏—è: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –ø–æ–ª–µ–π –≤ bot_settings
"""
import sqlite3
import os

# –ü—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
DATABASE_NAME = '/home/user/beauty-crm/backend/salon_bot.db'

def fill_bot_settings():
    """–ó–∞–ø–æ–ª–Ω–∏—Ç—å –ø—É—Å—Ç—ã–µ –ø–æ–ª—è –≤ bot_settings –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"""
    conn = sqlite3.connect(DATABASE_NAME)
    c = conn.cursor()

    try:
        print("=" * 70)
        print("üîß –ó–ê–ü–û–õ–ù–ï–ù–ò–ï –ü–£–°–¢–´–• –ü–û–õ–ï–ô –í BOT_SETTINGS")
        print("=" * 70)

        # –ó–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
        updates = {
            'price_explanation': '''–ù–∞—à–∏ —Ü–µ–Ω—ã –æ—Ç—Ä–∞–∂–∞—é—Ç –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —É—Å–ª—É–≥ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º –º–∞—Å—Ç–µ—Ä–æ–≤.
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É.''',

            'objection_handling': '''–ü—Ä–∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è—Ö:
- –°–ª—É—à–∞–π—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –∏ –ø—Ä–æ—è–≤–ª—è–π—Ç–µ —ç–º–ø–∞—Ç–∏—é
- –ü–æ–¥—á–µ—Ä–∫–Ω–∏—Ç–µ —Ü–µ–Ω–Ω–æ—Å—Ç—å —É—Å–ª—É–≥–∏
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏–ª–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã
- –ù–µ –¥–∞–≤–∏—Ç–µ, –Ω–æ –º–æ—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∫ –¥–µ–π—Å—Ç–≤–∏—é''',

            'negative_handling': '''–ü—Ä–∏ –Ω–µ–≥–∞—Ç–∏–≤–µ:
- –û—Å—Ç–∞–≤–∞–π—Ç–µ—Å—å —Å–ø–æ–∫–æ–π–Ω—ã–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º
- –ò–∑–≤–∏–Ω–∏—Ç–µ—Å—å –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- –≠—Å–∫–∞–ª–∏—Ä—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏''',

            'example_dialogues': '''–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞:
–ö–ª–∏–µ–Ω—Ç: "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –º–∞–Ω–∏–∫—é—Ä?"
–ë–æ—Ç: "–ú–∞–Ω–∏–∫—é—Ä –≥–µ–ª—å-–ª–∞–∫ ‚Äî 130 AED üíÖ –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π —É—Ö–æ–¥ –∑–∞ –Ω–æ–≥—Ç—è–º–∏ –∏ —Å—Ç–æ–π–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞ 2-3 –Ω–µ–¥–µ–ª–∏! –•–æ—Ç–∏—Ç–µ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è?"
–ö–ª–∏–µ–Ω—Ç: "–î–∞, –∑–∞–≤—Ç—Ä–∞ –º–æ–∂–Ω–æ?"
–ë–æ—Ç: "–û—Ç–ª–∏—á–Ω–æ! –ö–∞–∫–æ–µ –≤—Ä–µ–º—è –≤–∞–º —É–¥–æ–±–Ω–æ?"''',

            'context_memory': '''–ó–∞–ø–æ–º–∏–Ω–∞–π:
- –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (–º–∞—Å—Ç–µ—Ä, —É—Å–ª—É–≥–∏, –≤—Ä–µ–º—è)
- –ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è
- –°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏''',

            'avoid_repetition': '''–ò–∑–±–µ–≥–∞–π –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π:
- –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Ñ—Ä–∞–∑—ã
- –í–∞—Ä—å–∏—Ä—É–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –ø—Ä–æ—â–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π —Å–∏–Ω–æ–Ω–∏–º—ã
- –ê–¥–∞–ø—Ç–∏—Ä—É–π—Å—è –∫ —Å—Ç–∏–ª—é –∫–ª–∏–µ–Ω—Ç–∞''',

            'conversation_flow_rules': '''–ü—Ä–∞–≤–∏–ª–∞ –¥–∏–∞–ª–æ–≥–∞:
1. –ù–∞—á–∏–Ω–∞–π —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
2. –ü—Ä–µ–¥–ª–æ–∂–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
3. –û–±—Ä–∞–±–æ—Ç–∞–π –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è
4. –ü–æ–¥–≤–µ–¥–∏ –∫ –∑–∞–ø–∏—Å–∏
5. –ó–∞–≤–µ—Ä—à–∞–π –ø–æ–∑–∏—Ç–∏–≤–Ω–æ''',

            'personality_adaptations': '''–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ª–∏—á–Ω–æ—Å—Ç–∏:
- –î–µ–ª–æ–≤—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º: –∫–æ—Ä–æ—Ç–∫–∏–µ, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–º: —Ç–µ–ø–ª–æ–µ, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ
- –ù–µ—Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–º: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –¢—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º: –º–∞–∫—Å–∏–º—É–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º–∞''',

            'smart_objection_detection': '''–î–µ—Ç–µ–∫—Ü–∏—è –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π:
- "–î–æ—Ä–æ–≥–æ" ‚Üí —Ü–µ–Ω–∞/—Ü–µ–Ω–Ω–æ—Å—Ç—å
- "–ü–æ–¥—É–º–∞—é" ‚Üí –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ
- "–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏" ‚Üí –≤—Ä–µ–º—è/–≥—Ä–∞—Ñ–∏–∫
- "–£ –≤–∞—Å –¥–∞–ª–µ–∫–æ" ‚Üí –ª–æ–∫–∞—Ü–∏—è
- "–ù–µ —É–≤–µ—Ä–µ–Ω(–∞)" ‚Üí —Å–æ–º–Ω–µ–Ω–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ'''
        }

        # –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥–æ–µ –ø–æ–ª–µ
        print("\nüìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π...\n")
        updated_count = 0

        for field, value in updates.items():
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—É—Å—Ç–æ–µ –ª–∏ –ø–æ–ª–µ
            c.execute(f"SELECT {field} FROM bot_settings WHERE id = 1")
            current = c.fetchone()

            if current and (current[0] is None or current[0].strip() == ''):
                c.execute(f"""
                    UPDATE bot_settings
                    SET {field} = ?, updated_at = datetime('now')
                    WHERE id = 1
                """, (value,))

                print(f"   ‚úÖ {field}: –∑–∞–ø–æ–ª–Ω–µ–Ω–æ ({len(value)} —Å–∏–º–≤–æ–ª–æ–≤)")
                updated_count += 1
            else:
                print(f"   ‚è≠Ô∏è  {field}: —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ")

        conn.commit()

        print(f"\n{'=' * 70}")
        if updated_count > 0:
            print(f"‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª–µ–π: {updated_count}")
        else:
            print("‚ÑπÔ∏è  –í—Å–µ –ø–æ–ª—è —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã")
        print("=" * 70)

    except Exception as e:
        print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
        conn.rollback()
        import traceback
        traceback.print_exc()
        print("=" * 70)
    finally:
        conn.close()

if __name__ == "__main__":
    fill_bot_settings()
