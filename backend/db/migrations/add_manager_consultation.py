"""
–ú–∏–≥—Ä–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è manager_consultation_prompt
"""
import sqlite3
from config import DATABASE_NAME

def add_manager_consultation_field():
    """–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞"""
    conn = sqlite3.connect(DATABASE_NAME)
    c = conn.cursor()
    
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –ø–æ–ª–µ
        c.execute("PRAGMA table_info(bot_settings)")
        columns = [row[1] for row in c.fetchall()]
        
        if 'manager_consultation_prompt' not in columns:
            print("‚ûï –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ manager_consultation_prompt...")
            c.execute("""
                ALTER TABLE bot_settings 
                ADD COLUMN manager_consultation_prompt TEXT DEFAULT ''
            """)
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
            default_prompt = """–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º —Å–∞–ª–æ–Ω–∞ –∫—Ä–∞—Å–æ—Ç—ã M.Le Diamant –≤ Dubai.
–ú–µ–Ω–µ–¥–∂–µ—Ä –æ–±—Ä–∞—Ç–∏–ª—Å—è –∫ —Ç–µ–±–µ –∑–∞ —Å–æ–≤–µ—Ç–æ–º. –¢—ã –ø–æ–º–æ–≥–∞–µ—à—å –ú–ï–ù–ï–î–ñ–ï–†–£, –∞ –Ω–µ –æ–±—â–∞–µ—à—å—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º –Ω–∞–ø—Ä—è–º—É—é.

‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
1. –û–±—Ä–∞—â–∞–π—Å—è –∫ –º–µ–Ω–µ–¥–∂–µ—Ä—É –Ω–∞ "—Ç—ã"
2. –ù–ï –ø–∏—à–∏ —Ç–µ–∫—Å—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é
3. –î–∞–π –°–û–í–ï–¢ –º–µ–Ω–µ–¥–∂–µ—Ä—É —á—Ç–æ –¥–µ–ª–∞—Ç—å

–°–¢–†–£–ö–¢–£–†–ê –û–¢–í–ï–¢–ê (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê):
1Ô∏è‚É£ **–ö—Ä–∞—Ç–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–∏—Ç—É–∞—Ü–∏–∏** (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
   "–Ø –≤–∏–∂—É —á—Ç–æ –∫–ª–∏–µ–Ω—Ç..."

2Ô∏è‚É£ **–¢–≤–æ—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** (—á—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É)
   "–Ø –±—ã –Ω–∞ —Ç–≤–æ–µ–º –º–µ—Å—Ç–µ –Ω–∞–ø–∏—Å–∞–ª –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
   '[–≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ –∫–∞–≤—ã—á–∫–∞—Ö]'"

3Ô∏è‚É£ **–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç** (–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è/—Å—Ç—Ä–∞—Ç–µ–≥–∏—è)
   "–≠—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ..."

–ü–†–ò–ú–ï–† –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –û–¢–í–ï–¢–ê:
"–í–∏–∂—É —á—Ç–æ –∫–ª–∏–µ–Ω—Ç –º–æ–ª—á–∏—Ç –ø–æ—Å–ª–µ —Ç–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω–æ - —á–µ–ª–æ–≤–µ–∫ –æ–±–¥—É–º—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã.

–Ø –±—ã –Ω–∞ —Ç–≤–æ–µ–º –º–µ—Å—Ç–µ —á–µ—Ä–µ–∑ 30-60 –º–∏–Ω—É—Ç –Ω–∞–ø–∏—Å–∞–ª:
'–ö—Å—Ç–∞—Ç–∏, –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –≤–æ–ª–æ—Å 4 —á–∞—Å–∞ - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç üíÜ‚Äç‚ôÄÔ∏è –ó–∞—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—Ä–∂–∏—Ç—Å—è 3-4 –º–µ—Å—è—Ü–∞ –±–µ–∑ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏! –ú–Ω–æ–≥–∏–µ –∫–ª–∏–µ–Ω—Ç–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –±–µ—Ä—É—Ç –≤—ã—Ö–æ–¥–Ω–æ–π - –ø–æ–ª—É—á–∞–µ—Ç—Å—è –º–∏–Ω–∏-–æ—Ç–ø—É—Å–∫ –¥–ª—è —Å–µ–±—è. –•–æ—Ç–∏—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è?'

–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç: —Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—à—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (4 —á–∞—Å–∞ = —Å—Ç–∞–Ω–¥–∞—Ä—Ç), –ø–æ–∫–∞–∑—ã–≤–∞–µ—à—å –≤—ã–≥–æ–¥—É (3-4 –º–µ—Å—è—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç), —Å–æ–∑–¥–∞–µ—à—å –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ñ—Ä–µ–π–º (–æ—Ç–ø—É—Å–∫ –≤–º–µ—Å—Ç–æ —Ç—Ä–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏) –∏ –¥–∞–µ—à—å –º—è–≥–∫–∏–π –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é."

‚ùå –ù–ï –ù–ê–ß–ò–ù–ê–ô –° –§–†–ê–ó:
"–°—É–ø–µ—Ä! –î–∞–≤–∞–π—Ç–µ –æ—Ñ–æ—Ä–º–∏–º –∑–∞–ø–∏—Å—å!"
"–î–ª—è –∑–∞–ø–∏—Å–∏ –º–Ω–µ –Ω—É–∂–Ω–æ..."
–õ—é–±–æ–π —Ç–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–Ω—ã–π –∫ –∫–ª–∏–µ–Ω—Ç—É –Ω–∞–ø—Ä—è–º—É—é

‚úÖ –ù–ê–ß–ò–ù–ê–ô –° –§–†–ê–ó:
"–Ø –≤–∏–∂—É —á—Ç–æ..."
"–Ø –±—ã –Ω–∞ —Ç–≤–æ–µ–º –º–µ—Å—Ç–µ..."
"–†–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞–ø–∏—Å–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É..."
"""
            
            c.execute("""
                UPDATE bot_settings 
                SET manager_consultation_prompt = ? 
                WHERE id = 1
            """, (default_prompt,))
            
            conn.commit()
            print("‚úÖ –ü–æ–ª–µ manager_consultation_prompt –¥–æ–±–∞–≤–ª–µ–Ω–æ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ!")
        else:
            print("‚ÑπÔ∏è  –ü–æ–ª–µ manager_consultation_prompt —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏: {e}")
        conn.rollback()
    finally:
        conn.close()

if __name__ == "__main__":
    print("=" * 70)
    print("üîß –ú–ò–ì–†–ê–¶–ò–Ø: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞")
    print("=" * 70)
    add_manager_consultation_field()
    print("=" * 70)