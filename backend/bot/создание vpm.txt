üîπ –®–∞–≥ 1. –ü–æ–ª—É—á–∏ root-–¥–æ—Å—Ç—É–ø
sudo -i

üîπ –®–∞–≥ 2. –ï—Å–ª–∏ root-–∑–∞–ø—Ä–µ—â—ë–Ω

–û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª SSH-–∫–æ–Ω—Ñ–∏–≥–∞:
sudo nano /etc/ssh/sshd_config

–ù–∞–π–¥–∏ —Å—Ç—Ä–æ—á–∫—É:
PermitRootLogin prohibit-password

–∏ –∑–∞–º–µ–Ω–∏ –Ω–∞:
PermitRootLogin yes


–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ SSH-—Å–ª—É–∂–±—É:
sudo systemctl restart ssh


–®–∞–≥ 3. –£—Å—Ç–∞–Ω–æ–≤–∏ WireGuard
apt update && apt install -y wireguard qrencode curl

üîπ –®–∞–≥ 4. –£—Å—Ç–∞–Ω–æ–≤–∏ –∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä (–æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ)
curl -O https://raw.githubusercontent.com/angristan/wireguard-install/master/wireguard-install.sh
chmod +x wireguard-install.sh
./wireguard-install.sh

–í–≤–µ–¥–∏:
cp /root/client-wg0.conf /home/ubuntu/
chown ubuntu:ubuntu /home/ubuntu/client-wg0.conf


–ù–∞ —Ç–≤–æ—ë–º Mac (–Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ), –≤—ã–ø–æ–ª–Ω–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
scp ubuntu@91.201.215.32:/home/ubuntu/client-wg0.conf ~/Downloads/

–í–≤–µ–¥–∏ –ø–∞—Ä–æ–ª—å –æ—Ç ubuntu ‚Äî –∏ —Ñ–∞–π–ª –æ–∫–∞–∂–µ—Ç—Å—è –≤ ~/Downloads/.


üîπ –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥

–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ —Å–µ—Ä–≤–µ—Ä–∞:

nano /etc/wireguard/wg0.conf


–ù–∞–π–¥–∏ —Å—Ç—Ä–æ–∫–∏:

PostUp = iptables -t nat -A POSTROUTING -s 10.66.66.0/24 -o eth0 -j MASQUERADE
PostDown = iptables -t nat -D POSTROUTING -s 10.66.66.0/24 -o eth0 -j MASQUERADE


–ú–µ–Ω—è–µ–º eth0 –Ω–∞ enp3s0:

PostUp = iptables -t nat -A POSTROUTING -s 10.66.66.0/24 -o enp3s0 -j MASQUERADE
PostDown = iptables -t nat -D POSTROUTING -s 10.66.66.0/24 -o enp3s0 -j MASQUERADE


–°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª (Ctrl+O ‚Üí Enter ‚Üí Ctrl+X).

üîπ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º WireGuard
wg-quick down wg0
wg-quick up wg0

–ø–æ–∫–∞–∑–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –ª—é–¥–µ–π —Å–∏–¥–∏—Ç
sudo wg show



–î–∞, —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ ‚Äî –ø—Ä—è–º–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –∑–Ω–∞—Ç—å, —á—Ç–æ **WireGuard –Ω–µ –∏–º–µ–µ—Ç ¬´–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π¬ª –∫–∞–∫ VPN —Å –ª–æ–≥–∏–Ω–∞–º–∏**, –µ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ **–ø–∏—Ä—ã (peers)** –ø–æ –∫–ª—é—á–∞–º.

---

## 1Ô∏è‚É£ –û—Ç–∫–ª—é—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–î–æ–ø—É—Å—Ç–∏–º, —Ö–æ—á–µ—à—å –æ—Ç–∫–ª—é—á–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ —Å IP `10.66.66.2` –∏–ª–∏ –∫–ª—é—á–æ–º `DtOTV/zYpNkCKo+mWZhG1bBjOBwsZTC/FbL4d9I2+h0=`.

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –≤—Ä–µ–º–µ–Ω–Ω–æ (–¥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞)

```bash
sudo wg set wg0 peer DtOTV/zYpNkCKo+mWZhG1bBjOBwsZTC/FbL4d9I2+h0= remove
```

* –ö–ª–∏–µ–Ω—Ç –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è.
* –ù–æ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞ (`wg-quick down wg0 && wg-quick up wg0`) –ø—Ä–∞–≤–∏–ª–æ –≤–µ—Ä–Ω—ë—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `/etc/wireguard/wg0.conf`.

---

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –Ω–∞–≤—Å–µ–≥–¥–∞

1. –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Ñ–∏–≥ —Å–µ—Ä–≤–µ—Ä–∞:

```bash
sudo nano /etc/wireguard/wg0.conf
```

2. –ù–∞–π–¥–∏ —Å–µ–∫—Ü–∏—é –∫–ª–∏–µ–Ω—Ç–∞ (`[Peer] ‚Ä¶`) –∏ **—É–¥–∞–ª–∏ –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –µ—ë**:

```ini
#[Peer]
#PublicKey = DtOTV/zYpNkCKo+mWZhG1bBjOBwsZTC/FbL4d9I2+h0=
#AllowedIPs = 10.66.66.2/32
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ WireGuard:

```bash
sudo wg-quick down wg0
sudo wg-quick up wg0
```

* –¢–µ–ø–µ—Ä—å –∫–ª–∏–µ–Ω—Ç –±–æ–ª—å—à–µ –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è.

---

## 2Ô∏è‚É£ –û—Ç–∫–ª—é—á–∏—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

* –í—Ä–µ–º–µ–Ω–Ω–æ:

```bash
sudo wg-quick down wg0
```

‚Üí –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å wg0 –æ—Ç–∫–ª—é—á–∏—Ç—Å—è, –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã —Ç–µ—Ä—è—é—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.

* –ù–∞–≤—Å–µ–≥–¥–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å wg0 –ø–æ–¥–Ω—è—Ç—ã–º, –Ω–æ –±–µ–∑ –∫–ª–∏–µ–Ω—Ç–æ–≤):

  * –£–¥–∞–ª—è–µ–º –≤—Å–µ `[Peer]` —Å–µ–∫—Ü–∏–∏ –∏–∑ `/etc/wireguard/wg0.conf`
  * –ü–æ—Ç–æ–º `sudo wg-quick up wg0`

---

